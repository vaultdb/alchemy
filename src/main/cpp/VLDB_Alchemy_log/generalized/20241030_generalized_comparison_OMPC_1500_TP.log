[==========] Running 12 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 12 tests from GeneralizedComparisonTest
[ RUN      ] GeneralizedComparisonTest.baseline_tpch_q1
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 630.298ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 68288512 bytes, current memory size: 31150080 bytes.
68288512
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 68288512 bytes, current memory size: 31936512 bytes.
Original Tree : 
#3: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-varchar(1) lineitem.l_returnflag, #1 shared-varchar(1) lineitem.l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty, #7 shared-float avg_price, #8 shared-float avg_disc, #9 shared-int64(11) count_order) order by: {<0, ASC> , <1, ASC> }, cost est: 12522041, output card: 1500
    #2: SortMergeAggregate<Bit> (group-by: (0, 1) aggs: (SUM($2) sum_qty, SUM($3) sum_base_price, SUM($5) sum_disc_price, SUM($6) sum_charge, AVG($2) avg_qty, AVG($3) avg_price, AVG($4) avg_disc, COUNT(*) count_order)) : (#0 shared-varchar(1) lineitem.l_returnflag, #1 shared-varchar(1) lineitem.l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty, #7 shared-float avg_price, #8 shared-float avg_disc, #9 shared-int64(11) count_order) order by: {<0, ASC> , <1, ASC> }, cost est: 33405000, output card: 1500
        #-1: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-varchar(1) lineitem.l_returnflag, #1 shared-varchar(1) lineitem.l_linestatus, #2 shared-float lineitem.l_quantity, #3 shared-float lineitem.l_extendedprice, #4 shared-float lineitem.l_discount, #5 shared-float disc_price, #6 shared-float charge) order by: {<0, ASC> , <1, ASC> }, cost est: 9094475, output card: 1500
            #1: Project<Bit> ((<0, P$4(8) shared-varchar>, <1, P$5(8) shared-varchar>, <2, P$0(32) shared-float>, <3, P$1(32) shared-float>, <4, P$2(32) shared-float>, <5, $1 * (SECRET FLOAT - $2) shared-float>, <6, ($1 * (SECRET FLOAT - $2)) * (SECRET FLOAT + $3) shared-float>)) : (#0 shared-varchar(1) lineitem.l_returnflag, #1 shared-varchar(1) lineitem.l_linestatus, #2 shared-float lineitem.l_quantity, #3 shared-float lineitem.l_extendedprice, #4 shared-float lineitem.l_discount, #5 shared-float disc_price, #6 shared-float charge) order by: {}, cost est: 34177500, output card: 1500
                #0: SecureSqlInput<Bit> ("SELECT l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, NOT l_shipdate <= DATE '1998-08-03' AS dummy_tag FROM lineitem", tuple_count=1500) : (#0 shared-float lineitem.l_quantity, #1 shared-float lineitem.l_extendedprice, #2 shared-float lineitem.l_discount, #3 shared-float lineitem.l_tax, #4 shared-varchar(1) lineitem.l_returnflag, #5 shared-varchar(1) lineitem.l_linestatus) order by: {}, cost est: 0, output card: 1500

Operator #0 SecureSqlInput ran for 158.510000 ms, gate count: 0 output cardinality: 1500, row width=145
extension finished! takes 36.264ms to extend lpn
extension finished! takes 32.582ms to extend lpn
extension finished! takes 32.459ms to extend lpn
extension finished! takes 32.447ms to extend lpn
Operator #1 Project ran for 2529.446000 ms, gate count: 20506500 output cardinality: 1500, row width=177
extension finished! takes 33.113ms to extend lpn
Operator #-1 Sort ran for 1417.048000 ms, gate count: 9279558 output cardinality: 1500, row width=177
extension finished! takes 32.479ms to extend lpn
extension finished! takes 32.679ms to extend lpn
extension finished! takes 32.47ms to extend lpn
extension finished! takes 32.556ms to extend lpn
extension finished! takes 32.42ms to extend lpn
extension finished! takes 32.465ms to extend lpn
extension finished! takes 32.431ms to extend lpn
Operator #2 SortMergeAggregate ran for 25294.019000 ms, gate count: 32971759 output cardinality: 1500, row width=252
extension finished! takes 32.555ms to extend lpn
extension finished! takes 32.544ms to extend lpn
extension finished! takes 32.556ms to extend lpn
Operator #3 Sort ran for 10129.857000 ms, gate count: 12547008 output cardinality: 1500, row width=252
Runtime: 39.5577 sec, CPU Time: 12.2889 sec, CPU clock ticks: 1.22889e+07, CPU clock ticks per second: 1000000
End-to-end estimated gates: 8.9199e+07. observed gates: 75304825 gates, relative error (%)=18.4506
[Linux]Peak resident set size: 232247296 bytes, current memory size: 232247296 bytes.
Initial Memory: 68288512 bytes, Peak Memory After Execution: 232247296 bytes, Memory Usage: 163958784 bytes
Bandwidth: 717877 Bps
TP send 35870272 bytes to party 1
TP send 28110739 bytes to party 2
TP send 28110739 bytes to party 3
total AND gate: 75304825
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.baseline_tpch_q1 (40330 ms)
[ RUN      ] GeneralizedComparisonTest.baseline_tpch_q3
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 347.936ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 232378368 bytes, current memory size: 232378368 bytes.
232378368
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 232378368 bytes, current memory size: 232378368 bytes.
Original Tree : 
#10: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$3(32) shared-float>, <2, P$1(28) shared-int64>, <3, P$2(1) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-float revenue, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority) order by: {<-1, ASC> , <1, DESC> , <2, ASC> }, cost est: 0, output card: 10
    #9: Sort<Bit> ({<-1, ASC> , <3, DESC> , <1, ASC> }) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <3, DESC> , <1, ASC> }, cost est: 5312, output card: 10
        #8: SortMergeAggregate<Bit> (group-by: (0, 1, 2) aggs: (SUM($3) revenue)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> , <1, ASC> , <2, ASC> }, cost est: 1773000, output card: 1500
            #-1: Sort<Bit> ({<0, ASC> , <1, ASC> , <2, ASC> }) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> , <1, ASC> , <2, ASC> }, cost est: 6032516, output card: 1500
                #7: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$1(28) shared-int64>, <2, P$2(1) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {}, cost est: 0, output card: 1500
                    #6: KeyedJoin<Bit> (P$0(16) == P$3(16)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-int32(16) lineitem.l_orderkey, #4 shared-float revenue) order by: {}, cost est: 146250000, output card: 1500
                        #3: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$2(28) shared-int64>, <2, P$3(1) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority) order by: {}, cost est: 0, output card: 1500
                            #2: KeyedJoin<Bit> (P$1(11) == P$4(11)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority, #4 shared-int32(11) customer.c_custkey) order by: {}, cost est: 58500000, output card: 1500
                                #0: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_orderdate, o_shippriority, NOT o_orderdate < DATE '1995-03-25' AS dummy_tag FROM orders", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority) order by: {}, cost est: 0, output card: 1500
                                #1: SecureSqlInput<Bit> ("SELECT c_custkey, NOT c_mktsegment = 'HOUSEHOLD' AS dummy_tag FROM customer", tuple_count=1500) : (#0 shared-int32(11) customer.c_custkey) order by: {}, cost est: 0, output card: 1500
                        #5: Project<Bit> ((<0, P$0(16) shared-int32>, <1, $1 * (SECRET FLOAT - $2) shared-float>)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float revenue) order by: {}, cost est: 6835500, output card: 1500
                            #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_extendedprice, l_discount, NOT l_shipdate > DATE '1995-03-25' AS dummy_tag FROM lineitem", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float lineitem.l_extendedprice, #2 shared-float lineitem.l_discount) order by: {}, cost est: 0, output card: 1500

Operator #0 SecureSqlInput ran for 13.536000 ms, gate count: 0 output cardinality: 1500, row width=57
Operator #1 SecureSqlInput ran for 3.291000 ms, gate count: 0 output cardinality: 1500, row width=12
extension finished! takes 32.413ms to extend lpn
extension finished! takes 32.537ms to extend lpn
extension finished! takes 32.507ms to extend lpn
extension finished! takes 32.458ms to extend lpn
extension finished! takes 32.482ms to extend lpn
extension finished! takes 32.6ms to extend lpn
extension finished! takes 32.467ms to extend lpn
extension finished! takes 32.519ms to extend lpn
extension finished! takes 32.659ms to extend lpn
extension finished! takes 32.69ms to extend lpn
extension finished! takes 32.948ms to extend lpn
extension finished! takes 32.65ms to extend lpn
Operator #2 KeyedJoin ran for 29192.960000 ms, gate count: 60750000 output cardinality: 1500, row width=68
Operator #3 Project ran for 5.426000 ms, gate count: 0 output cardinality: 1500, row width=46
Operator #4 SecureSqlInput ran for 4440.065000 ms, gate count: 0 output cardinality: 1500, row width=81
extension finished! takes 32.757ms to extend lpn
Operator #5 Project ran for 3546.961000 ms, gate count: 6835500 output cardinality: 1500, row width=49
extension finished! takes 32.703ms to extend lpn
extension finished! takes 32.899ms to extend lpn
extension finished! takes 32.905ms to extend lpn
extension finished! takes 33.054ms to extend lpn
extension finished! takes 32.696ms to extend lpn
extension finished! takes 32.763ms to extend lpn
extension finished! takes 32.778ms to extend lpn
extension finished! takes 32.779ms to extend lpn
extension finished! takes 32.865ms to extend lpn
extension finished! takes 32.919ms to extend lpn
extension finished! takes 32.827ms to extend lpn
extension finished! takes 32.92ms to extend lpn
extension finished! takes 32.941ms to extend lpn
extension finished! takes 32.721ms to extend lpn
extension finished! takes 32.805ms to extend lpn
extension finished! takes 32.766ms to extend lpn
extension finished! takes 32.932ms to extend lpn
extension finished! takes 32.676ms to extend lpn
extension finished! takes 32.783ms to extend lpn
extension finished! takes 32.684ms to extend lpn
extension finished! takes 32.754ms to extend lpn
extension finished! takes 32.779ms to extend lpn
extension finished! takes 33.054ms to extend lpn
extension finished! takes 32.771ms to extend lpn
extension finished! takes 32.802ms to extend lpn
extension finished! takes 32.681ms to extend lpn
extension finished! takes 32.936ms to extend lpn
extension finished! takes 33.011ms to extend lpn
extension finished! takes 32.971ms to extend lpn
extension finished! takes 32.802ms to extend lpn
Operator #6 KeyedJoin ran for 102115.773000 ms, gate count: 148500000 output cardinality: 1500, row width=94
Operator #7 Project ran for 8.717000 ms, gate count: 0 output cardinality: 1500, row width=78
extension finished! takes 32.97ms to extend lpn
Operator #-1 Sort ran for 4801.368000 ms, gate count: 7841880 output cardinality: 1500, row width=78
extension finished! takes 32.678ms to extend lpn
Operator #8 SortMergeAggregate ran for 252.718000 ms, gate count: 1728379 output cardinality: 1500, row width=78
extension finished! takes 32.856ms to extend lpn
extension finished! takes 32.72ms to extend lpn
extension finished! takes 32.672ms to extend lpn
extension finished! takes 32.583ms to extend lpn
Operator #9 Sort ran for 14877.373000 ms, gate count: 24789054 output cardinality: 10, row width=78
Operator #10 Project ran for 0.053000 ms, gate count: 0 output cardinality: 10, row width=78
Runtime: 159.285 sec, CPU Time: 40.6304 sec, CPU clock ticks: 4.06304e+07, CPU clock ticks per second: 1000000
End-to-end estimated gates: 2.19396e+08. observed gates: 250444813 gates, relative error (%)=12.3973
[Linux]Peak resident set size: 232509440 bytes, current memory size: 232509440 bytes.
Initial Memory: 232378368 bytes, Peak Memory After Execution: 232509440 bytes, Memory Usage: 131072 bytes
Bandwidth: 593088 Bps
TP send 71113280 bytes to party 1
TP send 63569747 bytes to party 2
TP send 63569747 bytes to party 3
total AND gate: 250444813
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.baseline_tpch_q3 (182051 ms)
[ RUN      ] GeneralizedComparisonTest.baseline_tpch_q5
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 429.264ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 232509440 bytes, current memory size: 232509440 bytes.
232509440
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 232509440 bytes, current memory size: 232509440 bytes.
Original Tree : 
#12: Sort<Bit> ({<1, DESC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<1, DESC> }, cost est: 12247836, output card: 1500
    #11: SortMergeAggregate<Bit> (group-by: (0) aggs: (SUM($1) revenue)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 2229000, output card: 1500
        #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 19925584, output card: 1500
            #10: Project<Bit> ((<0, P$5(200) shared-varchar>, <1, P$1(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {}, cost est: 0, output card: 1500
                #9: KeyedJoin<Bit> ((P$0(5) == P$4(5)) AND (P$2(11) == P$3(11))) : (#0 shared-int32(5) supplier.c_nationkey, #1 shared-float revenue, #2 shared-int32(11) orders.o_custkey, #3 shared-int32(11) customer.c_custkey, #4 shared-int32(5) customer.c_nationkey, #5 shared-varchar(25) nation.n_name) order by: {}, cost est: 118875000, output card: 1500
                    #7: Project<Bit> ((<0, P$0(5) shared-int32>, <1, P$2(32) shared-float>, <2, P$4(11) shared-int32>)) : (#0 shared-int32(5) supplier.c_nationkey, #1 shared-float revenue, #2 shared-int32(11) orders.o_custkey) order by: {}, cost est: 0, output card: 1500
                        #6: KeyedJoin<Bit> (P$1(16) == P$3(16)) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float revenue, #3 shared-int32(16) orders.o_orderkey, #4 shared-int32(11) orders.o_custkey) order by: {}, cost est: 105750000, output card: 1500
                            #4: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(16) shared-int32>, <2, P$4(32) shared-float>)) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float revenue) order by: {}, cost est: 0, output card: 1500
                                #3: KeyedJoin<Bit> (P$0(7) == P$3(7)) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey, #2 shared-int32(16) lineitem.l_orderkey, #3 shared-int32(7) lineitem.l_suppkey, #4 shared-float revenue) order by: {}, cost est: 414000, output card: 1500
                                    #0: SecureSqlInput<Bit> ("SELECT s_suppkey, s_nationkey FROM supplier JOIN nation ON s_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE r_name = 'MIDDLE EAST '", tuple_count=12) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey) order by: {}, cost est: 0, output card: 12
                                    #2: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$1(7) shared-int32>, <2, $2 * (SECRET FLOAT - $3) shared-float>)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float revenue) order by: {}, cost est: 6835500, output card: 1500
                                        #1: SecureSqlInput<Bit> ("SELECT l_orderkey, l_suppkey, l_extendedprice, l_discount FROM lineitem", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float lineitem.l_extendedprice, #3 shared-float lineitem.l_discount) order by: {}, cost est: 0, output card: 1500
                            #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, NOT (o_orderdate >= DATE '1993-01-01' AND o_orderdate < DATE '1994-01-01') AS dummy_tag FROM orders", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey) order by: {}, cost est: 0, output card: 1500
                    #8: SecureSqlInput<Bit> ("SELECT t2.c_custkey, t2.c_nationkey, t1.n_name FROM (SELECT r_regionkey, r_name FROM region WHERE r_name = 'MIDDLE EAST ') AS t0 INNER JOIN (SELECT n_nationkey, n_name, n_regionkey FROM nation) AS t1 ON t0.r_regionkey = t1.n_regionkey INNER JOIN (SELECT c_custkey, c_nationkey FROM customer) AS t2 ON t1.n_nationkey = t2.c_nationkey ORDER BY t2.c_custkey ASC", tuple_count=317) : (#0 shared-int32(11) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name) order by: {}, cost est: 0, output card: 317

Operator #0 SecureSqlInput ran for 0.069000 ms, gate count: 0 output cardinality: 12, row width=13
Operator #1 SecureSqlInput ran for 19.174000 ms, gate count: 0 output cardinality: 1500, row width=88
extension finished! takes 32.659ms to extend lpn
Operator #2 Project ran for 852.181000 ms, gate count: 6835500 output cardinality: 1500, row width=56
Operator #3 KeyedJoin ran for 65.645000 ms, gate count: 432000 output cardinality: 1500, row width=68
Operator #4 Project ran for 6.494000 ms, gate count: 0 output cardinality: 1500, row width=54
Operator #5 SecureSqlInput ran for 6.752000 ms, gate count: 0 output cardinality: 1500, row width=28
extension finished! takes 32.731ms to extend lpn
extension finished! takes 32.799ms to extend lpn
extension finished! takes 32.708ms to extend lpn
extension finished! takes 32.726ms to extend lpn
extension finished! takes 32.716ms to extend lpn
extension finished! takes 32.745ms to extend lpn
extension finished! takes 32.597ms to extend lpn
extension finished! takes 32.796ms to extend lpn
extension finished! takes 32.673ms to extend lpn
extension finished! takes 32.667ms to extend lpn
extension finished! takes 32.696ms to extend lpn
extension finished! takes 32.68ms to extend lpn
extension finished! takes 32.765ms to extend lpn
extension finished! takes 32.758ms to extend lpn
extension finished! takes 32.739ms to extend lpn
extension finished! takes 32.731ms to extend lpn
extension finished! takes 32.921ms to extend lpn
extension finished! takes 32.658ms to extend lpn
extension finished! takes 33.06ms to extend lpn
extension finished! takes 32.772ms to extend lpn
extension finished! takes 32.722ms to extend lpn
extension finished! takes 32.852ms to extend lpn
Operator #6 KeyedJoin ran for 68629.640000 ms, gate count: 108000000 output cardinality: 1500, row width=81
Operator #7 Project ran for 5.866000 ms, gate count: 0 output cardinality: 1500, row width=49
Operator #8 SecureSqlInput ran for 11146.253000 ms, gate count: 0 output cardinality: 317, row width=217
extension finished! takes 32.661ms to extend lpn
extension finished! takes 32.854ms to extend lpn
extension finished! takes 32.609ms to extend lpn
extension finished! takes 32.793ms to extend lpn
extension finished! takes 32.931ms to extend lpn
extension finished! takes 32.773ms to extend lpn
extension finished! takes 32.666ms to extend lpn
extension finished! takes 32.67ms to extend lpn
extension finished! takes 32.706ms to extend lpn
extension finished! takes 32.814ms to extend lpn
extension finished! takes 32.911ms to extend lpn
extension finished! takes 32.965ms to extend lpn
extension finished! takes 32.942ms to extend lpn
extension finished! takes 32.853ms to extend lpn
extension finished! takes 32.734ms to extend lpn
extension finished! takes 32.839ms to extend lpn
extension finished! takes 32.738ms to extend lpn
extension finished! takes 32.801ms to extend lpn
extension finished! takes 32.793ms to extend lpn
extension finished! takes 32.811ms to extend lpn
extension finished! takes 32.834ms to extend lpn
extension finished! takes 32.806ms to extend lpn
Operator #9 KeyedJoin ran for 72314.018000 ms, gate count: 113644500 output cardinality: 1500, row width=265
Operator #10 Project ran for 93.771000 ms, gate count: 0 output cardinality: 1500, row width=233
extension finished! takes 32.788ms to extend lpn
extension finished! takes 32.779ms to extend lpn
extension finished! takes 32.658ms to extend lpn
extension finished! takes 32.798ms to extend lpn
extension finished! takes 32.716ms to extend lpn
extension finished! takes 32.724ms to extend lpn
Operator #-1 Sort ran for 25420.808000 ms, gate count: 27664410 output cardinality: 1500, row width=233
Operator #11 SortMergeAggregate ran for 401.570000 ms, gate count: 2181077 output cardinality: 1500, row width=233
extension finished! takes 32.899ms to extend lpn
extension finished! takes 32.655ms to extend lpn
extension finished! takes 32.718ms to extend lpn
extension finished! takes 32.841ms to extend lpn
extension finished! takes 32.815ms to extend lpn
extension finished! takes 32.701ms to extend lpn
Operator #12 Sort ran for 23220.646000 ms, gate count: 28753560 output cardinality: 1500, row width=233
Runtime: 202.229 sec, CPU Time: 45.1659 sec, CPU clock ticks: 4.51659e+07, CPU clock ticks per second: 1000000
End-to-end estimated gates: 2.66277e+08. observed gates: 287511047 gates, relative error (%)=7.38549
[Linux]Peak resident set size: 405262336 bytes, current memory size: 290119680 bytes.
Initial Memory: 232509440 bytes, Peak Memory After Execution: 405262336 bytes, Memory Usage: 172752896 bytes
Bandwidth: 536292 Bps
TP send 81981922 bytes to party 1
TP send 71913043 bytes to party 2
TP send 71913043 bytes to party 3
total AND gate: 287511047
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.baseline_tpch_q5 (222293 ms)
[ RUN      ] GeneralizedComparisonTest.baseline_tpch_q8
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 587.94ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 405262336 bytes, current memory size: 290119680 bytes.
405262336
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 405262336 bytes, current memory size: 290119680 bytes.
Original Tree : 
#13: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32 orders.o_year, #1 shared-float mkt_share) order by: {<0, ASC> }, cost est: 4570088, output card: 1500
    #12: Project<Bit> ((<0, P$0(32) shared-int32>, <1, $2 / $1 shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float mkt_share) order by: {<0, ASC> }, cost est: 5713500, output card: 1500
        #11: SortMergeAggregate<Bit> (group-by: (0) aggs: (SUM($1) null, SUM($2) null)) : (#0 shared-int32 orders.o_year, #1 shared-float null, #2 shared-float null) order by: {<0, ASC> }, cost est: 3450000, output card: 1500
            #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32 orders.o_year, #1 shared-float volume, #2 shared-float selected_volume) order by: {<0, ASC> }, cost est: 6032516, output card: 1500
                #10: Project<Bit> ((<0, P$0(32) shared-int32>, <1, P$2(32) shared-float>, <2, CASE($4, $2, SECRET FLOAT) shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float volume, #2 shared-float selected_volume) order by: {}, cost est: 0, output card: 1500
                    #9: KeyedJoin<Bit> (P$1(7) == P$3(7)) : (#0 shared-int32 orders.o_year, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float volume, #3 shared-int32(7) supplier.s_suppkey, #4 shared-bool nation_check) order by: {}, cost est: 2850000, output card: 1500
                        #7: Project<Bit> ((<0, P$1(32) shared-int32>, <1, P$3(7) shared-int32>, <2, P$4(32) shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float volume) order by: {}, cost est: 0, output card: 1500
                            #6: KeyedJoin<Bit> (P$0(16) == P$2(16)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32 orders.o_year, #2 shared-int32(16) lineitem.l_orderkey, #3 shared-int32(7) lineitem.l_suppkey, #4 shared-float revenue) order by: {}, cost est: 168750000, output card: 1500
                                #3: Project<Bit> ((<0, P$1(16) shared-int32>, <1, P$3(32) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32 orders.o_year) order by: {}, cost est: 0, output card: 1500
                                    #2: KeyedJoin<Bit> (P$0(11) == P$2(11)) : (#0 shared-int32(11) customer.c_custkey, #1 shared-int32(16) orders.o_orderkey, #2 shared-int32(11) orders.o_custkey, #3 shared-int32 orders.o_year) order by: {}, cost est: 11778000, output card: 1500
                                        #0: SecureSqlInput<Bit> ("SELECT c_custkey FROM customer c JOIN nation n1 ON c_nationkey = n_nationkey JOIN region ON r_regionkey = n_regionkey WHERE r_name = 'AFRICA'", tuple_count=302) : (#0 shared-int32(11) customer.c_custkey) order by: {}, cost est: 0, output card: 302
                                        #1: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_orderyear::INT AS o_year, NOT (o_orderdate >= date '1995-01-01' and o_orderdate < date '1996-12-31') dummy_tag FROM orders", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int32 orders.o_year) order by: {}, cost est: 0, output card: 1500
                                #5: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$1(7) shared-int32>, <2, $2 * (SECRET FLOAT - $3) shared-float>)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float revenue) order by: {}, cost est: 6835500, output card: 1500
                                    #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_suppkey, l_extendedprice, l_discount,        CASE            WHEN p_type = 'LARGE ANODIZED STEEL' AND p_partkey = l_partkey THEN FALSE            ELSE TRUE            END AS dummy_tag FROM lineitem LEFT JOIN part ON p_partkey = l_partkey", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float lineitem.l_extendedprice, #3 shared-float lineitem.l_discount) order by: {}, cost est: 0, output card: 1500
                        #8: SecureSqlInput<Bit> ("SELECT s_suppkey, CASE WHEN n_name = 'KENYA' THEN true ELSE false END AS nation_check FROM supplier JOIN nation ON n_nationkey = s_nationkey", tuple_count=100) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-bool nation_check) order by: {}, cost est: 0, output card: 100

Operator #0 SecureSqlInput ran for 0.581000 ms, gate count: 0 output cardinality: 302, row width=12
Operator #1 SecureSqlInput ran for 13.818000 ms, gate count: 0 output cardinality: 1500, row width=60
extension finished! takes 32.682ms to extend lpn
extension finished! takes 32.817ms to extend lpn
Operator #2 KeyedJoin ran for 1736.357000 ms, gate count: 12231000 output cardinality: 1500, row width=71
Operator #3 Project ran for 5.347000 ms, gate count: 0 output cardinality: 1500, row width=49
Operator #4 SecureSqlInput ran for 80.179000 ms, gate count: 0 output cardinality: 1500, row width=88
extension finished! takes 33.061ms to extend lpn
Operator #5 Project ran for 851.255000 ms, gate count: 6835500 output cardinality: 1500, row width=56
extension finished! takes 32.677ms to extend lpn
extension finished! takes 32.732ms to extend lpn
extension finished! takes 32.67ms to extend lpn
extension finished! takes 32.819ms to extend lpn
extension finished! takes 32.762ms to extend lpn
extension finished! takes 32.6ms to extend lpn
extension finished! takes 32.844ms to extend lpn
extension finished! takes 33.02ms to extend lpn
extension finished! takes 32.759ms to extend lpn
extension finished! takes 32.918ms to extend lpn
extension finished! takes 32.569ms to extend lpn
extension finished! takes 32.709ms to extend lpn
extension finished! takes 32.581ms to extend lpn
extension finished! takes 32.834ms to extend lpn
extension finished! takes 32.767ms to extend lpn
extension finished! takes 32.506ms to extend lpn
extension finished! takes 32.772ms to extend lpn
extension finished! takes 32.599ms to extend lpn
extension finished! takes 32.681ms to extend lpn
extension finished! takes 32.702ms to extend lpn
extension finished! takes 32.815ms to extend lpn
extension finished! takes 32.669ms to extend lpn
extension finished! takes 32.678ms to extend lpn
extension finished! takes 32.758ms to extend lpn
extension finished! takes 32.775ms to extend lpn
extension finished! takes 32.732ms to extend lpn
extension finished! takes 32.719ms to extend lpn
extension finished! takes 32.604ms to extend lpn
extension finished! takes 32.865ms to extend lpn
extension finished! takes 32.729ms to extend lpn
extension finished! takes 32.758ms to extend lpn
extension finished! takes 32.664ms to extend lpn
extension finished! takes 32.613ms to extend lpn
extension finished! takes 32.654ms to extend lpn
Operator #6 KeyedJoin ran for 115864.638000 ms, gate count: 171000000 output cardinality: 1500, row width=104
Operator #7 Project ran for 7.522000 ms, gate count: 0 output cardinality: 1500, row width=72
Operator #8 SecureSqlInput ran for 0.440000 ms, gate count: 0 output cardinality: 100, row width=9
extension finished! takes 32.653ms to extend lpn
Operator #9 KeyedJoin ran for 489.371000 ms, gate count: 3000000 output cardinality: 1500, row width=80
Operator #10 Project ran for 19.865000 ms, gate count: 48000 output cardinality: 1500, row width=97
extension finished! takes 32.63ms to extend lpn
Operator #-1 Sort ran for 4145.958000 ms, gate count: 7101258 output cardinality: 1500, row width=97
extension finished! takes 32.373ms to extend lpn
Operator #11 SortMergeAggregate ran for 4959.851000 ms, gate count: 3251395 output cardinality: 1500, row width=97
extension finished! takes 32.697ms to extend lpn
Operator #12 Project ran for 2341.643000 ms, gate count: 5713500 output cardinality: 1500, row width=65
extension finished! takes 32.705ms to extend lpn
Operator #13 Sort ran for 3766.452000 ms, gate count: 5707146 output cardinality: 1500, row width=65
Runtime: 134.326 sec, CPU Time: 33.7709 sec, CPU clock ticks: 3.37709e+07, CPU clock ticks per second: 1000000
End-to-end estimated gates: 2.0998e+08. observed gates: 214887799 gates, relative error (%)=2.28407
[Linux]Peak resident set size: 405262336 bytes, current memory size: 252973056 bytes.
Initial Memory: 405262336 bytes, Peak Memory After Execution: 405262336 bytes, Memory Usage: 0 bytes
Bandwidth: 603427 Bps
TP send 63764140 bytes to party 1
TP send 56269363 bytes to party 2
TP send 56269363 bytes to party 3
total AND gate: 214887799
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.baseline_tpch_q8 (155195 ms)
[ RUN      ] GeneralizedComparisonTest.baseline_tpch_q9
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 325.801ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 405262336 bytes, current memory size: 279449600 bytes.
405262336
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 405262336 bytes, current memory size: 279449600 bytes.
Original Tree : 
#12: Sort<Bit> ({<0, ASC> , <1, DESC> }) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 amount, #2 shared-float sum_profit) order by: {<0, ASC> , <1, DESC> }, cost est: 22987542, output card: 1500
    #11: SortMergeAggregate<Bit> (group-by: (0, 1) aggs: (SUM($2) sum_profit)) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 amount, #2 shared-float sum_profit) order by: {<0, ASC> , <1, ASC> }, cost est: 2325000, output card: 1500
        #-1: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 amount, #2 shared-float o_year) order by: {<0, ASC> , <1, ASC> }, cost est: 22987542, output card: 1500
            #10: Project<Bit> ((<0, P$0(200) shared-varchar>, <1, P$3(32) shared-int32>, <2, P$2(32) shared-float>)) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 amount, #2 shared-float o_year) order by: {}, cost est: 0, output card: 1500
                #9: KeyedJoin<Bit> (P$1(16) == P$4(16)) : (#0 shared-varchar(25) nation.nation, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float amount, #3 shared-int32 o_year, #4 shared-int32(16) orders.o_orderkey) order by: {}, cost est: 153000000, output card: 1500
                    #7: Project<Bit> ((<0, P$0(200) shared-varchar>, <1, P$4(16) shared-int32>, <2, $8 - ($3 * $7) shared-float>)) : (#0 shared-varchar(25) nation.nation, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float amount) order by: {}, cost est: 6835500, output card: 1500
                        #6: KeyedJoin<Bit> ((P$2(7) == P$6(7)) AND (P$1(11) == P$5(11))) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(11) partsupp.ps_partkey, #2 shared-int32(7) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost, #4 shared-int32(16) lineitem.l_orderkey, #5 shared-int32(11) lineitem.l_partkey, #6 shared-int32(7) lineitem.l_suppkey, #7 shared-float l_quantity, #8 shared-float revenue) order by: {}, cost est: 194880000, output card: 1500
                            #3: Project<Bit> ((<0, P$1(200) shared-varchar>, <1, P$2(11) shared-int32>, <2, P$3(7) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(11) partsupp.ps_partkey, #2 shared-int32(7) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost) order by: {}, cost est: 0, output card: 448
                                #2: KeyedJoin<Bit> (P$0(7) == P$3(7)) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(11) partsupp.ps_partkey, #3 shared-int32(7) partsupp.ps_suppkey, #4 shared-float partsupp.ps_supplycost) order by: {}, cost est: 9766400, output card: 448
                                    #0: SecureSqlInput<Bit> ("SELECT s_suppkey, n_name FROM supplier JOIN nation ON s_nationkey = n_nationkey", tuple_count=100) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name) order by: {}, cost est: 0, output card: 100
                                    #1: SecureSqlInput<Bit> ("SELECT ps_partkey, ps_suppkey, ps_supplycost FROM partsupp JOIN part ON ps_partkey = p_partkey WHERE p_name LIKE '%yellow%'", tuple_count=448) : (#0 shared-int32(11) partsupp.ps_partkey, #1 shared-int32(7) partsupp.ps_suppkey, #2 shared-float partsupp.ps_supplycost) order by: {}, cost est: 0, output card: 448
                            #5: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$1(11) shared-int32>, <2, P$2(7) shared-int32>, <3, P$3(32) shared-float>, <4, $4 * (SECRET FLOAT - $5) shared-float>)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(11) lineitem.l_partkey, #2 shared-int32(7) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float revenue) order by: {}, cost est: 6835500, output card: 1500
                                #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_partkey, l_suppkey, l_quantity::float4, l_extendedprice, l_discount FROM lineitem", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(11) lineitem.l_partkey, #2 shared-int32(7) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float lineitem.l_extendedprice, #5 shared-float lineitem.l_discount) order by: {}, cost est: 0, output card: 1500
                    #8: SecureSqlInput<Bit> ("SELECT EXTRACT('year' FROM o_orderdate)::INT AS o_year, o_orderkey FROM orders", tuple_count=1500) : (#0 shared-int32 o_year, #1 shared-int32(16) orders.o_orderkey) order by: {}, cost est: 0, output card: 1500

Operator #0 SecureSqlInput ran for 3.844000 ms, gate count: 0 output cardinality: 100, row width=208
Operator #1 SecureSqlInput ran for 3.414000 ms, gate count: 0 output cardinality: 448, row width=51
extension finished! takes 32.928ms to extend lpn
Operator #2 KeyedJoin ran for 1024.930000 ms, gate count: 9811200 output cardinality: 448, row width=258
Operator #3 Project ran for 11.647000 ms, gate count: 0 output cardinality: 448, row width=251
Operator #4 SecureSqlInput ran for 2895.414000 ms, gate count: 0 output cardinality: 1500, row width=131
extension finished! takes 32.562ms to extend lpn
extension finished! takes 32.575ms to extend lpn
Operator #5 Project ran for 2597.661000 ms, gate count: 6835500 output cardinality: 1500, row width=99
extension finished! takes 32.731ms to extend lpn
extension finished! takes 32.56ms to extend lpn
extension finished! takes 32.479ms to extend lpn
extension finished! takes 32.618ms to extend lpn
extension finished! takes 32.467ms to extend lpn
extension finished! takes 32.509ms to extend lpn
extension finished! takes 32.677ms to extend lpn
extension finished! takes 32.497ms to extend lpn
extension finished! takes 32.541ms to extend lpn
extension finished! takes 32.541ms to extend lpn
extension finished! takes 32.393ms to extend lpn
extension finished! takes 32.408ms to extend lpn
extension finished! takes 32.509ms to extend lpn
extension finished! takes 32.522ms to extend lpn
extension finished! takes 32.545ms to extend lpn
extension finished! takes 32.42ms to extend lpn
extension finished! takes 32.47ms to extend lpn
extension finished! takes 32.488ms to extend lpn
extension finished! takes 32.622ms to extend lpn
extension finished! takes 32.546ms to extend lpn
extension finished! takes 32.448ms to extend lpn
extension finished! takes 32.694ms to extend lpn
extension finished! takes 32.532ms to extend lpn
extension finished! takes 32.529ms to extend lpn
extension finished! takes 32.551ms to extend lpn
extension finished! takes 32.403ms to extend lpn
extension finished! takes 32.533ms to extend lpn
extension finished! takes 32.772ms to extend lpn
extension finished! takes 32.529ms to extend lpn
extension finished! takes 32.588ms to extend lpn
extension finished! takes 32.512ms to extend lpn
extension finished! takes 32.46ms to extend lpn
extension finished! takes 32.755ms to extend lpn
extension finished! takes 32.595ms to extend lpn
extension finished! takes 32.626ms to extend lpn
extension finished! takes 32.458ms to extend lpn
extension finished! takes 32.607ms to extend lpn
Operator #6 KeyedJoin ran for 116073.600000 ms, gate count: 184800000 output cardinality: 1500, row width=349
extension finished! takes 32.467ms to extend lpn
Operator #7 Project ran for 3615.279000 ms, gate count: 6835500 output cardinality: 1500, row width=249
Operator #8 SecureSqlInput ran for 5053.229000 ms, gate count: 0 output cardinality: 1500, row width=49
extension finished! takes 32.661ms to extend lpn
extension finished! takes 32.649ms to extend lpn
extension finished! takes 32.478ms to extend lpn
extension finished! takes 32.544ms to extend lpn
extension finished! takes 32.563ms to extend lpn
extension finished! takes 32.621ms to extend lpn
extension finished! takes 32.972ms to extend lpn
extension finished! takes 32.647ms to extend lpn
extension finished! takes 32.66ms to extend lpn
extension finished! takes 32.593ms to extend lpn
extension finished! takes 32.593ms to extend lpn
extension finished! takes 32.751ms to extend lpn
extension finished! takes 32.582ms to extend lpn
extension finished! takes 33.129ms to extend lpn
extension finished! takes 32.537ms to extend lpn
extension finished! takes 32.587ms to extend lpn
extension finished! takes 32.581ms to extend lpn
extension finished! takes 32.64ms to extend lpn
extension finished! takes 32.675ms to extend lpn
extension finished! takes 32.551ms to extend lpn
extension finished! takes 32.717ms to extend lpn
extension finished! takes 32.637ms to extend lpn
extension finished! takes 32.809ms to extend lpn
extension finished! takes 32.588ms to extend lpn
extension finished! takes 32.653ms to extend lpn
extension finished! takes 32.621ms to extend lpn
extension finished! takes 32.591ms to extend lpn
extension finished! takes 32.565ms to extend lpn
extension finished! takes 32.723ms to extend lpn
extension finished! takes 32.603ms to extend lpn
extension finished! takes 32.567ms to extend lpn
Operator #9 KeyedJoin ran for 103583.222000 ms, gate count: 155250000 output cardinality: 1500, row width=297
Operator #10 Project ran for 95.779000 ms, gate count: 0 output cardinality: 1500, row width=265
extension finished! takes 32.689ms to extend lpn
extension finished! takes 32.617ms to extend lpn
extension finished! takes 32.631ms to extend lpn
extension finished! takes 32.669ms to extend lpn
extension finished! takes 32.735ms to extend lpn
extension finished! takes 32.694ms to extend lpn
Operator #-1 Sort ran for 24407.234000 ms, gate count: 31933878 output cardinality: 1500, row width=265
extension finished! takes 32.53ms to extend lpn
Operator #11 SortMergeAggregate ran for 5089.422000 ms, gate count: 2278512 output cardinality: 1500, row width=265
extension finished! takes 32.537ms to extend lpn
extension finished! takes 32.608ms to extend lpn
extension finished! takes 32.604ms to extend lpn
extension finished! takes 32.681ms to extend lpn
extension finished! takes 32.712ms to extend lpn
extension finished! takes 32.62ms to extend lpn
Operator #12 Sort ran for 18223.380000 ms, gate count: 31933878 output cardinality: 1500, row width=265
Runtime: 282.744 sec, CPU Time: 66.721 sec, CPU clock ticks: 6.6721e+07, CPU clock ticks per second: 1000000
End-to-end estimated gates: 4.19617e+08. observed gates: 429678468 gates, relative error (%)=2.34152
[Linux]Peak resident set size: 550899712 bytes, current memory size: 364519424 bytes.
Initial Memory: 405262336 bytes, Peak Memory After Execution: 550899712 bytes, Memory Usage: 145637376 bytes
Bandwidth: 573308 Bps
TP send 112070348 bytes to party 1
TP send 101114579 bytes to party 2
TP send 101114579 bytes to party 3
total AND gate: 429678468
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.baseline_tpch_q9 (304146 ms)
[ RUN      ] GeneralizedComparisonTest.baseline_tpch_q18
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 366.048ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 550899712 bytes, current memory size: 364519424 bytes.
550899712
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 550899712 bytes, current memory size: 364519424 bytes.
Original Tree : 
#14: Sort<Bit> ({<-1, ASC> , <4, DESC> , <3, ASC> }) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(11) customer.c_custkey, #2 shared-int32(16) orders.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> , <4, DESC> , <3, ASC> }, cost est: 495150, output card: 100
    #13: SortMergeAggregate<Bit> (group-by: (0, 1, 2, 3, 4) aggs: (SUM($5) sum_qty)) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(11) customer.c_custkey, #2 shared-int32(16) orders.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<0, ASC> , <1, ASC> , <2, ASC> , <3, ASC> , <4, ASC> }, cost est: 2499000, output card: 1500
        #-1: Sort<Bit> ({<0, ASC> , <1, ASC> , <2, ASC> , <3, ASC> , <4, ASC> }) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(11) customer.c_custkey, #2 shared-int32(16) orders.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float l_quantity) order by: {<0, ASC> , <1, ASC> , <2, ASC> , <3, ASC> , <4, ASC> }, cost est: 28425946, output card: 1500
            #12: Project<Bit> ((<0, P$6(200) shared-varchar>, <1, P$5(11) shared-int32>, <2, P$0(16) shared-int32>, <3, P$3(28) shared-int64>, <4, P$2(32) shared-float>, <5, P$4(32) shared-float>)) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(11) customer.c_custkey, #2 shared-int32(16) orders.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float l_quantity) order by: {}, cost est: 0, output card: 1500
                #11: KeyedJoin<Bit> (P$1(11) == P$5(11)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float l_quantity, #5 shared-int32(11) customer.c_custkey, #6 shared-varchar(25) customer.c_name) order by: {}, cost est: 508500000, output card: 1500
                    #9: Project<Bit> ((<0, P$2(16) shared-int32>, <1, P$3(11) shared-int32>, <2, P$4(32) shared-float>, <3, P$5(28) shared-int64>, <4, P$1(32) shared-float>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float l_quantity) order by: {}, cost est: 0, output card: 1500
                        #8: KeyedJoin<Bit> (P$0(16) == P$2(16)) : (#0 shared-int32(16) lineitem.L2.l_orderkey, #1 shared-float sum_qty, #2 shared-int32(16) orders.o_orderkey, #3 shared-int32(11) orders.o_custkey, #4 shared-float orders.o_totalprice, #5 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 240750000, output card: 1500
                            #6: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$1(32) shared-float>)) : (#0 shared-int32(16) lineitem.L2.l_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 1500
                                #5: KeyedJoin<Bit> (P$0(16) == P$2(16)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float sum_qty, #2 shared-int32(16) lineitem.l_orderkey) order by: {<0, ASC> }, cost est: 81000000, output card: 1500
                                    #3: Filter<Bit> (P$1(32) > SECRET FLOAT) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 319500, output card: 1500
                                        #2: SortMergeAggregate<Bit> (group-by: (0) aggs: (SUM($1) sum_qty)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 1680000, output card: 1500
                                            #1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float lineitem.l_quantity) order by: {<0, ASC> }, cost est: 3107659, output card: 1500
                                                #0: SecureSqlInput<Bit> ("SELECT l_orderkey, l_quantity FROM lineitem", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float lineitem.l_quantity) order by: {}, cost est: 0, output card: 1500
                                    #4: SecureSqlInput<Bit> ("SELECT L2.l_orderkey FROM lineitem L2", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey) order by: {}, cost est: 0, output card: 1500
                            #7: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate FROM orders", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate) order by: {}, cost est: 0, output card: 1500
                    #10: SecureSqlInput<Bit> ("SELECT c_custkey, c_name FROM customer", tuple_count=1500) : (#0 shared-int32(11) customer.c_custkey, #1 shared-varchar(25) customer.c_name) order by: {}, cost est: 0, output card: 1500

Operator #0 SecureSqlInput ran for 11.367000 ms, gate count: 0 output cardinality: 1500, row width=49
Operator #1 Sort ran for 608.860000 ms, gate count: 3703110 output cardinality: 1500, row width=49
extension finished! takes 32.955ms to extend lpn
Operator #2 SortMergeAggregate ran for 234.748000 ms, gate count: 1632443 output cardinality: 1500, row width=49
Operator #3 Filter ran for 46.806000 ms, gate count: 321000 output cardinality: 1500, row width=49
Operator #4 SecureSqlInput ran for 4.002000 ms, gate count: 0 output cardinality: 1500, row width=17
extension finished! takes 33.054ms to extend lpn
extension finished! takes 32.763ms to extend lpn
extension finished! takes 32.607ms to extend lpn
extension finished! takes 32.695ms to extend lpn
extension finished! takes 32.539ms to extend lpn
extension finished! takes 32.682ms to extend lpn
extension finished! takes 32.596ms to extend lpn
extension finished! takes 32.568ms to extend lpn
extension finished! takes 32.504ms to extend lpn
extension finished! takes 32.561ms to extend lpn
extension finished! takes 32.631ms to extend lpn
extension finished! takes 32.637ms to extend lpn
extension finished! takes 32.57ms to extend lpn
extension finished! takes 32.937ms to extend lpn
extension finished! takes 32.707ms to extend lpn
extension finished! takes 32.494ms to extend lpn
Operator #5 KeyedJoin ran for 47476.429000 ms, gate count: 83250000 output cardinality: 1500, row width=65
Operator #6 Project ran for 5.650000 ms, gate count: 0 output cardinality: 1500, row width=49
Operator #7 SecureSqlInput ran for 5090.063000 ms, gate count: 0 output cardinality: 1500, row width=88
extension finished! takes 32.455ms to extend lpn
extension finished! takes 32.591ms to extend lpn
extension finished! takes 32.673ms to extend lpn
extension finished! takes 32.534ms to extend lpn
extension finished! takes 32.489ms to extend lpn
extension finished! takes 32.489ms to extend lpn
extension finished! takes 32.389ms to extend lpn
extension finished! takes 32.772ms to extend lpn
extension finished! takes 32.588ms to extend lpn
extension finished! takes 32.569ms to extend lpn
extension finished! takes 32.443ms to extend lpn
extension finished! takes 32.38ms to extend lpn
extension finished! takes 32.514ms to extend lpn
extension finished! takes 32.531ms to extend lpn
extension finished! takes 32.533ms to extend lpn
extension finished! takes 32.387ms to extend lpn
extension finished! takes 32.511ms to extend lpn
extension finished! takes 32.672ms to extend lpn
extension finished! takes 32.439ms to extend lpn
extension finished! takes 32.574ms to extend lpn
extension finished! takes 32.393ms to extend lpn
extension finished! takes 32.485ms to extend lpn
extension finished! takes 32.528ms to extend lpn
extension finished! takes 32.497ms to extend lpn
extension finished! takes 32.586ms to extend lpn
extension finished! takes 32.346ms to extend lpn
extension finished! takes 32.546ms to extend lpn
extension finished! takes 32.533ms to extend lpn
extension finished! takes 32.55ms to extend lpn
extension finished! takes 32.687ms to extend lpn
extension finished! takes 32.634ms to extend lpn
extension finished! takes 32.543ms to extend lpn
extension finished! takes 32.432ms to extend lpn
extension finished! takes 32.404ms to extend lpn
extension finished! takes 32.573ms to extend lpn
extension finished! takes 32.547ms to extend lpn
extension finished! takes 32.572ms to extend lpn
extension finished! takes 32.514ms to extend lpn
extension finished! takes 32.476ms to extend lpn
extension finished! takes 32.528ms to extend lpn
extension finished! takes 32.459ms to extend lpn
extension finished! takes 32.561ms to extend lpn
extension finished! takes 32.507ms to extend lpn
extension finished! takes 32.47ms to extend lpn
extension finished! takes 32.522ms to extend lpn
extension finished! takes 32.565ms to extend lpn
extension finished! takes 32.465ms to extend lpn
extension finished! takes 32.537ms to extend lpn
extension finished! takes 32.399ms to extend lpn
Operator #8 KeyedJoin ran for 165940.361000 ms, gate count: 243000000 output cardinality: 1500, row width=136
Operator #9 Project ran for 12.176000 ms, gate count: 0 output cardinality: 1500, row width=120
[ RUN      ] GeneralizedComparisonTest.cost_optimized_tpch_q1
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 553.59ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 68681728 bytes, current memory size: 31535104 bytes.
68681728
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 68681728 bytes, current memory size: 32321536 bytes.
Original Tree : 
#4: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty, #7 shared-float avg_price, #8 shared-float avg_disc, #9 shared-int64 count_order) order by: {<0, ASC> , <1, ASC> }, cost est: 4545, output card: 6
    #3: Project<Bit> ((<0, P$0(8) shared-varchar>, <1, P$1(8) shared-varchar>, <2, $2 + $15 shared-float>, <3, $3 + $16 shared-float>, <4, $4 + $17 shared-float>, <5, $5 + $18 shared-float>, <6, ($6 + $19) / ($7 + $20) shared-float>, <7, ($8 + $21) / ($9 + $22) shared-float>, <8, ($10 + $23) / ($11 + $24) shared-float>, <9, $12 + $25 shared-int64>)) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty, #7 shared-float avg_price, #8 shared-float avg_disc, #9 shared-int64 count_order) order by: {<0, ASC> , <1, ASC> }, cost est: 163596, output card: 6
        #2: MergeJoin<Bit> (no-op) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt, #13 shared-varchar(1) l_returnflag, #14 shared-varchar(1) l_linestatus, #15 shared-float sum_qty, #16 shared-float sum_base_price, #17 shared-float sum_disc_price, #18 shared-float sum_charge, #19 shared-float avg_qty_sum, #20 shared-float avg_qty_cnt, #21 shared-float avg_price_sum, #22 shared-float avg_price_cnt, #23 shared-float avg_discount_sum, #24 shared-float avg_discount_cnt, #25 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 18, output card: 6
            #0: SecureSqlInput<Bit> ("WITH output_domain AS (
    SELECT  *
    FROM (VALUES('R'::char(1), 'F'::char(1)), ('A', 'F'), ('N', 'F'), ('R', 'O'), ('A', 'O'), ('N', 'O')) AS li(l_returnflag, l_linestatus)
    ORDER BY l_returnflag, l_linestatus),
     partial_aggs AS (
         SELECT l_returnflag, l_linestatus, SUM(l_quantity) sum_qty, SUM(l_extendedprice) sum_base_price,
                SUM(l_extendedprice*(1-l_discount)) sum_disc_price, SUM(l_extendedprice*(1-l_discount)*(1+l_tax)) sum_charge,
                SUM(l_quantity) avg_qty_sum, COUNT(l_quantity)::FLOAT4 avg_qty_cnt,
                 SUM(l_extendedprice) avg_price_sum, COUNT(l_extendedprice)::FLOAT4 avg_price_cnt,
                 SUM(l_discount) avg_discount_sum, COUNT(l_discount)::FLOAT4 avg_discount_cnt, COUNT(*) cnt
         FROM lineitem
         WHERE l_shipdate  <= date '1998-08-03'
         GROUP BY l_returnflag, l_linestatus
         ORDER BY l_returnflag, l_linestatus)
SELECT o.l_returnflag, o.l_linestatus, COALESCE(sum_qty, 0) sum_qty, COALESCE(sum_base_price, 0) sum_base_price, COALESCE(sum_disc_price, 0) sum_disc_price, COALESCE(sum_charge, 0) sum_charge, COALESCE(avg_qty_sum, 0) avg_qty_sum, COALESCE(avg_qty_cnt, 0) avg_qty_cnt,  COALESCE(avg_price_sum, 0) avg_price_sum, COALESCE(avg_price_cnt, 0) avg_price_cnt,  COALESCE(avg_discount_sum, 0) avg_discount_sum, COALESCE(avg_discount_cnt, 0) avg_discount_cnt,  COALESCE(cnt, 0)::BIGINT cnt, CASE WHEN p.l_returnflag IS NULL THEN true ELSE false END AS dummy_tag
FROM output_domain o LEFT JOIN partial_aggs p ON o.l_returnflag = p.l_returnflag AND o.l_linestatus = p.l_linestatus
ORDER BY o.l_returnflag, o.l_linestatus", tuple_count=6) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 0, output card: 6
            #1: SecureSqlInput<Bit> ("WITH output_domain AS (
    SELECT  *
    FROM (VALUES('R'::char(1), 'F'::char(1)), ('A', 'F'), ('N', 'F'), ('R', 'O'), ('A', 'O'), ('N', 'O')) AS li(l_returnflag, l_linestatus)
    ORDER BY l_returnflag, l_linestatus),
     partial_aggs AS (
         SELECT l_returnflag, l_linestatus, SUM(l_quantity) sum_qty, SUM(l_extendedprice) sum_base_price,
                SUM(l_extendedprice*(1-l_discount)) sum_disc_price, SUM(l_extendedprice*(1-l_discount)*(1+l_tax)) sum_charge,
                SUM(l_quantity) avg_qty_sum, COUNT(l_quantity)::FLOAT4 avg_qty_cnt,
                 SUM(l_extendedprice) avg_price_sum, COUNT(l_extendedprice)::FLOAT4 avg_price_cnt,
                 SUM(l_discount) avg_discount_sum, COUNT(l_discount)::FLOAT4 avg_discount_cnt, COUNT(*) cnt
         FROM lineitem
         WHERE l_shipdate  <= date '1998-08-03'
         GROUP BY l_returnflag, l_linestatus
         ORDER BY l_returnflag, l_linestatus)
SELECT o.l_returnflag, o.l_linestatus, COALESCE(sum_qty, 0) sum_qty, COALESCE(sum_base_price, 0) sum_base_price, COALESCE(sum_disc_price, 0) sum_disc_price, COALESCE(sum_charge, 0) sum_charge, COALESCE(avg_qty_sum, 0) avg_qty_sum, COALESCE(avg_qty_cnt, 0) avg_qty_cnt,  COALESCE(avg_price_sum, 0) avg_price_sum, COALESCE(avg_price_cnt, 0) avg_price_cnt,  COALESCE(avg_discount_sum, 0) avg_discount_sum, COALESCE(avg_discount_cnt, 0) avg_discount_cnt,  COALESCE(cnt, 0)::BIGINT cnt, CASE WHEN p.l_returnflag IS NULL THEN true ELSE false END AS dummy_tag
FROM output_domain o LEFT JOIN partial_aggs p ON o.l_returnflag = p.l_returnflag AND o.l_linestatus = p.l_linestatus
ORDER BY o.l_returnflag, o.l_linestatus", tuple_count=0) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 0, output card: 0

Total Plans : 1
Cost Optimized Plan : 
#3: Project<Bit> ((<0, P$0(8) shared-varchar>, <1, P$1(8) shared-varchar>, <2, $2 + $15 shared-float>, <3, $3 + $16 shared-float>, <4, $4 + $17 shared-float>, <5, $5 + $18 shared-float>, <6, ($6 + $19) / ($7 + $20) shared-float>, <7, ($8 + $21) / ($9 + $22) shared-float>, <8, ($10 + $23) / ($11 + $24) shared-float>, <9, $12 + $25 shared-int64>)) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float anonymous, #3 shared-float anonymous, #4 shared-float anonymous, #5 shared-float anonymous, #6 shared-float anonymous, #7 shared-float anonymous, #8 shared-float anonymous, #9 shared-int64 anonymous) order by: {<0, ASC> , <1, ASC> }, cost est: 163596, output card: 6
    #2: MergeJoin<Bit> (no-op) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt, #13 shared-varchar(1) l_returnflag, #14 shared-varchar(1) l_linestatus, #15 shared-float sum_qty, #16 shared-float sum_base_price, #17 shared-float sum_disc_price, #18 shared-float sum_charge, #19 shared-float avg_qty_sum, #20 shared-float avg_qty_cnt, #21 shared-float avg_price_sum, #22 shared-float avg_price_cnt, #23 shared-float avg_discount_sum, #24 shared-float avg_discount_cnt, #25 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 18, output card: 6
        #0: SecureSqlInput<Bit> ("WITH output_domain AS (
    SELECT  *
    FROM (VALUES('R'::char(1), 'F'::char(1)), ('A', 'F'), ('N', 'F'), ('R', 'O'), ('A', 'O'), ('N', 'O')) AS li(l_returnflag, l_linestatus)
    ORDER BY l_returnflag, l_linestatus),
     partial_aggs AS (
         SELECT l_returnflag, l_linestatus, SUM(l_quantity) sum_qty, SUM(l_extendedprice) sum_base_price,
                SUM(l_extendedprice*(1-l_discount)) sum_disc_price, SUM(l_extendedprice*(1-l_discount)*(1+l_tax)) sum_charge,
                SUM(l_quantity) avg_qty_sum, COUNT(l_quantity)::FLOAT4 avg_qty_cnt,
                 SUM(l_extendedprice) avg_price_sum, COUNT(l_extendedprice)::FLOAT4 avg_price_cnt,
                 SUM(l_discount) avg_discount_sum, COUNT(l_discount)::FLOAT4 avg_discount_cnt, COUNT(*) cnt
         FROM lineitem
         WHERE l_shipdate  <= date '1998-08-03'
         GROUP BY l_returnflag, l_linestatus
         ORDER BY l_returnflag, l_linestatus)
SELECT o.l_returnflag, o.l_linestatus, COALESCE(sum_qty, 0) sum_qty, COALESCE(sum_base_price, 0) sum_base_price, COALESCE(sum_disc_price, 0) sum_disc_price, COALESCE(sum_charge, 0) sum_charge, COALESCE(avg_qty_sum, 0) avg_qty_sum, COALESCE(avg_qty_cnt, 0) avg_qty_cnt,  COALESCE(avg_price_sum, 0) avg_price_sum, COALESCE(avg_price_cnt, 0) avg_price_cnt,  COALESCE(avg_discount_sum, 0) avg_discount_sum, COALESCE(avg_discount_cnt, 0) avg_discount_cnt,  COALESCE(cnt, 0)::BIGINT cnt, CASE WHEN p.l_returnflag IS NULL THEN true ELSE false END AS dummy_tag
FROM output_domain o LEFT JOIN partial_aggs p ON o.l_returnflag = p.l_returnflag AND o.l_linestatus = p.l_linestatus
ORDER BY o.l_returnflag, o.l_linestatus", tuple_count=6) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 0, output card: 6
        #1: SecureSqlInput<Bit> ("WITH output_domain AS (
    SELECT  *
    FROM (VALUES('R'::char(1), 'F'::char(1)), ('A', 'F'), ('N', 'F'), ('R', 'O'), ('A', 'O'), ('N', 'O')) AS li(l_returnflag, l_linestatus)
    ORDER BY l_returnflag, l_linestatus),
     partial_aggs AS (
         SELECT l_returnflag, l_linestatus, SUM(l_quantity) sum_qty, SUM(l_extendedprice) sum_base_price,
                SUM(l_extendedprice*(1-l_discount)) sum_disc_price, SUM(l_extendedprice*(1-l_discount)*(1+l_tax)) sum_charge,
                SUM(l_quantity) avg_qty_sum, COUNT(l_quantity)::FLOAT4 avg_qty_cnt,
                 SUM(l_extendedprice) avg_price_sum, COUNT(l_extendedprice)::FLOAT4 avg_price_cnt,
                 SUM(l_discount) avg_discount_sum, COUNT(l_discount)::FLOAT4 avg_discount_cnt, COUNT(*) cnt
         FROM lineitem
         WHERE l_shipdate  <= date '1998-08-03'
         GROUP BY l_returnflag, l_linestatus
         ORDER BY l_returnflag, l_linestatus)
SELECT o.l_returnflag, o.l_linestatus, COALESCE(sum_qty, 0) sum_qty, COALESCE(sum_base_price, 0) sum_base_price, COALESCE(sum_disc_price, 0) sum_disc_price, COALESCE(sum_charge, 0) sum_charge, COALESCE(avg_qty_sum, 0) avg_qty_sum, COALESCE(avg_qty_cnt, 0) avg_qty_cnt,  COALESCE(avg_price_sum, 0) avg_price_sum, COALESCE(avg_price_cnt, 0) avg_price_cnt,  COALESCE(avg_discount_sum, 0) avg_discount_sum, COALESCE(avg_discount_cnt, 0) avg_discount_cnt,  COALESCE(cnt, 0)::BIGINT cnt, CASE WHEN p.l_returnflag IS NULL THEN true ELSE false END AS dummy_tag
FROM output_domain o LEFT JOIN partial_aggs p ON o.l_returnflag = p.l_returnflag AND o.l_linestatus = p.l_linestatus
ORDER BY o.l_returnflag, o.l_linestatus", tuple_count=0) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 0, output card: 0

Cost Optimization Time : 0.00037 sec
Operator #0 SecureSqlInput ran for 0.510000 ms, gate count: 0 output cardinality: 6, row width=401
Operator #1 SecureSqlInput ran for 0.047000 ms, gate count: 0 output cardinality: 0, row width=401
Operator #2 MergeJoin ran for 0.459000 ms, gate count: 0 output cardinality: 6, row width=801
Operator #3 Project ran for 15.997000 ms, gate count: 128100 output cardinality: 6, row width=305
Runtime: 0.127162 sec, CPU Time: 0.021696 sec, CPU clock ticks: 21696, CPU clock ticks per second: 1000000
End-to-end estimated gates: 163614. observed gates: 128100 gates, relative error (%)=27.7237
[Linux]Peak resident set size: 68681728 bytes, current memory size: 36909056 bytes.
Initial Memory: 68681728 bytes, Peak Memory After Execution: 68681728 bytes, Memory Usage: 0 bytes
Bandwidth: 289898 Bps
TP send 12547474 bytes to party 1
TP send 12467059 bytes to party 2
TP send 12467059 bytes to party 3
total AND gate: 128100
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.cost_optimized_tpch_q1 (826 ms)
[ RUN      ] GeneralizedComparisonTest.cost_optimized_tpch_q3
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 394.461ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 78086144 bytes, current memory size: 78086144 bytes.
78086144
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 78217216 bytes, current memory size: 78217216 bytes.
Original Tree : 
#9: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$3(32) shared-float>, <2, P$1(28) shared-int64>, <3, P$2(1) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-float revenue, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority) order by: {<-1, ASC> , <1, DESC> , <2, ASC> }, cost est: 0, output card: 10
    #8: Sort<Bit> ({<-1, ASC> , <3, DESC> , <1, ASC> }) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <3, DESC> , <1, ASC> }, cost est: 5312, output card: 10
        #7: SortMergeAggregate<Bit> (group-by: (0, 1, 2) aggs: (SUM($3) revenue)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> , <1, ASC> , <2, ASC> }, cost est: 1773000, output card: 60175
            #6: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$1(28) shared-int64>, <2, P$2(1) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <0, ASC> }, cost est: 0, output card: 1500
                #5: KeyedSortMergeJoin<Bit> (P$0(16) == P$3(16) - sortCompatible) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-int32(16) lineitem.l_orderkey, #4 shared-float revenue) order by: {<-1, ASC> , <0, ASC> , <3, ASC> }, cost est: 34989333, output card: 1500
                    #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority) order by: {<0, ASC> }, cost est: 2970557, output card: 1500
                        #3: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$2(28) shared-int64>, <2, P$3(1) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority) order by: {<-1, ASC> }, cost est: 0, output card: 1500
                            #2: KeyedSortMergeJoin<Bit> (P$1(11) == P$4(11) - sortCompatible) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority, #4 shared-int32(11) customer.c_custkey) order by: {<-1, ASC> , <1, ASC> , <4, ASC> }, cost est: 36362709, output card: 1500
                                #-1: Sort<Bit> ({<1, ASC> }) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority) order by: {<1, ASC> }, cost est: 3244762, output card: 1500
                                    #0: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_orderdate, o_shippriority, NOT o_orderdate < DATE '1995-03-25' AS dummy_tag FROM orders ORDER BY o_orderkey, o_orderdate, o_shippriority", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority) order by: {<0, ASC> }, cost est: 0, output card: 1500
                                #1: SecureSqlInput<Bit> ("SELECT c_custkey, NOT c_mktsegment = 'HOUSEHOLD' AS dummy_tag FROM customer ORDER BY c_custkey", tuple_count=1500) : (#0 shared-int32(11) customer.c_custkey) order by: {<0, ASC> }, cost est: 0, output card: 1500
                    #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_extendedprice * (1 - l_discount) AS revenue, NOT l_shipdate > DATE '1995-03-25' AS dummy_tag FROM lineitem ORDER BY l_orderkey", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 0, output card: 1500

Total Plans : 96
Cost Optimized Plan : 
#9: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$3(32) shared-float>, <2, P$1(28) shared-int64>, <3, P$2(1) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-float revenue, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority) order by: {<-1, ASC> , <1, DESC> , <2, ASC> }, cost est: 0, output card: 10
    #8: Sort<Bit> ({<-1, ASC> , <3, DESC> , <1, ASC> }) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <3, DESC> , <1, ASC> }, cost est: 5312, output card: 10
        #7: SortMergeAggregate<Bit> (group-by: (0, 1, 2) aggs: (SUM($3) revenue)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> , <1, ASC> , <2, ASC> }, cost est: 1773000, output card: 60175
            #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> }, cost est: 4432985, output card: 1500
                #6: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$1(28) shared-int64>, <2, P$2(1) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <0, ASC> }, cost est: 0, output card: 1500
                    #5: KeyedSortMergeJoin<Bit> (P$0(16) == P$3(16) - sortCompatible) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority, #3 shared-int32(16) lineitem.l_orderkey, #4 shared-float revenue) order by: {<-1, ASC> , <0, ASC> , <3, ASC> }, cost est: 34989333, output card: 1500
                        #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority) order by: {<0, ASC> }, cost est: 2970557, output card: 1500
                            #3: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$2(28) shared-int64>, <2, P$3(1) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32(1) orders.o_shippriority) order by: {<-1, ASC> }, cost est: 0, output card: 1500
                                #2: KeyedSortMergeJoin<Bit> (P$1(11) == P$4(11) - sortCompatible) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority, #4 shared-int32(11) customer.c_custkey) order by: {<-1, ASC> , <1, ASC> , <4, ASC> }, cost est: 36362709, output card: 1500
                                    #0: SecureSqlInput<Bit> ("SELECT * FROM (SELECT o_orderkey, o_custkey, o_orderdate, o_shippriority, NOT o_orderdate < DATE '1995-03-25' AS dummy_tag FROM orders ORDER BY o_orderkey, o_orderdate, o_shippriority) to_sort ORDER BY (2)  ASC ", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32(1) orders.o_shippriority) order by: {<1, ASC> }, cost est: 561823, output card: 1500
                                    #1: SecureSqlInput<Bit> ("SELECT c_custkey, NOT c_mktsegment = 'HOUSEHOLD' AS dummy_tag FROM customer ORDER BY c_custkey", tuple_count=1500) : (#0 shared-int32(11) customer.c_custkey) order by: {<0, ASC> }, cost est: 0, output card: 1500
                        #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_extendedprice * (1 - l_discount) AS revenue, NOT l_shipdate > DATE '1995-03-25' AS dummy_tag FROM lineitem ORDER BY l_orderkey", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 0, output card: 1500

Cost Optimization Time : 0.017689 sec
Operator #0 SecureSqlInput ran for 13.909000 ms, gate count: 0 output cardinality: 1500, row width=57
Operator #1 SecureSqlInput ran for 3.437000 ms, gate count: 0 output cardinality: 1500, row width=12
extension finished! takes 32.522ms to extend lpn
extension finished! takes 32.56ms to extend lpn
extension finished! takes 32.52ms to extend lpn
extension finished! takes 32.573ms to extend lpn
extension finished! takes 32.602ms to extend lpn
Operator #2 KeyedSortMergeJoin ran for 4826.263000 ms, gate count: 25911033 output cardinality: 1500, row width=68
Operator #3 Project ran for 4.376000 ms, gate count: 0 output cardinality: 1500, row width=46
Operator #-1 Sort ran for 596.416000 ms, gate count: 3572412 output cardinality: 1500, row width=46
Operator #4 SecureSqlInput ran for 10.870000 ms, gate count: 0 output cardinality: 1500, row width=49
extension finished! takes 32.498ms to extend lpn
extension finished! takes 32.561ms to extend lpn
extension finished! takes 32.598ms to extend lpn
extension finished! takes 32.631ms to extend lpn
extension finished! takes 32.83ms to extend lpn
Operator #5 KeyedSortMergeJoin ran for 21222.819000 ms, gate count: 54545460 output cardinality: 1500, row width=94
Operator #6 Project ran for 7.915000 ms, gate count: 0 output cardinality: 1500, row width=78
extension finished! takes 32.403ms to extend lpn
Operator #-1 Sort ran for 795.685000 ms, gate count: 4966524 output cardinality: 1500, row width=78
extension finished! takes 32.669ms to extend lpn
Operator #7 SortMergeAggregate ran for 2317.521000 ms, gate count: 1728379 output cardinality: 1500, row width=78
extension finished! takes 32.599ms to extend lpn
extension finished! takes 32.769ms to extend lpn
extension finished! takes 32.652ms to extend lpn
extension finished! takes 32.789ms to extend lpn
extension finished! takes 32.839ms to extend lpn
Operator #8 Sort ran for 20404.889000 ms, gate count: 24789054 output cardinality: 10, row width=78
Operator #9 Project ran for 0.063000 ms, gate count: 0 output cardinality: 10, row width=78
Runtime: 50.2752 sec, CPU Time: 17.0388 sec, CPU clock ticks: 1.70388e+07, CPU clock ticks per second: 1000000
End-to-end estimated gates: 8.05339e+07. observed gates: 86029417 gates, relative error (%)=6.38795
[Linux]Peak resident set size: 300908544 bytes, current memory size: 69996544 bytes.
Initial Memory: 78217216 bytes, Peak Memory After Execution: 300908544 bytes, Memory Usage: 222691328 bytes
Bandwidth: 645337 Bps
TP send 36198096 bytes to party 1
TP send 30196563 bytes to party 2
TP send 30196563 bytes to party 3
total AND gate: 86029417
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.cost_optimized_tpch_q3 (51306 ms)
[ RUN      ] GeneralizedComparisonTest.cost_optimized_tpch_q5
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 405.765ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 300908544 bytes, current memory size: 90574848 bytes.
300908544
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 300908544 bytes, current memory size: 90574848 bytes.
Original Tree : 
#11: Sort<Bit> ({<1, DESC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<1, DESC> }, cost est: 2583, output card: 5
    #10: SortMergeAggregate<Bit> (group-by: (0) aggs: (SUM($1) revenue)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 2229000, output card: 5
        #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 19925584, output card: 1500
            #9: Project<Bit> ((<0, P$4(200) shared-varchar>, <1, P$2(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<-1, ASC> }, cost est: 0, output card: 1500
                #8: KeyedSortMergeJoin<Bit> ((P$1(16) == P$5(16)) AND (P$0(5) == P$3(5)) - not sort compatible, need sort in smj) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float revenue, #3 shared-int32(5) customer.c_nationkey, #4 shared-varchar(25) nation.n_name, #5 shared-int32(16) orders.o_orderkey) order by: {<-1, ASC> , <1, ASC> , <5, ASC> , <0, ASC> , <3, ASC> }, cost est: 103639476, output card: 1500
                    #-1: Sort<Bit> ({<1, ASC> , <0, ASC> }) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float revenue) order by: {<1, ASC> , <0, ASC> }, cost est: 3701771, output card: 1500
                        #3: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(16) shared-int32>, <2, P$4(32) shared-float>)) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float revenue) order by: {}, cost est: 0, output card: 1500
                            #2: KeyedJoin<Bit> (P$0(7) == P$3(7)) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey, #2 shared-int32(16) lineitem.l_orderkey, #3 shared-int32(7) lineitem.l_suppkey, #4 shared-float revenue) order by: {<3, ASC> , <0, ASC> }, cost est: 690000, output card: 1500
                                #0: SecureSqlInput<Bit> ("SELECT s_suppkey, s_nationkey FROM supplier JOIN nation ON s_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE r_name = 'EUROPE' ORDER BY s_suppkey", tuple_count=20) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey) order by: {<0, ASC> }, cost est: 0, output card: 20
                                #1: SecureSqlInput<Bit> ("SELECT l_orderkey, l_suppkey, l_extendedprice * (1 - l_discount) AS revenue FROM lineitem ORDER BY l_suppkey", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float revenue) order by: {<1, ASC> }, cost est: 0, output card: 1500
                    #-1: Sort<Bit> ({<-1, ASC> }) : (#0 shared-int32(5) customer.c_nationkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(16) orders.o_orderkey) order by: {<-1, ASC> }, cost est: 10328399, output card: 1500
                        #7: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(200) shared-varchar>, <2, P$3(16) shared-int32>)) : (#0 shared-int32(5) customer.c_nationkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(16) orders.o_orderkey) order by: {<-1, ASC> }, cost est: 0, output card: 1500
                            #6: KeyedSortMergeJoin<Bit> (P$0(11) == P$4(11) - sortCompatible) : (#0 shared-int32(11) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name, #3 shared-int32(16) orders.o_orderkey, #4 shared-int32(11) orders.o_custkey) order by: {<-1, ASC> , <0, ASC> , <4, ASC> }, cost est: 31783601, output card: 1500
                                #4: SecureSqlInput<Bit> ("SELECT t2.c_custkey, t2.c_nationkey, t1.n_name FROM (SELECT r_regionkey, r_name FROM region WHERE r_name = 'EUROPE') AS t0 INNER JOIN (SELECT n_nationkey, n_name, n_regionkey FROM nation) AS t1 ON t0.r_regionkey = t1.n_regionkey INNER JOIN (SELECT c_custkey, c_nationkey FROM customer) AS t2 ON t1.n_nationkey = t2.c_nationkey ORDER BY t2.c_custkey ASC", tuple_count=272) : (#0 shared-int32(11) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name) order by: {<0, ASC> }, cost est: 0, output card: 272
                                #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, NOT (o_orderdate >= DATE '1993-01-01' AND o_orderdate < DATE '1994-01-01') AS dummy_tag FROM orders ORDER BY o_custkey, o_orderdate", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey) order by: {<1, ASC> }, cost est: 0, output card: 1500

Total Plans : 144
Cost Optimized Plan : 
#11: Sort<Bit> ({<1, DESC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<1, DESC> }, cost est: 2583, output card: 5
    #10: NestedLoopAggregate<Bit> (group-by: (0) aggs: (SUM($1) revenue)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {}, cost est: 11385000, output card: 5
        #9: Project<Bit> ((<0, P$4(200) shared-varchar>, <1, P$2(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<-1, ASC> }, cost est: 0, output card: 1500
            #8: KeyedSortMergeJoin<Bit> ((P$1(16) == P$5(16)) AND (P$0(5) == P$3(5)) - sortCompatible) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float revenue, #3 shared-int32(5) customer.c_nationkey, #4 shared-varchar(25) nation.n_name, #5 shared-int32(16) orders.o_orderkey) order by: {<-1, ASC> , <1, ASC> , <5, ASC> , <0, ASC> , <3, ASC> }, cost est: 79326610, output card: 1500
                #3: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(16) shared-int32>, <2, P$4(32) shared-float>)) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(16) lineitem.l_orderkey, #2 shared-float revenue) order by: {<1, ASC> , <0, ASC> }, cost est: 0, output card: 1500
                    #2: KeyedJoin<Bit> (P$0(7) == P$3(7)) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey, #2 shared-int32(16) lineitem.l_orderkey, #3 shared-int32(7) lineitem.l_suppkey, #4 shared-float revenue) order by: {<2, ASC> , <1, ASC> }, cost est: 690000, output card: 1500
                        #0: SecureSqlInput<Bit> ("SELECT * FROM (SELECT s_suppkey, s_nationkey FROM supplier JOIN nation ON s_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE r_name = 'EUROPE' ORDER BY s_suppkey) to_sort ORDER BY (2)  ASC ", tuple_count=20) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey) order by: {<1, ASC> }, cost est: 903, output card: 20
                        #1: SecureSqlInput<Bit> ("SELECT * FROM (SELECT l_orderkey, l_suppkey, l_extendedprice * (1 - l_discount) AS revenue FROM lineitem ORDER BY l_suppkey) to_sort ORDER BY (1)  ASC ", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float revenue) order by: {<0, ASC> }, cost est: 593475, output card: 1500
                #-1: Sort<Bit> ({<2, ASC> , <0, ASC> }) : (#0 shared-int32(5) customer.c_nationkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(16) orders.o_orderkey) order by: {<2, ASC> , <0, ASC> }, cost est: 11379519, output card: 1500
                    #-1: Sort<Bit> ({}) : (#0 shared-int32(5) customer.c_nationkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(16) orders.o_orderkey) order by: {}, cost est: 10145595, output card: 1500
                        #7: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(200) shared-varchar>, <2, P$3(16) shared-int32>)) : (#0 shared-int32(5) customer.c_nationkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(16) orders.o_orderkey) order by: {<-1, ASC> }, cost est: 0, output card: 1500
                            #6: KeyedSortMergeJoin<Bit> (P$0(11) == P$4(11) - sortCompatible) : (#0 shared-int32(11) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name, #3 shared-int32(16) orders.o_orderkey, #4 shared-int32(11) orders.o_custkey) order by: {<-1, ASC> , <0, ASC> , <4, ASC> }, cost est: 31783601, output card: 1500
                                #4: SecureSqlInput<Bit> ("SELECT t2.c_custkey, t2.c_nationkey, t1.n_name FROM (SELECT r_regionkey, r_name FROM region WHERE r_name = 'EUROPE') AS t0 INNER JOIN (SELECT n_nationkey, n_name, n_regionkey FROM nation) AS t1 ON t0.r_regionkey = t1.n_regionkey INNER JOIN (SELECT c_custkey, c_nationkey FROM customer) AS t2 ON t1.n_nationkey = t2.c_nationkey ORDER BY t2.c_custkey ASC", tuple_count=272) : (#0 shared-int32(11) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name) order by: {<0, ASC> }, cost est: 0, output card: 272
                                #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, NOT (o_orderdate >= DATE '1993-01-01' AND o_orderdate < DATE '1994-01-01') AS dummy_tag FROM orders ORDER BY o_custkey, o_orderdate", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey) order by: {<1, ASC> }, cost est: 0, output card: 1500

Cost Optimization Time : 0.027956 sec
Operator #0 SecureSqlInput ran for 0.094000 ms, gate count: 0 output cardinality: 20, row width=13
Operator #1 SecureSqlInput ran for 15.549000 ms, gate count: 0 output cardinality: 1500, row width=56
Operator #2 KeyedJoin ran for 109.398000 ms, gate count: 720000 output cardinality: 1500, row width=68
Operator #3 Project ran for 5.935000 ms, gate count: 0 output cardinality: 1500, row width=54
Operator #4 SecureSqlInput ran for 194.907000 ms, gate count: 0 output cardinality: 272, row width=217
Operator #5 SecureSqlInput ran for 241.610000 ms, gate count: 0 output cardinality: 1500, row width=28
extension finished! takes 32.584ms to extend lpn
extension finished! takes 32.783ms to extend lpn
extension finished! takes 32.543ms to extend lpn
extension finished! takes 32.648ms to extend lpn
extension finished! takes 32.818ms to extend lpn
extension finished! takes 32.734ms to extend lpn
extension finished! takes 32.748ms to extend lpn
Operator #6 KeyedSortMergeJoin ran for 14196.975000 ms, gate count: 38769779 output cardinality: 1500, row width=244
Operator #7 Project ran for 89.174000 ms, gate count: 0 output cardinality: 1500, row width=222
extension finished! takes 32.604ms to extend lpn
extension finished! takes 32.611ms to extend lpn
Operator #-1 Sort ran for 6742.388000 ms, gate count: 9671652 output cardinality: 1500, row width=222
extension finished! takes 32.755ms to extend lpn
extension finished! takes 32.654ms to extend lpn
extension finished! takes 32.657ms to extend lpn
Operator #-1 Sort ran for 12264.758000 ms, gate count: 11849952 output cardinality: 1500, row width=222
extension finished! takes 32.319ms to extend lpn
extension finished! takes 32.907ms to extend lpn
extension finished! takes 32.525ms to extend lpn
extension finished! takes 32.455ms to extend lpn
extension finished! takes 32.525ms to extend lpn
extension finished! takes 32.595ms to extend lpn
extension finished! takes 32.436ms to extend lpn
extension finished! takes 32.554ms to extend lpn
extension finished! takes 32.389ms to extend lpn
extension finished! takes 32.438ms to extend lpn
extension finished! takes 32.533ms to extend lpn
extension finished! takes 32.468ms to extend lpn
extension finished! takes 32.481ms to extend lpn
Operator #8 KeyedSortMergeJoin ran for 50880.369000 ms, gate count: 128576314 output cardinality: 1500, row width=275
Operator #9 Project ran for 92.747000 ms, gate count: 0 output cardinality: 1500, row width=233
extension finished! takes 32.675ms to extend lpn
extension finished! takes 32.472ms to extend lpn
Operator #10 NestedLoopAggregate ran for 6181.505000 ms, gate count: 10942500 output cardinality: 5, row width=233
Operator #11 Sort ran for 0.747000 ms, gate count: 5940 output cardinality: 5, row width=233
Runtime: 91.1683 sec, CPU Time: 28.7906 sec, CPU clock ticks: 2.87906e+07, CPU clock ticks per second: 1000000
End-to-end estimated gates: 1.44713e+08. observed gates: 139524754 gates, relative error (%)=3.71845
[Linux]Peak resident set size: 818745344 bytes, current memory size: 74551296 bytes.
Initial Memory: 300908544 bytes, Peak Memory After Execution: 818745344 bytes, Memory Usage: 517836800 bytes
Bandwidth: 577278 Bps
TP send 48550316 bytes to party 1
TP send 40625683 bytes to party 2
TP send 40625683 bytes to party 3
total AND gate: 139524754
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.cost_optimized_tpch_q5 (111817 ms)
[ RUN      ] GeneralizedComparisonTest.cost_optimized_tpch_q8
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 313.119ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 818745344 bytes, current memory size: 111251456 bytes.
818745344
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 818745344 bytes, current memory size: 111251456 bytes.
Original Tree : 
#12: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32 orders.o_year, #1 shared-float mkt_share) order by: {<0, ASC> }, cost est: 100, output card: 2
    #11: Project<Bit> ((<0, P$0(32) shared-int32>, <1, $2 / $1 shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float mkt_share) order by: {<0, ASC> }, cost est: 7618, output card: 2
        #10: SortMergeAggregate<Bit> (group-by: (0) aggs: (SUM($1) null, SUM($2) null)) : (#0 shared-int32 orders.o_year, #1 shared-float null, #2 shared-float null) order by: {<0, ASC> }, cost est: 3450000, output card: 2
            #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32 orders.o_year, #1 shared-float volume, #2 shared-float selected_volume) order by: {<0, ASC> }, cost est: 6032516, output card: 1500
                #9: Project<Bit> ((<0, P$1(32) shared-int32>, <1, P$3(32) shared-float>, <2, CASE($4, $3, SECRET FLOAT) shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float volume, #2 shared-float selected_volume) order by: {}, cost est: 0, output card: 1500
                    #8: KeyedJoin<Bit> (P$0(16) == P$2(16)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32 orders.o_year, #2 shared-int32(16) lineitem.l_orderkey, #3 shared-float volume, #4 shared-bool nation_check) order by: {}, cost est: 153000000, output card: 1500
                        #3: Project<Bit> ((<0, P$1(16) shared-int32>, <1, P$3(32) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32 orders.o_year) order by: {}, cost est: 0, output card: 1500
                            #2: KeyedJoin<Bit> (P$0(11) == P$2(11)) : (#0 shared-int32(11) customer.c_custkey, #1 shared-int32(16) orders.o_orderkey, #2 shared-int32(11) orders.o_custkey, #3 shared-int32 orders.o_year) order by: {<2, ASC> , <0, ASC> }, cost est: 11778000, output card: 1500
                                #0: SecureSqlInput<Bit> ("SELECT c_custkey FROM customer c JOIN nation n1 ON c_nationkey = n_nationkey JOIN region ON r_regionkey = n_regionkey WHERE r_name = 'AFRICA' ORDER BY c_custkey", tuple_count=302) : (#0 shared-int32(11) customer.c_custkey) order by: {<0, ASC> }, cost est: 0, output card: 302
                                #1: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_orderyear::INT AS o_year, NOT (o_orderdate >= date '1995-01-01' and o_orderdate < date '1996-12-31') dummy_tag FROM orders ORDER BY o_custkey", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int32 orders.o_year) order by: {<1, ASC> }, cost est: 0, output card: 1500
                        #7: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$2(32) shared-float>, <2, P$4(1) shared-bool>)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float volume, #2 shared-bool nation_check) order by: {}, cost est: 0, output card: 1500
                            #6: KeyedJoin<Bit> (P$1(7) == P$3(7)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float volume, #3 shared-int32(7) supplier.s_suppkey, #4 shared-bool nation_check) order by: {<1, ASC> , <3, ASC> }, cost est: 2850000, output card: 1500
                                #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_suppkey, l_extendedprice * (1.0 - l_discount) AS volume,        CASE            WHEN p_type = 'LARGE ANODIZED STEEL' AND p_partkey = l_partkey THEN FALSE            ELSE TRUE            END AS dummy_tag FROM lineitem LEFT JOIN part ON p_partkey = l_partkey ORDER BY l_suppkey", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float volume) order by: {<1, ASC> }, cost est: 0, output card: 1500
                                #5: SecureSqlInput<Bit> ("SELECT s_suppkey, CASE WHEN n_name = 'KENYA' THEN true ELSE false END AS nation_check FROM supplier JOIN nation ON n_nationkey = s_nationkey ORDER BY s_suppkey", tuple_count=100) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-bool nation_check) order by: {<0, ASC> }, cost est: 0, output card: 100

Total Plans : 576
Cost Optimized Plan : 
#12: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32 orders.o_year, #1 shared-float mkt_share) order by: {<0, ASC> }, cost est: 100, output card: 2
    #11: Project<Bit> ((<0, P$0(32) shared-int32>, <1, $2 / $1 shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float anonymous) order by: {}, cost est: 7618, output card: 2
        #10: NestedLoopAggregate<Bit> (group-by: (0) aggs: (SUM($1) null, SUM($2) null)) : (#0 shared-int32 orders.o_year, #1 shared-float null, #2 shared-float null) order by: {}, cost est: 7092000, output card: 2
            #9: Project<Bit> ((<0, P$1(32) shared-int32>, <1, P$3(32) shared-float>, <2, CASE($4, $3, SECRET FLOAT) shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float volume, #2 shared-float anonymous) order by: {<-1, ASC> }, cost est: 0, output card: 1500
                #8: KeyedSortMergeJoin<Bit> (P$0(16) == P$2(16) - sortCompatible) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32 orders.o_year, #2 shared-int32(16) lineitem.l_orderkey, #3 shared-float volume, #4 shared-bool nation_check) order by: {<-1, ASC> , <0, ASC> , <2, ASC> }, cost est: 35239789, output card: 1500
                    #3: Project<Bit> ((<0, P$1(16) shared-int32>, <1, P$3(32) shared-int32>)) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32 orders.o_year) order by: {<0, ASC> }, cost est: 0, output card: 1500
                        #2: KeyedJoin<Bit> (P$0(11) == P$2(11)) : (#0 shared-int32(11) customer.c_custkey, #1 shared-int32(16) orders.o_orderkey, #2 shared-int32(11) orders.o_custkey, #3 shared-int32 orders.o_year) order by: {<1, ASC> }, cost est: 11778000, output card: 1500
                            #0: SecureSqlInput<Bit> ("SELECT c_custkey FROM customer c JOIN nation n1 ON c_nationkey = n_nationkey JOIN region ON r_regionkey = n_regionkey WHERE r_name = 'AFRICA' ORDER BY c_custkey", tuple_count=302) : (#0 shared-int32(11) customer.c_custkey) order by: {}, cost est: 0, output card: 302
                            #1: SecureSqlInput<Bit> ("SELECT * FROM (SELECT o_orderkey, o_custkey, o_orderyear::INT AS o_year, NOT (o_orderdate >= date '1995-01-01' and o_orderdate < date '1996-12-31') dummy_tag FROM orders ORDER BY o_custkey) to_sort ORDER BY (1)  ASC ", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-int32 orders.o_year) order by: {<0, ASC> }, cost est: 625127, output card: 1500
                    #7: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$2(32) shared-float>, <2, P$4(1) shared-bool>)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-float volume, #2 shared-bool nation_check) order by: {<0, ASC> }, cost est: 0, output card: 1500
                        #6: KeyedJoin<Bit> (P$1(7) == P$3(7)) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float volume, #3 shared-int32(7) supplier.s_suppkey, #4 shared-bool nation_check) order by: {<0, ASC> }, cost est: 2850000, output card: 1500
                            #4: SecureSqlInput<Bit> ("SELECT * FROM (SELECT l_orderkey, l_suppkey, l_extendedprice * (1.0 - l_discount) AS volume,        CASE            WHEN p_type = 'LARGE ANODIZED STEEL' AND p_partkey = l_partkey THEN FALSE            ELSE TRUE            END AS dummy_tag FROM lineitem LEFT JOIN part ON p_partkey = l_partkey ORDER BY l_suppkey) to_sort ORDER BY (1)  ASC ", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float volume) order by: {<0, ASC> }, cost est: 593475, output card: 1500
                            #5: SecureSqlInput<Bit> ("SELECT s_suppkey, CASE WHEN n_name = 'KENYA' THEN true ELSE false END AS nation_check FROM supplier JOIN nation ON n_nationkey = s_nationkey ORDER BY s_suppkey", tuple_count=100) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-bool nation_check) order by: {}, cost est: 0, output card: 100

Cost Optimization Time : 0.141499 sec
Operator #0 SecureSqlInput ran for 1.023000 ms, gate count: 0 output cardinality: 302, row width=12
Operator #1 SecureSqlInput ran for 23.930000 ms, gate count: 0 output cardinality: 1500, row width=60
extension finished! takes 32.621ms to extend lpn
extension finished! takes 32.573ms to extend lpn
Operator #2 KeyedJoin ran for 1701.293000 ms, gate count: 12231000 output cardinality: 1500, row width=71
Operator #3 Project ran for 5.581000 ms, gate count: 0 output cardinality: 1500, row width=49
Operator #4 SecureSqlInput ran for 117.073000 ms, gate count: 0 output cardinality: 1500, row width=56
Operator #5 SecureSqlInput ran for 0.239000 ms, gate count: 0 output cardinality: 100, row width=9
extension finished! takes 32.634ms to extend lpn
Operator #6 KeyedJoin ran for 506.486000 ms, gate count: 3000000 output cardinality: 1500, row width=64
Operator #7 Project ran for 6.055000 ms, gate count: 0 output cardinality: 1500, row width=50
extension finished! takes 32.745ms to extend lpn
extension finished! takes 32.593ms to extend lpn
extension finished! takes 32.563ms to extend lpn
extension finished! takes 32.826ms to extend lpn
extension finished! takes 32.773ms to extend lpn
Operator #8 KeyedSortMergeJoin ran for 13446.172000 ms, gate count: 40532841 output cardinality: 1500, row width=98
Operator #9 Project ran for 20.046000 ms, gate count: 48000 output cardinality: 1500, row width=97
extension finished! takes 32.573ms to extend lpn
Operator #10 NestedLoopAggregate ran for 3435.170000 ms, gate count: 6528000 output cardinality: 2, row width=97
Operator #11 Project ran for 1.206000 ms, gate count: 7618 output cardinality: 2, row width=65
Operator #12 Sort ran for 0.045000 ms, gate count: 131 output cardinality: 2, row width=65
Runtime: 19.5386 sec, CPU Time: 9.34127 sec, CPU clock ticks: 9.34127e+06, CPU clock ticks per second: 1000000
End-to-end estimated gates: 5.69675e+07. observed gates: 47116590 gates, relative error (%)=20.9075
[Linux]Peak resident set size: 818745344 bytes, current memory size: 188841984 bytes.
Initial Memory: 818745344 bytes, Peak Memory After Execution: 818745344 bytes, Memory Usage: 0 bytes
Bandwidth: 908982 Bps
TP send 27806044 bytes to party 1
TP send 21853267 bytes to party 2
TP send 21853267 bytes to party 3
total AND gate: 47116590
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.cost_optimized_tpch_q8 (39642 ms)
[ RUN      ] GeneralizedComparisonTest.cost_optimized_tpch_q9
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 322.157ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 818745344 bytes, current memory size: 197361664 bytes.
818745344
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 818745344 bytes, current memory size: 197492736 bytes.
Original Tree : 
#11: Sort<Bit> ({<0, ASC> , <1, DESC> }) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float sum_profit) order by: {<0, ASC> , <1, DESC> }, cost est: 1385772, output card: 175
    #10: SortMergeAggregate<Bit> (group-by: (0, 1) aggs: (SUM($2) sum_profit)) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float sum_profit) order by: {<0, ASC> , <1, ASC> }, cost est: 2325000, output card: 175
        #-1: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float amount) order by: {<0, ASC> , <1, ASC> }, cost est: 22987542, output card: 1500
            #9: Project<Bit> ((<0, P$0(200) shared-varchar>, <1, P$8(32) shared-int32>, <2, $7 - ($3 * $6) shared-float>)) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float amount) order by: {<-1, ASC> }, cost est: 6835500, output card: 1500
                #8: KeyedSortMergeJoin<Bit> ((P$2(7) == P$5(7)) AND (P$1(11) == P$4(11)) - not sort compatible, need sort in smj) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(11) partsupp.ps_partkey, #2 shared-int32(7) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost, #4 shared-int32(11) lineitem.l_partkey, #5 shared-int32(7) lineitem.l_suppkey, #6 shared-float l_quantity, #7 shared-float volume, #8 shared-int32 o_year) order by: {<-1, ASC> , <2, ASC> , <5, ASC> , <1, ASC> , <4, ASC> }, cost est: 57618276, output card: 1500
                    #-1: Sort<Bit> ({<-1, ASC> , <2, ASC> , <2, ASC> , <1, ASC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(11) partsupp.ps_partkey, #2 shared-int32(7) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost) order by: {<-1, ASC> , <2, ASC> , <2, ASC> , <1, ASC> }, cost est: 2795846, output card: 448
                        #3: Project<Bit> ((<0, P$1(200) shared-varchar>, <1, P$2(11) shared-int32>, <2, P$3(7) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(11) partsupp.ps_partkey, #2 shared-int32(7) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost) order by: {<-1, ASC> , <2, ASC> }, cost est: 0, output card: 448
                            #2: KeyedSortMergeJoin<Bit> (P$0(7) == P$3(7) - sortCompatible) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(11) partsupp.ps_partkey, #3 shared-int32(7) partsupp.ps_suppkey, #4 shared-float partsupp.ps_supplycost) order by: {<-1, ASC> , <0, ASC> , <3, ASC> }, cost est: 7224173, output card: 448
                                #0: SecureSqlInput<Bit> ("SELECT s_suppkey, n_name FROM supplier JOIN nation ON s_nationkey = n_nationkey ORDER BY s_suppkey", tuple_count=100) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name) order by: {<0, ASC> }, cost est: 0, output card: 100
                                #1: SecureSqlInput<Bit> ("SELECT ps_partkey, ps_suppkey, ps_supplycost FROM partsupp JOIN part ON ps_partkey = p_partkey WHERE p_name LIKE '%yellow%' ORDER BY ps_suppkey, ps_partkey", tuple_count=448) : (#0 shared-int32(11) partsupp.ps_partkey, #1 shared-int32(7) partsupp.ps_suppkey, #2 shared-float partsupp.ps_supplycost) order by: {<1, ASC> , <0, ASC> }, cost est: 0, output card: 448
                    #-1: Sort<Bit> ({<-1, ASC> }) : (#0 shared-int32(11) lineitem.l_partkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float l_quantity, #3 shared-float volume, #4 shared-int32 o_year) order by: {<-1, ASC> }, cost est: 5438404, output card: 1500
                        #7: Project<Bit> ((<0, P$1(11) shared-int32>, <1, P$2(7) shared-int32>, <2, P$3(32) shared-float>, <3, P$4(32) shared-float>, <4, P$5(32) shared-int32>)) : (#0 shared-int32(11) lineitem.l_partkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float l_quantity, #3 shared-float volume, #4 shared-int32 o_year) order by: {<-1, ASC> }, cost est: 0, output card: 1500
                            #6: KeyedSortMergeJoin<Bit> (P$0(16) == P$6(16) - sortCompatible) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(11) lineitem.l_partkey, #2 shared-int32(7) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float volume, #5 shared-int32 o_year, #6 shared-int32(16) orders.o_orderkey) order by: {<-1, ASC> , <0, ASC> , <6, ASC> }, cost est: 47512121, output card: 1500
                                #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_partkey, l_suppkey, l_quantity::float4, l_extendedprice * (1.0 - l_discount) AS volume FROM lineitem ORDER BY l_orderkey, l_suppkey, l_partkey", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(11) lineitem.l_partkey, #2 shared-int32(7) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float volume) order by: {<0, ASC> , <2, ASC> , <1, ASC> }, cost est: 0, output card: 1500
                                #5: SecureSqlInput<Bit> ("SELECT EXTRACT('year' FROM o_orderdate)::INT AS o_year, o_orderkey FROM orders ORDER BY o_orderkey", tuple_count=1500) : (#0 shared-int32 o_year, #1 shared-int32(16) orders.o_orderkey) order by: {<1, ASC> }, cost est: 0, output card: 1500

Total Plans : 128
Cost Optimized Plan : 
#11: Sort<Bit> ({<0, ASC> , <1, DESC> }) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float sum_profit) order by: {<0, ASC> , <1, DESC> }, cost est: 1385772, output card: 175
    #10: SortMergeAggregate<Bit> (group-by: (0, 1) aggs: (SUM($2) sum_profit)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32 o_year, #2 shared-float sum_profit) order by: {<0, ASC> , <1, ASC> }, cost est: 2325000, output card: 175
        #-1: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32 o_year, #2 shared-float anonymous) order by: {<0, ASC> , <1, ASC> }, cost est: 22987542, output card: 1500
            #9: Project<Bit> ((<0, P$0(200) shared-varchar>, <1, P$8(32) shared-int32>, <2, $7 - ($3 * $6) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32 o_year, #2 shared-float anonymous) order by: {<-1, ASC> }, cost est: 6835500, output card: 1500
                #8: KeyedSortMergeJoin<Bit> ((P$2(7) == P$5(7)) AND (P$1(11) == P$4(11)) - sortCompatible) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(11) partsupp.ps_partkey, #2 shared-int32(7) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost, #4 shared-int32(11) lineitem.l_partkey, #5 shared-int32(7) lineitem.l_suppkey, #6 shared-float l_quantity, #7 shared-float volume, #8 shared-int32 o_year) order by: {<-1, ASC> , <2, ASC> , <5, ASC> , <1, ASC> , <4, ASC> }, cost est: 42243602, output card: 1500
                    #3: Project<Bit> ((<0, P$1(200) shared-varchar>, <1, P$2(11) shared-int32>, <2, P$3(7) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(11) partsupp.ps_partkey, #2 shared-int32(7) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost) order by: {<2, ASC> , <1, ASC> }, cost est: 0, output card: 448
                        #2: KeyedJoin<Bit> (P$0(7) == P$3(7)) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(11) partsupp.ps_partkey, #3 shared-int32(7) partsupp.ps_suppkey, #4 shared-float partsupp.ps_supplycost) order by: {<3, ASC> , <2, ASC> }, cost est: 9766400, output card: 448
                            #0: SecureSqlInput<Bit> ("SELECT s_suppkey, n_name FROM supplier JOIN nation ON s_nationkey = n_nationkey ORDER BY s_suppkey", tuple_count=100) : (#0 shared-int32(7) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name) order by: {}, cost est: 0, output card: 100
                            #1: SecureSqlInput<Bit> ("SELECT ps_partkey, ps_suppkey, ps_supplycost FROM partsupp JOIN part ON ps_partkey = p_partkey WHERE p_name LIKE '%yellow%' ORDER BY ps_suppkey, ps_partkey", tuple_count=448) : (#0 shared-int32(11) partsupp.ps_partkey, #1 shared-int32(7) partsupp.ps_suppkey, #2 shared-float partsupp.ps_supplycost) order by: {<1, ASC> , <0, ASC> }, cost est: 0, output card: 448
                    #-1: Sort<Bit> ({<1, ASC> , <0, ASC> }) : (#0 shared-int32(11) lineitem.l_partkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float l_quantity, #3 shared-float volume, #4 shared-int32 o_year) order by: {<1, ASC> , <0, ASC> }, cost est: 6352422, output card: 1500
                        #-1: Sort<Bit> ({}) : (#0 shared-int32(11) lineitem.l_partkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float l_quantity, #3 shared-float volume, #4 shared-int32 o_year) order by: {}, cost est: 5255601, output card: 1500
                            #7: Project<Bit> ((<0, P$1(11) shared-int32>, <1, P$2(7) shared-int32>, <2, P$3(32) shared-float>, <3, P$4(32) shared-float>, <4, P$5(32) shared-int32>)) : (#0 shared-int32(11) lineitem.l_partkey, #1 shared-int32(7) lineitem.l_suppkey, #2 shared-float l_quantity, #3 shared-float volume, #4 shared-int32 o_year) order by: {<-1, ASC> }, cost est: 0, output card: 1500
                                #6: KeyedSortMergeJoin<Bit> (P$0(16) == P$6(16) - sortCompatible) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(11) lineitem.l_partkey, #2 shared-int32(7) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float volume, #5 shared-int32 o_year, #6 shared-int32(16) orders.o_orderkey) order by: {<-1, ASC> , <0, ASC> , <6, ASC> }, cost est: 47512121, output card: 1500
                                    #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_partkey, l_suppkey, l_quantity::float4, l_extendedprice * (1.0 - l_discount) AS volume FROM lineitem ORDER BY l_orderkey, l_suppkey, l_partkey", tuple_count=1500) : (#0 shared-int32(16) lineitem.l_orderkey, #1 shared-int32(11) lineitem.l_partkey, #2 shared-int32(7) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float volume) order by: {<0, ASC> , <2, ASC> , <1, ASC> }, cost est: 0, output card: 1500
                                    #5: SecureSqlInput<Bit> ("SELECT EXTRACT('year' FROM o_orderdate)::INT AS o_year, o_orderkey FROM orders ORDER BY o_orderkey", tuple_count=1500) : (#0 shared-int32 o_year, #1 shared-int32(16) orders.o_orderkey) order by: {<1, ASC> }, cost est: 0, output card: 1500

Cost Optimization Time : 0.030951 sec
Operator #0 SecureSqlInput ran for 3.937000 ms, gate count: 0 output cardinality: 100, row width=208
Operator #1 SecureSqlInput ran for 3.580000 ms, gate count: 0 output cardinality: 448, row width=51
extension finished! takes 32.615ms to extend lpn
Operator #2 KeyedJoin ran for 1037.434000 ms, gate count: 9811200 output cardinality: 448, row width=258
Operator #3 Project ran for 8.907000 ms, gate count: 0 output cardinality: 448, row width=251
Operator #4 SecureSqlInput ran for 92.424000 ms, gate count: 0 output cardinality: 1500, row width=99
Operator #5 SecureSqlInput ran for 73.443000 ms, gate count: 0 output cardinality: 1500, row width=49
extension finished! takes 32.103ms to extend lpn
extension finished! takes 32.732ms to extend lpn
extension finished! takes 32.528ms to extend lpn
extension finished! takes 32.62ms to extend lpn
extension finished! takes 32.462ms to extend lpn
extension finished! takes 32.717ms to extend lpn
extension finished! takes 32.403ms to extend lpn
extension finished! takes 32.376ms to extend lpn
Operator #6 KeyedSortMergeJoin ran for 15053.333000 ms, gate count: 46864515 output cardinality: 1500, row width=147
Operator #7 Project ran for 11.054000 ms, gate count: 0 output cardinality: 1500, row width=115
extension finished! takes 32.514ms to extend lpn
Operator #-1 Sort ran for 4906.779000 ms, gate count: 5010090 output cardinality: 1500, row width=115
extension finished! takes 32.642ms to extend lpn
Operator #-1 Sort ran for 7475.655000 ms, gate count: 6926994 output cardinality: 1500, row width=115
extension finished! takes 32.459ms to extend lpn
extension finished! takes 32.488ms to extend lpn
extension finished! takes 32.405ms to extend lpn
extension finished! takes 32.399ms to extend lpn
extension finished! takes 32.419ms to extend lpn
extension finished! takes 32.423ms to extend lpn
extension finished! takes 32.432ms to extend lpn
extension finished! takes 32.506ms to extend lpn
extension finished! takes 32.934ms to extend lpn
extension finished! takes 32.873ms to extend lpn
Operator #8 KeyedSortMergeJoin ran for 36263.286000 ms, gate count: 107236868 output cardinality: 1500, row width=365
extension finished! takes 32.576ms to extend lpn
Operator #9 Project ran for 3056.145000 ms, gate count: 6835500 output cardinality: 1500, row width=265
extension finished! takes 32.507ms to extend lpn
extension finished! takes 32.593ms to extend lpn
extension finished! takes 32.674ms to extend lpn
extension finished! takes 32.553ms to extend lpn
extension finished! takes 32.568ms to extend lpn
extension finished! takes 32.564ms to extend lpn
extension finished! takes 32.729ms to extend lpn
Operator #-1 Sort ran for 28817.963000 ms, gate count: 31933878 output cardinality: 1500, row width=265
Operator #10 SortMergeAggregate ran for 426.421000 ms, gate count: 2278512 output cardinality: 1500, row width=265
extension finished! takes 32.492ms to extend lpn
extension finished! takes 32.577ms to extend lpn
extension finished! takes 32.516ms to extend lpn
extension finished! takes 32.574ms to extend lpn
extension finished! takes 32.724ms to extend lpn
extension finished! takes 32.369ms to extend lpn
Operator #11 Sort ran for 26682.751000 ms, gate count: 31933878 output cardinality: 1500, row width=265
Runtime: 124.024 sec, CPU Time: 35.5108 sec, CPU clock ticks: 3.55108e+07, CPU clock ticks per second: 1000000
End-to-end estimated gates: 1.44664e+08. observed gates: 180218636 gates, relative error (%)=19.7286
[Linux]Peak resident set size: 818745344 bytes, current memory size: 311439360 bytes.
Initial Memory: 818745344 bytes, Peak Memory After Execution: 818745344 bytes, Memory Usage: 0 bytes
Bandwidth: 548132 Bps
TP send 58382748 bytes to party 1
TP send 48968979 bytes to party 2
TP send 48968979 bytes to party 3
total AND gate: 180218636
total pack call: 0
total unpack call: 0
total packed wire: 0
total unpacked wire: 0
[       OK ] GeneralizedComparisonTest.cost_optimized_tpch_q9 (141554 ms)
[ RUN      ] GeneralizedComparisonTest.cost_optimized_tpch_q18
Connecting to 127.0.0.1 on ports 7654, 65482 as 10086
TP connected to 1
TP connected to 2
TP connected to 3
TP connected to 1
TP connected to 2
TP connected to 3
initializing cot
setup finished! takes 463.739ms to finish setup
Memory usage of backend setup: [Linux]Peak resident set size: 818745344 bytes, current memory size: 311439360 bytes.
818745344
EMP mode: outsourced, storage mode: column store
Code version: 5520450e48d58739c9c30b64a3a3a0430a5aede3
GFlags: --flagfile=	--alice_db=tpch_alice_1500	--alice_host=127.0.0.1	--bob_db=tpch_bob_1500	--ctrl_port=65482	--cutoff=100	--filter=*	--party=10086	--port=7654	--storage=column	--unioned_db=tpch_unioned_1500	--validation=false	--log_level=2	--logfile=	

[Linux]Peak resident set size: 818745344 bytes, current memory size: 311439360 bytes.
Original Tree : 
#11: Sort<Bit> ({<-1, ASC> , <4, DESC> , <3, ASC> }) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(11) customer.c_custkey, #2 shared-int32(16) order_keys.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> , <4, DESC> , <3, ASC> }, cost est: 495150, output card: 100
    #10: Project<Bit> ((<0, P$6(200) shared-varchar>, <1, P$5(11) shared-int32>, <2, P$0(16) shared-int32>, <3, P$3(28) shared-int64>, <4, P$2(32) shared-float>, <5, P$4(32) shared-float>)) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(11) customer.c_custkey, #2 shared-int32(16) order_keys.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> , <1, ASC> }, cost est: 0, output card: 1500
        #9: KeyedSortMergeJoin<Bit> (P$1(11) == P$5(11) - sortCompatible) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty, #5 shared-int32(11) customer.c_custkey, #6 shared-varchar(25) customer.c_name) order by: {<-1, ASC> , <1, ASC> , <5, ASC> }, cost est: 75183353, output card: 1500
            #-1: Sort<Bit> ({<1, ASC> }) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty) order by: {<1, ASC> }, cost est: 6123918, output card: 1500
                #7: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$3(11) shared-int32>, <2, P$4(32) shared-float>, <3, P$5(28) shared-int64>, <4, P$1(32) shared-float>)) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 1500
                    #6: MergeJoin<Bit> (no-op) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty, #2 shared-int32(16) orders.o_orderkey, #3 shared-int32(11) orders.o_custkey, #4 shared-float orders.o_totalprice, #5 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 4500, output card: 1500
                        #4: Filter<Bit> (P$1(32) > SECRET FLOAT) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 319500, output card: 1500
                            #3: Project<Bit> ((<0, P$0(16) shared-int32>, <1, $1 + $3 shared-float>)) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 1479000, output card: 1500
                                #2: MergeJoin<Bit> (no-op) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty, #2 shared-int32(16) order_keys.o_orderkey, #3 shared-float sum_qty) order by: {<0, ASC> }, cost est: 4500, output card: 1500
                                    #0: SecureSqlInput<Bit> ("WITH all_keys AS (SELECT o_orderkey  FROM order_keys), sum_qtys AS (SELECT l_orderkey, sum(l_quantity) as sum_qty, false AS dummy_tag FROM lineitem GROUP BY l_orderkey ORDER BY l_orderkey) SELECT o_orderkey, COALESCE(sum_qty, 0.0) sum_qty, COALESCE(dummy_tag, true) dummy_tag FROM all_keys LEFT JOIN sum_qtys ON l_orderkey = o_orderkey ORDER BY o_orderkey ", tuple_count=1500) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 1500
                                    #1: SecureSqlInput<Bit> ("WITH all_keys AS (SELECT o_orderkey  FROM order_keys), sum_qtys AS (SELECT l_orderkey, sum(l_quantity) as sum_qty, false AS dummy_tag FROM lineitem GROUP BY l_orderkey ORDER BY l_orderkey) SELECT o_orderkey, COALESCE(sum_qty, 0.0) sum_qty, COALESCE(dummy_tag, true) dummy_tag FROM all_keys LEFT JOIN sum_qtys ON l_orderkey = o_orderkey ORDER BY o_orderkey ", tuple_count=0) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 0
                        #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, false dummy_tag FROM orders ORDER BY o_orderkey", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 0, output card: 1500
            #8: SecureSqlInput<Bit> ("SELECT c_custkey, c_name FROM customer ORDER BY c_custkey", tuple_count=1500) : (#0 shared-int32(11) customer.c_custkey, #1 shared-varchar(25) customer.c_name) order by: {<0, ASC> }, cost est: 0, output card: 1500

Total Plans : 4
Cost Optimized Plan : 
#11: Sort<Bit> ({<-1, ASC> , <4, DESC> , <3, ASC> }) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(11) customer.c_custkey, #2 shared-int32(16) order_keys.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> , <4, DESC> , <3, ASC> }, cost est: 495150, output card: 100
    #10: Project<Bit> ((<0, P$6(200) shared-varchar>, <1, P$5(11) shared-int32>, <2, P$0(16) shared-int32>, <3, P$3(28) shared-int64>, <4, P$2(32) shared-float>, <5, P$4(32) shared-float>)) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(11) customer.c_custkey, #2 shared-int32(16) order_keys.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> , <1, ASC> }, cost est: 0, output card: 1500
        #9: KeyedSortMergeJoin<Bit> (P$1(11) == P$5(11) - sortCompatible) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty, #5 shared-int32(11) customer.c_custkey, #6 shared-varchar(25) customer.c_name) order by: {<-1, ASC> , <1, ASC> , <5, ASC> }, cost est: 75183353, output card: 1500
            #-1: Sort<Bit> ({<1, ASC> }) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty) order by: {<1, ASC> }, cost est: 6123918, output card: 1500
                #7: Project<Bit> ((<0, P$0(16) shared-int32>, <1, P$3(11) shared-int32>, <2, P$4(32) shared-float>, <3, P$5(28) shared-int64>, <4, P$1(32) shared-float>)) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 1500
                    #6: MergeJoin<Bit> (no-op) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty, #2 shared-int32(16) orders.o_orderkey, #3 shared-int32(11) orders.o_custkey, #4 shared-float orders.o_totalprice, #5 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 4500, output card: 1500
                        #4: Filter<Bit> (P$1(32) > SECRET FLOAT) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 319500, output card: 1500
                            #3: Project<Bit> ((<0, P$0(16) shared-int32>, <1, $1 + $3 shared-float>)) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float anonymous) order by: {<0, ASC> }, cost est: 1479000, output card: 1500
                                #2: MergeJoin<Bit> (no-op) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty, #2 shared-int32(16) order_keys.o_orderkey, #3 shared-float sum_qty) order by: {<0, ASC> }, cost est: 4500, output card: 1500
                                    #0: SecureSqlInput<Bit> ("WITH all_keys AS (SELECT o_orderkey  FROM order_keys), sum_qtys AS (SELECT l_orderkey, sum(l_quantity) as sum_qty, false AS dummy_tag FROM lineitem GROUP BY l_orderkey ORDER BY l_orderkey) SELECT o_orderkey, COALESCE(sum_qty, 0.0) sum_qty, COALESCE(dummy_tag, true) dummy_tag FROM all_keys LEFT JOIN sum_qtys ON l_orderkey = o_orderkey ORDER BY o_orderkey ", tuple_count=1500) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 1500
                                    #1: SecureSqlInput<Bit> ("WITH all_keys AS (SELECT o_orderkey  FROM order_keys), sum_qtys AS (SELECT l_orderkey, sum(l_quantity) as sum_qty, false AS dummy_tag FROM lineitem GROUP BY l_orderkey ORDER BY l_orderkey) SELECT o_orderkey, COALESCE(sum_qty, 0.0) sum_qty, COALESCE(dummy_tag, true) dummy_tag FROM all_keys LEFT JOIN sum_qtys ON l_orderkey = o_orderkey ORDER BY o_orderkey ", tuple_count=0) : (#0 shared-int32(16) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 0
                        #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, false dummy_tag FROM orders ORDER BY o_orderkey", tuple_count=1500) : (#0 shared-int32(16) orders.o_orderkey, #1 shared-int32(11) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 0, output card: 1500
            #8: SecureSqlInput<Bit> ("SELECT c_custkey, c_name FROM customer ORDER BY c_custkey", tuple_count=1500) : (#0 shared-int32(11) customer.c_custkey, #1 shared-varchar(25) customer.c_name) order by: {<0, ASC> }, cost est: 0, output card: 1500

Cost Optimization Time : 0.001422 sec
Operator #0 SecureSqlInput ran for 11.094000 ms, gate count: 0 output cardinality: 1500, row width=49
Operator #1 SecureSqlInput ran for 0.040000 ms, gate count: 0 output cardinality: 0, row width=49
Operator #2 MergeJoin ran for 9.702000 ms, gate count: 0 output cardinality: 1500, row width=97
Operator #3 Project ran for 168.857000 ms, gate count: 1479000 output cardinality: 1500, row width=49
Operator #4 Filter ran for 40.344000 ms, gate count: 321000 output cardinality: 1500, row width=49
Operator #5 SecureSqlInput ran for 199.039000 ms, gate count: 0 output cardinality: 1500, row width=88
Operator #6 MergeJoin ran for 31.440000 ms, gate count: 3000 output cardinality: 1500, row width=136
Operator #7 Project ran for 11.835000 ms, gate count: 0 output cardinality: 1500, row width=120
extension finished! takes 32.563ms to extend lpn
Operator #-1 Sort ran for 1498.675000 ms, gate count: 6360636 output cardinality: 1500, row width=120

