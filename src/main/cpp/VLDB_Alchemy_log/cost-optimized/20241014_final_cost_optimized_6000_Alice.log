[==========] Running 6 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 6 tests from CostOptimizedTest
[ RUN      ] CostOptimizedTest.cost_optimized_tpch_q1
Connecting to 127.0.0.1 on ports 7654, 65482 as 1
connected
EMP mode: sh2pc, storage mode: column store
Code version: aaab8b1c36f961a50172caf92085acacb0670290
GFlags: --flagfile=	--alice_db=tpch_alice_6000	--alice_host=127.0.0.1	--bob_db=tpch_bob_6000	--ctrl_port=65483	--cutoff=100	--filter=*	--party=1	--port=7655	--storage=column	--unioned_db=tpch_unioned_6000	--validation=true	--log_level=2	--logfile=	

[Linux]Peak resident set size: 16646144 bytes, current memory size: 16646144 bytes.
Original Tree : 
#4: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty, #7 shared-float avg_price, #8 shared-float avg_disc, #9 shared-int64 count_order) order by: {<0, ASC> , <1, ASC> }, cost est: 4545, output card: 6
    #3: Project<Bit> ((<0, P$0(8) shared-varchar>, <1, P$1(8) shared-varchar>, <2, $2 + $15 shared-float>, <3, $3 + $16 shared-float>, <4, $4 + $17 shared-float>, <5, $5 + $18 shared-float>, <6, ($6 + $19) / ($7 + $20) shared-float>, <7, ($8 + $21) / ($9 + $22) shared-float>, <8, ($10 + $23) / ($11 + $24) shared-float>, <9, $12 + $25 shared-int64>)) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty, #7 shared-float avg_price, #8 shared-float avg_disc, #9 shared-int64 count_order) order by: {<0, ASC> , <1, ASC> }, cost est: 163596, output card: 6
        #2: MergeJoin<Bit> (no-op) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt, #13 shared-varchar(1) l_returnflag, #14 shared-varchar(1) l_linestatus, #15 shared-float sum_qty, #16 shared-float sum_base_price, #17 shared-float sum_disc_price, #18 shared-float sum_charge, #19 shared-float avg_qty_sum, #20 shared-float avg_qty_cnt, #21 shared-float avg_price_sum, #22 shared-float avg_price_cnt, #23 shared-float avg_discount_sum, #24 shared-float avg_discount_cnt, #25 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 18, output card: 6
            #0: SecureSqlInput<Bit> ("WITH output_domain AS (
    SELECT  *
    FROM (VALUES('R'::char(1), 'F'::char(1)), ('A', 'F'), ('N', 'F'), ('R', 'O'), ('A', 'O'), ('N', 'O')) AS li(l_returnflag, l_linestatus)
    ORDER BY l_returnflag, l_linestatus),
     partial_aggs AS (
         SELECT l_returnflag, l_linestatus, SUM(l_quantity) sum_qty, SUM(l_extendedprice) sum_base_price,
                SUM(l_extendedprice*(1-l_discount)) sum_disc_price, SUM(l_extendedprice*(1-l_discount)*(1+l_tax)) sum_charge,
                SUM(l_quantity) avg_qty_sum, COUNT(l_quantity)::FLOAT4 avg_qty_cnt,
                 SUM(l_extendedprice) avg_price_sum, COUNT(l_extendedprice)::FLOAT4 avg_price_cnt,
                 SUM(l_discount) avg_discount_sum, COUNT(l_discount)::FLOAT4 avg_discount_cnt, COUNT(*) cnt
         FROM lineitem
         WHERE l_shipdate  <= date '1998-08-03'
         GROUP BY l_returnflag, l_linestatus
         ORDER BY l_returnflag, l_linestatus)
SELECT o.l_returnflag, o.l_linestatus, COALESCE(sum_qty, 0) sum_qty, COALESCE(sum_base_price, 0) sum_base_price, COALESCE(sum_disc_price, 0) sum_disc_price, COALESCE(sum_charge, 0) sum_charge, COALESCE(avg_qty_sum, 0) avg_qty_sum, COALESCE(avg_qty_cnt, 0) avg_qty_cnt,  COALESCE(avg_price_sum, 0) avg_price_sum, COALESCE(avg_price_cnt, 0) avg_price_cnt,  COALESCE(avg_discount_sum, 0) avg_discount_sum, COALESCE(avg_discount_cnt, 0) avg_discount_cnt,  COALESCE(cnt, 0)::BIGINT cnt, CASE WHEN p.l_returnflag IS NULL THEN true ELSE false END AS dummy_tag
FROM output_domain o LEFT JOIN partial_aggs p ON o.l_returnflag = p.l_returnflag AND o.l_linestatus = p.l_linestatus
ORDER BY o.l_returnflag, o.l_linestatus", tuple_count=6) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 0, output card: 6
            #1: SecureSqlInput<Bit> ("WITH output_domain AS (
    SELECT  *
    FROM (VALUES('R'::char(1), 'F'::char(1)), ('A', 'F'), ('N', 'F'), ('R', 'O'), ('A', 'O'), ('N', 'O')) AS li(l_returnflag, l_linestatus)
    ORDER BY l_returnflag, l_linestatus),
     partial_aggs AS (
         SELECT l_returnflag, l_linestatus, SUM(l_quantity) sum_qty, SUM(l_extendedprice) sum_base_price,
                SUM(l_extendedprice*(1-l_discount)) sum_disc_price, SUM(l_extendedprice*(1-l_discount)*(1+l_tax)) sum_charge,
                SUM(l_quantity) avg_qty_sum, COUNT(l_quantity)::FLOAT4 avg_qty_cnt,
                 SUM(l_extendedprice) avg_price_sum, COUNT(l_extendedprice)::FLOAT4 avg_price_cnt,
                 SUM(l_discount) avg_discount_sum, COUNT(l_discount)::FLOAT4 avg_discount_cnt, COUNT(*) cnt
         FROM lineitem
         WHERE l_shipdate  <= date '1998-08-03'
         GROUP BY l_returnflag, l_linestatus
         ORDER BY l_returnflag, l_linestatus)
SELECT o.l_returnflag, o.l_linestatus, COALESCE(sum_qty, 0) sum_qty, COALESCE(sum_base_price, 0) sum_base_price, COALESCE(sum_disc_price, 0) sum_disc_price, COALESCE(sum_charge, 0) sum_charge, COALESCE(avg_qty_sum, 0) avg_qty_sum, COALESCE(avg_qty_cnt, 0) avg_qty_cnt,  COALESCE(avg_price_sum, 0) avg_price_sum, COALESCE(avg_price_cnt, 0) avg_price_cnt,  COALESCE(avg_discount_sum, 0) avg_discount_sum, COALESCE(avg_discount_cnt, 0) avg_discount_cnt,  COALESCE(cnt, 0)::BIGINT cnt, CASE WHEN p.l_returnflag IS NULL THEN true ELSE false END AS dummy_tag
FROM output_domain o LEFT JOIN partial_aggs p ON o.l_returnflag = p.l_returnflag AND o.l_linestatus = p.l_linestatus
ORDER BY o.l_returnflag, o.l_linestatus", tuple_count=6) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 0, output card: 6

Total Plans : 1
Cost Optimized Plan : 
#3: Project<Bit> ((<0, P$0(8) shared-varchar>, <1, P$1(8) shared-varchar>, <2, $2 + $15 shared-float>, <3, $3 + $16 shared-float>, <4, $4 + $17 shared-float>, <5, $5 + $18 shared-float>, <6, ($6 + $19) / ($7 + $20) shared-float>, <7, ($8 + $21) / ($9 + $22) shared-float>, <8, ($10 + $23) / ($11 + $24) shared-float>, <9, $12 + $25 shared-int64>)) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float anonymous, #3 shared-float anonymous, #4 shared-float anonymous, #5 shared-float anonymous, #6 shared-float anonymous, #7 shared-float anonymous, #8 shared-float anonymous, #9 shared-int64 anonymous) order by: {<0, ASC> , <1, ASC> }, cost est: 163596, output card: 6
    #2: MergeJoin<Bit> (no-op) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt, #13 shared-varchar(1) l_returnflag, #14 shared-varchar(1) l_linestatus, #15 shared-float sum_qty, #16 shared-float sum_base_price, #17 shared-float sum_disc_price, #18 shared-float sum_charge, #19 shared-float avg_qty_sum, #20 shared-float avg_qty_cnt, #21 shared-float avg_price_sum, #22 shared-float avg_price_cnt, #23 shared-float avg_discount_sum, #24 shared-float avg_discount_cnt, #25 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 18, output card: 6
        #0: SecureSqlInput<Bit> ("WITH output_domain AS (
    SELECT  *
    FROM (VALUES('R'::char(1), 'F'::char(1)), ('A', 'F'), ('N', 'F'), ('R', 'O'), ('A', 'O'), ('N', 'O')) AS li(l_returnflag, l_linestatus)
    ORDER BY l_returnflag, l_linestatus),
     partial_aggs AS (
         SELECT l_returnflag, l_linestatus, SUM(l_quantity) sum_qty, SUM(l_extendedprice) sum_base_price,
                SUM(l_extendedprice*(1-l_discount)) sum_disc_price, SUM(l_extendedprice*(1-l_discount)*(1+l_tax)) sum_charge,
                SUM(l_quantity) avg_qty_sum, COUNT(l_quantity)::FLOAT4 avg_qty_cnt,
                 SUM(l_extendedprice) avg_price_sum, COUNT(l_extendedprice)::FLOAT4 avg_price_cnt,
                 SUM(l_discount) avg_discount_sum, COUNT(l_discount)::FLOAT4 avg_discount_cnt, COUNT(*) cnt
         FROM lineitem
         WHERE l_shipdate  <= date '1998-08-03'
         GROUP BY l_returnflag, l_linestatus
         ORDER BY l_returnflag, l_linestatus)
SELECT o.l_returnflag, o.l_linestatus, COALESCE(sum_qty, 0) sum_qty, COALESCE(sum_base_price, 0) sum_base_price, COALESCE(sum_disc_price, 0) sum_disc_price, COALESCE(sum_charge, 0) sum_charge, COALESCE(avg_qty_sum, 0) avg_qty_sum, COALESCE(avg_qty_cnt, 0) avg_qty_cnt,  COALESCE(avg_price_sum, 0) avg_price_sum, COALESCE(avg_price_cnt, 0) avg_price_cnt,  COALESCE(avg_discount_sum, 0) avg_discount_sum, COALESCE(avg_discount_cnt, 0) avg_discount_cnt,  COALESCE(cnt, 0)::BIGINT cnt, CASE WHEN p.l_returnflag IS NULL THEN true ELSE false END AS dummy_tag
FROM output_domain o LEFT JOIN partial_aggs p ON o.l_returnflag = p.l_returnflag AND o.l_linestatus = p.l_linestatus
ORDER BY o.l_returnflag, o.l_linestatus", tuple_count=6) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 0, output card: 6
        #1: SecureSqlInput<Bit> ("WITH output_domain AS (
    SELECT  *
    FROM (VALUES('R'::char(1), 'F'::char(1)), ('A', 'F'), ('N', 'F'), ('R', 'O'), ('A', 'O'), ('N', 'O')) AS li(l_returnflag, l_linestatus)
    ORDER BY l_returnflag, l_linestatus),
     partial_aggs AS (
         SELECT l_returnflag, l_linestatus, SUM(l_quantity) sum_qty, SUM(l_extendedprice) sum_base_price,
                SUM(l_extendedprice*(1-l_discount)) sum_disc_price, SUM(l_extendedprice*(1-l_discount)*(1+l_tax)) sum_charge,
                SUM(l_quantity) avg_qty_sum, COUNT(l_quantity)::FLOAT4 avg_qty_cnt,
                 SUM(l_extendedprice) avg_price_sum, COUNT(l_extendedprice)::FLOAT4 avg_price_cnt,
                 SUM(l_discount) avg_discount_sum, COUNT(l_discount)::FLOAT4 avg_discount_cnt, COUNT(*) cnt
         FROM lineitem
         WHERE l_shipdate  <= date '1998-08-03'
         GROUP BY l_returnflag, l_linestatus
         ORDER BY l_returnflag, l_linestatus)
SELECT o.l_returnflag, o.l_linestatus, COALESCE(sum_qty, 0) sum_qty, COALESCE(sum_base_price, 0) sum_base_price, COALESCE(sum_disc_price, 0) sum_disc_price, COALESCE(sum_charge, 0) sum_charge, COALESCE(avg_qty_sum, 0) avg_qty_sum, COALESCE(avg_qty_cnt, 0) avg_qty_cnt,  COALESCE(avg_price_sum, 0) avg_price_sum, COALESCE(avg_price_cnt, 0) avg_price_cnt,  COALESCE(avg_discount_sum, 0) avg_discount_sum, COALESCE(avg_discount_cnt, 0) avg_discount_cnt,  COALESCE(cnt, 0)::BIGINT cnt, CASE WHEN p.l_returnflag IS NULL THEN true ELSE false END AS dummy_tag
FROM output_domain o LEFT JOIN partial_aggs p ON o.l_returnflag = p.l_returnflag AND o.l_linestatus = p.l_linestatus
ORDER BY o.l_returnflag, o.l_linestatus", tuple_count=6) : (#0 shared-varchar(1) l_returnflag, #1 shared-varchar(1) l_linestatus, #2 shared-float sum_qty, #3 shared-float sum_base_price, #4 shared-float sum_disc_price, #5 shared-float sum_charge, #6 shared-float avg_qty_sum, #7 shared-float avg_qty_cnt, #8 shared-float avg_price_sum, #9 shared-float avg_price_cnt, #10 shared-float avg_discount_sum, #11 shared-float avg_discount_cnt, #12 shared-int64 cnt) order by: {<0, ASC> , <1, ASC> }, cost est: 0, output card: 6

Cost Optimization Time : 0.000327 sec
Operator #0 SecureSqlInput ran for 0.268000 ms, gate count: 0 output cardinality: 6, row width=401
Operator #1 SecureSqlInput ran for 0.287000 ms, gate count: 0 output cardinality: 6, row width=401
Operator #2 MergeJoin ran for 0.090000 ms, gate count: 12 output cardinality: 6, row width=801
Operator #3 Project ran for 8.085000 ms, gate count: 128100 output cardinality: 6, row width=305
Runtime: 0.339186 sec, CPU Time: 0.012624 sec, CPU clock ticks: 12624, CPU clock ticks per second: 1000000
End-to-end estimated gates: 163614. observed gates: 128112 gates, relative error (%)=27.7117
[Linux]Peak resident set size: 18219008 bytes, current memory size: 18219008 bytes.
Initial Memory: 16646144 bytes, Peak Memory After Execution: 18219008 bytes, Memory Usage: 1572864 bytes
Bandwidth: 1.20866e+07 Bps
[       OK ] CostOptimizedTest.cost_optimized_tpch_q1 (6229 ms)
[ RUN      ] CostOptimizedTest.cost_optimized_tpch_q3
Connecting to 127.0.0.1 on ports 7655, 65483 as 1
connected
EMP mode: sh2pc, storage mode: column store
Code version: aaab8b1c36f961a50172caf92085acacb0670290
GFlags: --flagfile=	--alice_db=tpch_alice_6000	--alice_host=127.0.0.1	--bob_db=tpch_bob_6000	--ctrl_port=65484	--cutoff=100	--filter=*	--party=1	--port=7656	--storage=column	--unioned_db=tpch_unioned_6000	--validation=true	--log_level=2	--logfile=	

[Linux]Peak resident set size: 18219008 bytes, current memory size: 17940480 bytes.
Operator (2). smj cost : 1800213040, nlj cost : 11520000000, join type : keyed-sort-merge-join
Operator (5). smj cost : 10606585344, nlj cost : 1497600000000, join type : keyed-sort-merge-join
Operator (7). sma cost : 300000000, nla cost : 18514644000000, agg type : sort-merge-aggregate
Original Tree : 
#9: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$3(32) shared-float>, <2, P$1(28) shared-int64>, <3, P$2(32) shared-int32>)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-float revenue, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32 orders.o_shippriority) order by: {<-1, ASC> , <1, DESC> , <2, ASC> }, cost est: 0, output card: 10
    #8: Sort<Bit> ({<-1, ASC> , <3, DESC> , <1, ASC> }) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <3, DESC> , <1, ASC> }, cost est: 6568, output card: 10
        #7: SortMergeAggregate<Bit> (group-by: (0, 1, 2) aggs: (SUM($3) revenue)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> }, cost est: 300000000, output card: 60175
            #-1: Sort<Bit> ({<0, ASC> , <1, ASC> , <2, ASC> }) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> , <1, ASC> , <2, ASC> }, cost est: 4088138496, output card: 240000
                #6: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$1(28) shared-int64>, <2, P$2(32) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <0, ASC> }, cost est: 0, output card: 240000
                    #5: SortMergeJoin<Bit> (P$0(20) == P$3(20)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-int32(20) lineitem.l_orderkey, #4 shared-float revenue) order by: {<-1, ASC> , <0, ASC> , <3, ASC> }, cost est: 10606585344, output card: 240000
                        #3: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$2(28) shared-int64>, <2, P$3(32) shared-int32>)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority) order by: {<-1, ASC> }, cost est: 0, output card: 60000
                            #2: SortMergeJoin<Bit> (P$1(14) == P$4(14)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32 orders.o_shippriority, #4 shared-int32(14) customer.c_custkey) order by: {<-1, ASC> , <1, ASC> , <4, ASC> }, cost est: 1800213040, output card: 60000
                                #0: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_orderdate, o_shippriority, NOT o_orderdate < DATE '1995-03-25' AS dummy_tag FROM orders ORDER BY o_orderkey, o_orderdate, o_shippriority", tuple_count=60000) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32 orders.o_shippriority) order by: {<0, ASC> }, cost est: 56189240, output card: 60000
                                #1: SecureSqlInput<Bit> ("SELECT c_custkey, NOT c_mktsegment = 'HOUSEHOLD' AS dummy_tag FROM customer ORDER BY c_custkey", tuple_count=6000) : (#0 shared-int32(14) customer.c_custkey) order by: {<0, ASC> }, cost est: 1204864, output card: 6000
                        #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_extendedprice * (1 - l_discount) AS revenue, NOT l_shipdate > DATE '1995-03-25' AS dummy_tag FROM lineitem ORDER BY l_orderkey", tuple_count=240000) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 162998796, output card: 240000

Total Plans : 96
Cost Optimized Plan : 
#9: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$3(32) shared-float>, <2, P$1(28) shared-int64>, <3, P$2(32) shared-int32>)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-float revenue, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32 orders.o_shippriority) order by: {<-1, ASC> , <1, DESC> , <2, ASC> }, cost est: 0, output card: 10
    #8: Sort<Bit> ({<-1, ASC> , <3, DESC> , <1, ASC> }) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <3, DESC> , <1, ASC> }, cost est: 6568, output card: 10
        #7: SortMergeAggregate<Bit> (group-by: (0, 1, 2) aggs: (SUM($3) revenue)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> }, cost est: 300000000, output card: 60175
            #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-float revenue) order by: {<0, ASC> }, cost est: 2752410112, output card: 240000
                #6: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$1(28) shared-int64>, <2, P$2(32) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-float revenue) order by: {<-1, ASC> , <0, ASC> }, cost est: 0, output card: 240000
                    #5: SortMergeJoin<Bit> (P$0(20) == P$3(20)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority, #3 shared-int32(20) lineitem.l_orderkey, #4 shared-float revenue) order by: {<-1, ASC> , <0, ASC> , <3, ASC> }, cost est: 7603235136, output card: 240000
                        #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority) order by: {<0, ASC> }, cost est: 417790592, output card: 60000
                            #3: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$2(28) shared-int64>, <2, P$3(32) shared-int32>)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int64(28) orders.o_orderdate, #2 shared-int32 orders.o_shippriority) order by: {<-1, ASC> }, cost est: 0, output card: 60000
                                #2: SortMergeJoin<Bit> (P$1(14) == P$4(14)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32 orders.o_shippriority, #4 shared-int32(14) customer.c_custkey) order by: {<-1, ASC> , <1, ASC> , <4, ASC> }, cost est: 1268875200, output card: 60000
                                    #0: SecureSqlInput<Bit> ("SELECT * FROM (SELECT o_orderkey, o_custkey, o_orderdate, o_shippriority, NOT o_orderdate < DATE '1995-03-25' AS dummy_tag FROM orders ORDER BY o_orderkey, o_orderdate, o_shippriority) to_sort ORDER BY (2)  ASC ", tuple_count=60000) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-int64(28) orders.o_orderdate, #3 shared-int32 orders.o_shippriority) order by: {<1, ASC> }, cost est: 53332160, output card: 60000
                                    #1: SecureSqlInput<Bit> ("SELECT c_custkey, NOT c_mktsegment = 'HOUSEHOLD' AS dummy_tag FROM customer ORDER BY c_custkey", tuple_count=6000) : (#0 shared-int32(14) customer.c_custkey) order by: {<0, ASC> }, cost est: 1204864, output card: 6000
                        #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_extendedprice * (1 - l_discount) AS revenue, NOT l_shipdate > DATE '1995-03-25' AS dummy_tag FROM lineitem ORDER BY l_orderkey", tuple_count=240000) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 162998796, output card: 240000

Cost Optimization Time : 0.190322 sec
Operator #0 SecureSqlInput ran for 5090.753000 ms, gate count: 51590880 output cardinality: 60000, row width=95
Operator #1 SecureSqlInput ran for 255.954000 ms, gate count: 1099680 output cardinality: 6000, row width=15
Operator #2 SortMergeJoin ran for 133172.202000 ms, gate count: 1628880084 output cardinality: 60000, row width=109
Operator #3 Project ran for 24.907000 ms, gate count: 0 output cardinality: 60000, row width=81
Operator #-1 Sort ran for 34973.777000 ms, gate count: 400154976 output cardinality: 60000, row width=81
Operator #4 SecureSqlInput ran for 16513.284000 ms, gate count: 156586368 output cardinality: 240000, row width=53
Operator #5 SortMergeJoin ran for 677324.843000 ms, gate count: 10328850960 output cardinality: 240000, row width=133
Operator #6 Project ran for 376.859000 ms, gate count: 0 output cardinality: 240000, row width=113
Operator #-1 Sort ran for 207093.942000 ms, gate count: 2653791744 output cardinality: 240000, row width=113
Operator #7 SortMergeAggregate ran for 23240.469000 ms, gate count: 293038812 output cardinality: 240000, row width=113
Operator #8 Sort ran for 296975.674000 ms, gate count: 3515817216 output cardinality: 10, row width=113
Operator #9 Project ran for 0.033000 ms, gate count: 0 output cardinality: 10, row width=113
Runtime: 1395.59 sec, CPU Time: 1377.72 sec, CPU clock ticks: 1.37772e+09, CPU clock ticks per second: 1000000
End-to-end estimated gates: 1.25599e+10. observed gates: 16791498732 gates, relative error (%)=25.2011
[Linux]Peak resident set size: 3337031680 bytes, current memory size: 181321728 bytes.
Initial Memory: 18219008 bytes, Peak Memory After Execution: 3337031680 bytes, Memory Usage: 3318812672 bytes
Bandwidth: 3.8502e+08 Bps
[       OK ] CostOptimizedTest.cost_optimized_tpch_q3 (1396958 ms)
[ RUN      ] CostOptimizedTest.cost_optimized_tpch_q5
Connecting to 127.0.0.1 on ports 7656, 65484 as 1
connected
EMP mode: sh2pc, storage mode: column store
Code version: aaab8b1c36f961a50172caf92085acacb0670290
GFlags: --flagfile=	--alice_db=tpch_alice_6000	--alice_host=127.0.0.1	--bob_db=tpch_bob_6000	--ctrl_port=65485	--cutoff=100	--filter=*	--party=1	--port=7657	--storage=column	--unioned_db=tpch_unioned_6000	--validation=true	--log_level=2	--logfile=	

[Linux]Peak resident set size: 3337031680 bytes, current memory size: 181321728 bytes.
Operator (2). smj cost : 4066344542, nlj cost : 640320000, join type : nested-loop-join
Operator (6). smj cost : 1917890012, nlj cost : 16466760000, join type : keyed-sort-merge-join
Operator (8). smj cost : 21039394304, nlj cost : 3859200000000, join type : keyed-sort-merge-join
Operator (10). sma cost : 356640000, nla cost : 1821600000, agg type : sort-merge-aggregate
Original Tree : 
#11: Sort<Bit> ({<1, DESC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<1, DESC> }, cost est: 2583, output card: 5
    #10: SortMergeAggregate<Bit> (group-by: (0) aggs: (SUM($1) revenue)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 356640000, output card: 5
        #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<0, ASC> }, cost est: 8823903232, output card: 240000
            #9: Project<Bit> ((<0, P$4(200) shared-varchar>, <1, P$2(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<-1, ASC> }, cost est: 0, output card: 240000
                #8: SortMergeJoin<Bit> ((P$0(5) == P$3(5)) AND (P$1(20) == P$5(20))) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(20) lineitem.l_orderkey, #2 shared-float revenue, #3 shared-int32(5) customer.c_nationkey, #4 shared-varchar(25) nation.n_name, #5 shared-int32(20) orders.o_orderkey) order by: {<-1, ASC> , <0, ASC> , <3, ASC> , <1, ASC> , <5, ASC> }, cost est: 21039394304, output card: 240000
                    #3: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(20) shared-int32>, <2, P$4(32) shared-float>)) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(20) lineitem.l_orderkey, #2 shared-float revenue) order by: {}, cost est: 0, output card: 240000
                        #2: KeyedJoin<Bit> (P$0(10) == P$3(10)) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey, #2 shared-int32(20) lineitem.l_orderkey, #3 shared-int32(10) lineitem.l_suppkey, #4 shared-float revenue) order by: {<3, ASC> , <0, ASC> }, cost est: 640320000, output card: 240000
                            #0: SecureSqlInput<Bit> ("SELECT s_suppkey, s_nationkey FROM supplier JOIN nation ON s_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE r_name = 'EUROPE' ORDER BY s_suppkey", tuple_count=92) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey) order by: {<0, ASC> }, cost est: 8700, output card: 92
                            #1: SecureSqlInput<Bit> ("SELECT l_orderkey, l_suppkey, l_extendedprice * (1 - l_discount) AS revenue FROM lineitem ORDER BY l_suppkey", tuple_count=240000) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float revenue) order by: {<1, ASC> }, cost est: 162998796, output card: 240000
                    #7: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(200) shared-varchar>, <2, P$3(20) shared-int32>)) : (#0 shared-int32(5) customer.c_nationkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(20) orders.o_orderkey) order by: {<-1, ASC> }, cost est: 0, output card: 60000
                        #6: SortMergeJoin<Bit> (P$0(14) == P$4(14)) : (#0 shared-int32(14) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name, #3 shared-int32(20) orders.o_orderkey, #4 shared-int32(14) orders.o_custkey) order by: {<-1, ASC> , <0, ASC> , <4, ASC> }, cost est: 1917890012, output card: 60000
                            #4: SecureSqlInput<Bit> ("SELECT t2.c_custkey, t2.c_nationkey, t1.n_name FROM (SELECT r_regionkey, r_name FROM region WHERE r_name = 'EUROPE') AS t0 INNER JOIN (SELECT n_nationkey, n_name, n_regionkey FROM nation) AS t1 ON t0.r_regionkey = t1.n_regionkey INNER JOIN (SELECT c_custkey, c_nationkey FROM customer) AS t2 ON t1.n_nationkey = t2.c_nationkey ORDER BY t2.c_custkey ASC", tuple_count=1158) : (#0 shared-int32(14) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name) order by: {<0, ASC> }, cost est: 1396404, output card: 1158
                            #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, NOT (o_orderdate >= DATE '1993-01-01' AND o_orderdate < DATE '1994-01-01') AS dummy_tag FROM orders ORDER BY o_custkey, o_orderdate", tuple_count=60000) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey) order by: {<1, ASC> }, cost est: 24761360, output card: 60000

Total Plans : 1296
Cost Optimized Plan : 
#11: Sort<Bit> ({<1, DESC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<1, DESC> }, cost est: 2583, output card: 5
    #10: NestedLoopAggregate<Bit> (group-by: (0) aggs: (SUM($1) revenue)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {}, cost est: 1821600000, output card: 5
        #9: Project<Bit> ((<0, P$4(200) shared-varchar>, <1, P$2(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-float revenue) order by: {<-1, ASC> }, cost est: 0, output card: 240000
            #8: SortMergeJoin<Bit> ((P$0(5) == P$3(5)) AND (P$1(20) == P$5(20))) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(20) lineitem.l_orderkey, #2 shared-float revenue, #3 shared-int32(5) customer.c_nationkey, #4 shared-varchar(25) nation.n_name, #5 shared-int32(20) orders.o_orderkey) order by: {<-1, ASC> , <0, ASC> , <3, ASC> , <1, ASC> , <5, ASC> }, cost est: 14446102272, output card: 240000
                #-1: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(20) lineitem.l_orderkey, #2 shared-float revenue) order by: {<0, ASC> , <1, ASC> }, cost est: 1801209600, output card: 240000
                    #3: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(20) shared-int32>, <2, P$4(32) shared-float>)) : (#0 shared-int32(5) supplier.s_nationkey, #1 shared-int32(20) lineitem.l_orderkey, #2 shared-float revenue) order by: {}, cost est: 0, output card: 240000
                        #2: KeyedJoin<Bit> (P$0(10) == P$3(10)) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey, #2 shared-int32(20) lineitem.l_orderkey, #3 shared-int32(10) lineitem.l_suppkey, #4 shared-float revenue) order by: {}, cost est: 640320000, output card: 240000
                            #0: SecureSqlInput<Bit> ("SELECT s_suppkey, s_nationkey FROM supplier JOIN nation ON s_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE r_name = 'EUROPE' ORDER BY s_suppkey", tuple_count=92) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-int32(5) supplier.s_nationkey) order by: {}, cost est: 0, output card: 92
                            #1: SecureSqlInput<Bit> ("SELECT l_orderkey, l_suppkey, l_extendedprice * (1 - l_discount) AS revenue FROM lineitem ORDER BY l_suppkey", tuple_count=240000) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float revenue) order by: {}, cost est: 0, output card: 240000
                #-1: Sort<Bit> ({<0, ASC> , <2, ASC> }) : (#0 shared-int32(5) customer.c_nationkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(20) orders.o_orderkey) order by: {<0, ASC> , <2, ASC> }, cost est: 1032424832, output card: 60000
                    #7: Project<Bit> ((<0, P$1(5) shared-int32>, <1, P$2(200) shared-varchar>, <2, P$3(20) shared-int32>)) : (#0 shared-int32(5) customer.c_nationkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(20) orders.o_orderkey) order by: {<-1, ASC> }, cost est: 0, output card: 60000
                        #6: SortMergeJoin<Bit> (P$0(14) == P$4(14)) : (#0 shared-int32(14) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name, #3 shared-int32(20) orders.o_orderkey, #4 shared-int32(14) orders.o_custkey) order by: {<-1, ASC> , <0, ASC> , <4, ASC> }, cost est: 1917890012, output card: 60000
                            #4: SecureSqlInput<Bit> ("SELECT t2.c_custkey, t2.c_nationkey, t1.n_name FROM (SELECT r_regionkey, r_name FROM region WHERE r_name = 'EUROPE') AS t0 INNER JOIN (SELECT n_nationkey, n_name, n_regionkey FROM nation) AS t1 ON t0.r_regionkey = t1.n_regionkey INNER JOIN (SELECT c_custkey, c_nationkey FROM customer) AS t2 ON t1.n_nationkey = t2.c_nationkey ORDER BY t2.c_custkey ASC", tuple_count=1158) : (#0 shared-int32(14) customer.c_custkey, #1 shared-int32(5) customer.c_nationkey, #2 shared-varchar(25) nation.n_name) order by: {<0, ASC> }, cost est: 1396404, output card: 1158
                            #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, NOT (o_orderdate >= DATE '1993-01-01' AND o_orderdate < DATE '1994-01-01') AS dummy_tag FROM orders ORDER BY o_custkey, o_orderdate", tuple_count=60000) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey) order by: {<1, ASC> }, cost est: 24761360, output card: 60000

Cost Optimization Time : 1.24271 sec
Operator #0 SecureSqlInput ran for 0.365000 ms, gate count: 0 output cardinality: 92, row width=16
Operator #1 SecureSqlInput ran for 804.457000 ms, gate count: 0 output cardinality: 240000, row width=63
Operator #2 KeyedJoin ran for 56199.721000 ms, gate count: 662400000 output cardinality: 240000, row width=78
Operator #3 Project ran for 215.841000 ms, gate count: 0 output cardinality: 240000, row width=58
Operator #-1 Sort ran for 148698.335000 ms, gate count: 1663570944 output cardinality: 240000, row width=58
Operator #4 SecureSqlInput ran for 973.601000 ms, gate count: 1343028 output cardinality: 1158, row width=220
Operator #5 SecureSqlInput ran for 2359.164000 ms, gate count: 23450400 output cardinality: 60000, row width=35
Operator #6 SortMergeJoin ran for 208038.043000 ms, gate count: 5103628184 output cardinality: 60000, row width=254
Operator #7 Project ran for 199.976000 ms, gate count: 0 output cardinality: 60000, row width=226
Operator #-1 Sort ran for 74238.628000 ms, gate count: 988618176 output cardinality: 60000, row width=226
Operator #8 SortMergeJoin ran for 1345292.555000 ms, gate count: 23135211292 output cardinality: 240000, row width=283
Operator #9 Project ran for 885.270000 ms, gate count: 0 output cardinality: 240000, row width=233
Operator #10 NestedLoopAggregate ran for 135878.318000 ms, gate count: 1750800000 output cardinality: 5, row width=233
Operator #11 Sort ran for 0.335000 ms, gate count: 3024 output cardinality: 5, row width=233
Runtime: 1975.34 sec, CPU Time: 1930.84 sec, CPU clock ticks: 1.93084e+09, CPU clock ticks per second: 1000000
End-to-end estimated gates: 2.16857e+10. observed gates: 24886014316 gates, relative error (%)=12.8599
[Linux]Peak resident set size: 7964618752 bytes, current memory size: 1599021056 bytes.
Initial Memory: 3337031680 bytes, Peak Memory After Execution: 7964618752 bytes, Memory Usage: 4627587072 bytes
Bandwidth: 4.03147e+08 Bps
[       OK ] CostOptimizedTest.cost_optimized_tpch_q5 (1975555 ms)
[ RUN      ] CostOptimizedTest.cost_optimized_tpch_q8
Connecting to 127.0.0.1 on ports 7657, 65485 as 1
connected
EMP mode: sh2pc, storage mode: column store
Code version: aaab8b1c36f961a50172caf92085acacb0670290
GFlags: --flagfile=	--alice_db=tpch_alice_6000	--alice_host=127.0.0.1	--bob_db=tpch_bob_6000	--ctrl_port=65486	--cutoff=100	--filter=*	--party=1	--port=7658	--storage=column	--unioned_db=tpch_unioned_6000	--validation=true	--log_level=2	--logfile=	

[Linux]Peak resident set size: 7964618752 bytes, current memory size: 1599021056 bytes.
Original Tree : 
#12: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32 orders.o_year, #1 shared-float mkt_share) order by: {<0, ASC> }, cost est: 100, output card: 2
    #11: Project<Bit> ((<0, P$0(32) shared-int32>, <1, $2 / $1 shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float mkt_share) order by: {<0, ASC> }, cost est: 7618, output card: 2
        #10: SortMergeAggregate<Bit> (group-by: (0) aggs: (SUM($1) null, SUM($2) null)) : (#0 shared-int32 orders.o_year, #1 shared-float null, #2 shared-float null) order by: {<0, ASC> }, cost est: 552000000, output card: 2
            #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32 orders.o_year, #1 shared-float volume, #2 shared-float selected_volume) order by: {<0, ASC> }, cost est: 2671457024, output card: 240000
                #9: Project<Bit> ((<0, P$1(32) shared-int32>, <1, P$3(32) shared-float>, <2, CASE($4, $3, SECRET FLOAT) shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float volume, #2 shared-float selected_volume) order by: {}, cost est: 0, output card: 240000
                    #8: KeyedJoin<Bit> (P$0(20) == P$2(20)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32 orders.o_year, #2 shared-int32(20) lineitem.l_orderkey, #3 shared-float volume, #4 shared-bool nation_check) order by: {}, cost est: 1094400000000, output card: 240000
                        #3: Project<Bit> ((<0, P$1(20) shared-int32>, <1, P$3(32) shared-int32>)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32 orders.o_year) order by: {}, cost est: 0, output card: 60000
                            #2: KeyedJoin<Bit> (P$0(14) == P$2(14)) : (#0 shared-int32(14) customer.c_custkey, #1 shared-int32(20) orders.o_orderkey, #2 shared-int32(14) orders.o_custkey, #3 shared-int32 orders.o_year) order by: {<2, ASC> , <0, ASC> }, cost est: 2421120000, output card: 60000
                                #0: SecureSqlInput<Bit> ("SELECT c_custkey FROM customer c JOIN nation n1 ON c_nationkey = n_nationkey JOIN region ON r_regionkey = n_regionkey WHERE r_name = 'AFRICA' ORDER BY c_custkey", tuple_count=1261) : (#0 shared-int32(14) customer.c_custkey) order by: {<0, ASC> }, cost est: 207808, output card: 1261
                                #1: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_orderyear::INT AS o_year, NOT (o_orderdate >= date '1995-01-01' and o_orderdate < date '1996-12-31') dummy_tag FROM orders ORDER BY o_custkey", tuple_count=60000) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-int32 orders.o_year) order by: {<1, ASC> }, cost est: 39999120, output card: 60000
                        #7: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$2(32) shared-float>, <2, P$4(1) shared-bool>)) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-float volume, #2 shared-bool nation_check) order by: {}, cost est: 0, output card: 240000
                            #6: KeyedJoin<Bit> (P$1(10) == P$3(10)) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float volume, #3 shared-int32(10) supplier.s_suppkey, #4 shared-bool nation_check) order by: {<1, ASC> , <3, ASC> }, cost est: 2400000000, output card: 240000
                                #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_suppkey, l_extendedprice * (1.0 - l_discount) AS volume,        CASE            WHEN p_type = 'LARGE ANODIZED STEEL' AND p_partkey = l_partkey THEN FALSE            ELSE TRUE            END AS dummy_tag FROM lineitem LEFT JOIN part ON p_partkey = l_partkey ORDER BY l_suppkey", tuple_count=240000) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float volume) order by: {<1, ASC> }, cost est: 162998796, output card: 240000
                                #5: SecureSqlInput<Bit> ("SELECT s_suppkey, CASE WHEN n_name = 'KENYA' THEN true ELSE false END AS nation_check FROM supplier JOIN nation ON n_nationkey = s_nationkey ORDER BY s_suppkey", tuple_count=400) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-bool nation_check) order by: {<0, ASC> }, cost est: 43200, output card: 400

Total Plans : 576
Cost Optimized Plan : 
#12: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32 orders.o_year, #1 shared-float mkt_share) order by: {<0, ASC> }, cost est: 100, output card: 2
    #11: Project<Bit> ((<0, P$0(32) shared-int32>, <1, $2 / $1 shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float anonymous) order by: {}, cost est: 7618, output card: 2
        #10: NestedLoopAggregate<Bit> (group-by: (0) aggs: (SUM($1) null, SUM($2) null)) : (#0 shared-int32 orders.o_year, #1 shared-float null, #2 shared-float null) order by: {}, cost est: 1134720000, output card: 2
            #9: Project<Bit> ((<0, P$1(32) shared-int32>, <1, P$3(32) shared-float>, <2, CASE($4, $3, SECRET FLOAT) shared-float>)) : (#0 shared-int32 orders.o_year, #1 shared-float volume, #2 shared-float anonymous) order by: {<-1, ASC> }, cost est: 0, output card: 240000
                #8: SortMergeJoin<Bit> (P$0(20) == P$2(20)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32 orders.o_year, #2 shared-int32(20) lineitem.l_orderkey, #3 shared-float volume, #4 shared-bool nation_check) order by: {<-1, ASC> , <0, ASC> , <2, ASC> }, cost est: 6372129792, output card: 240000
                    #-1: Sort<Bit> ({<0, ASC> }) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32 orders.o_year) order by: {<0, ASC> }, cost est: 305308512, output card: 60000
                        #3: Project<Bit> ((<0, P$1(20) shared-int32>, <1, P$3(32) shared-int32>)) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32 orders.o_year) order by: {<-1, ASC> }, cost est: 0, output card: 60000
                            #2: SortMergeJoin<Bit> (P$0(14) == P$2(14)) : (#0 shared-int32(14) customer.c_custkey, #1 shared-int32(20) orders.o_orderkey, #2 shared-int32(14) orders.o_custkey, #3 shared-int32 orders.o_year) order by: {<-1, ASC> , <0, ASC> , <2, ASC> }, cost est: 913639282, output card: 60000
                                #0: SecureSqlInput<Bit> ("SELECT c_custkey FROM customer c JOIN nation n1 ON c_nationkey = n_nationkey JOIN region ON r_regionkey = n_regionkey WHERE r_name = 'AFRICA' ORDER BY c_custkey", tuple_count=1261) : (#0 shared-int32(14) customer.c_custkey) order by: {<0, ASC> }, cost est: 207808, output card: 1261
                                #1: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_orderyear::INT AS o_year, NOT (o_orderdate >= date '1995-01-01' and o_orderdate < date '1996-12-31') dummy_tag FROM orders ORDER BY o_custkey", tuple_count=60000) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-int32 orders.o_year) order by: {<1, ASC> }, cost est: 39999120, output card: 60000
                    #7: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$2(32) shared-float>, <2, P$4(1) shared-bool>)) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-float volume, #2 shared-bool nation_check) order by: {<0, ASC> }, cost est: 0, output card: 240000
                        #6: KeyedJoin<Bit> (P$1(10) == P$3(10)) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float volume, #3 shared-int32(10) supplier.s_suppkey, #4 shared-bool nation_check) order by: {<0, ASC> }, cost est: 2400000000, output card: 240000
                            #4: SecureSqlInput<Bit> ("SELECT * FROM (SELECT l_orderkey, l_suppkey, l_extendedprice * (1.0 - l_discount) AS volume,        CASE            WHEN p_type = 'LARGE ANODIZED STEEL' AND p_partkey = l_partkey THEN FALSE            ELSE TRUE            END AS dummy_tag FROM lineitem LEFT JOIN part ON p_partkey = l_partkey ORDER BY l_suppkey) to_sort ORDER BY (1)  ASC ", tuple_count=240000) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float volume) order by: {<0, ASC> }, cost est: 184446006, output card: 240000
                            #5: SecureSqlInput<Bit> ("SELECT s_suppkey, CASE WHEN n_name = 'KENYA' THEN true ELSE false END AS nation_check FROM supplier JOIN nation ON n_nationkey = s_nationkey ORDER BY s_suppkey", tuple_count=400) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-bool nation_check) order by: {}, cost est: 0, output card: 400

Cost Optimization Time : 1.02333 sec
Operator #0 SecureSqlInput ran for 47.733000 ms, gate count: 187980 output cardinality: 1261, row width=15
Operator #1 SecureSqlInput ran for 3595.660000 ms, gate count: 38458656 output cardinality: 60000, row width=67
Operator #2 SortMergeJoin ran for 95005.475000 ms, gate count: 1205979668 output cardinality: 60000, row width=81
Operator #3 Project ran for 14.072000 ms, gate count: 0 output cardinality: 60000, row width=53
Operator #-1 Sort ran for 24734.593000 ms, gate count: 290308512 output cardinality: 60000, row width=53
Operator #4 SecureSqlInput ran for 18062.305000 ms, gate count: 177746688 output cardinality: 240000, row width=63
Operator #5 SecureSqlInput ran for 815.358000 ms, gate count: 0 output cardinality: 400, row width=12
Operator #6 KeyedJoin ran for 224063.128000 ms, gate count: 2496000000 output cardinality: 240000, row width=74
Operator #7 Project ran for 198.839000 ms, gate count: 0 output cardinality: 240000, row width=54
Operator #8 SortMergeJoin ran for 555275.238000 ms, gate count: 10682977128 output cardinality: 240000, row width=106
Operator #9 Project ran for 3469.567000 ms, gate count: 7680000 output cardinality: 240000, row width=97
Operator #10 NestedLoopAggregate ran for 69432.870000 ms, gate count: 1044480000 output cardinality: 2, row width=97
Operator #11 Project ran for 0.432000 ms, gate count: 7620 output cardinality: 2, row width=65
Operator #12 Sort ran for 0.110000 ms, gate count: 96 output cardinality: 2, row width=65
Runtime: 996.215 sec, CPU Time: 975.06 sec, CPU clock ticks: 9.7506e+08, CPU clock ticks per second: 1000000
End-to-end estimated gates: 1.13505e+10. observed gates: 11735144844 gates, relative error (%)=3.27807
[Linux]Peak resident set size: 7964618752 bytes, current memory size: 3210133504 bytes.
Initial Memory: 7964618752 bytes, Peak Memory After Execution: 7964618752 bytes, Memory Usage: 0 bytes
Bandwidth: 3.76951e+08 Bps
[       OK ] CostOptimizedTest.cost_optimized_tpch_q8 (996381 ms)
[ RUN      ] CostOptimizedTest.cost_optimized_tpch_q9
Connecting to 127.0.0.1 on ports 7658, 65486 as 1
connected
EMP mode: sh2pc, storage mode: column store
Code version: aaab8b1c36f961a50172caf92085acacb0670290
GFlags: --flagfile=	--alice_db=tpch_alice_6000	--alice_host=127.0.0.1	--bob_db=tpch_bob_6000	--ctrl_port=65487	--cutoff=100	--filter=*	--party=1	--port=7659	--storage=column	--unioned_db=tpch_unioned_6000	--validation=true	--log_level=2	--logfile=	

[Linux]Peak resident set size: 7964618752 bytes, current memory size: 3210133504 bytes.
Operator (2). smj cost : 54969414, nlj cost : 159129600, join type : keyed-sort-merge-join
Operator (6). smj cost : 8925533152, nlj cost : 1094400000000, join type : keyed-sort-merge-join
Operator (8). smj cost : 16317131712, nlj cost : 132134400000, join type : keyed-sort-merge-join
Operator (10). sma cost : 372000000, nla cost : 66444000000, agg type : sort-merge-aggregate
Original Tree : 
#11: Sort<Bit> ({<0, ASC> , <1, DESC> }) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float sum_profit) order by: {<0, ASC> , <1, DESC> }, cost est: 1385772, output card: 175
    #10: SortMergeAggregate<Bit> (group-by: (0, 1) aggs: (SUM($2) sum_profit)) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float sum_profit) order by: {<0, ASC> , <1, DESC> }, cost est: 372000000, output card: 175
        #-1: Sort<Bit> ({<0, ASC> , <1, ASC> }) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float amount) order by: {<0, ASC> , <1, ASC> }, cost est: 10179869696, output card: 240000
            #9: Project<Bit> ((<0, P$0(200) shared-varchar>, <1, P$8(32) shared-int32>, <2, $7 - ($3 * $6) shared-float>)) : (#0 shared-varchar(25) nation.nation, #1 shared-int32 o_year, #2 shared-float amount) order by: {<-1, ASC> }, cost est: 1093680000, output card: 240000
                #8: SortMergeJoin<Bit> ((P$2(10) == P$5(10)) AND (P$1(15) == P$4(15))) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(15) partsupp.ps_partkey, #2 shared-int32(10) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost, #4 shared-int32(15) lineitem.l_partkey, #5 shared-int32(10) lineitem.l_suppkey, #6 shared-float l_quantity, #7 shared-float volume, #8 shared-int32 o_year) order by: {<-1, ASC> , <2, ASC> , <5, ASC> , <1, ASC> , <4, ASC> }, cost est: 16317131712, output card: 240000
                    #3: Project<Bit> ((<0, P$1(200) shared-varchar>, <1, P$2(15) shared-int32>, <2, P$3(10) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(15) partsupp.ps_partkey, #2 shared-int32(10) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost) order by: {<-1, ASC> }, cost est: 0, output card: 1776
                        #2: SortMergeJoin<Bit> (P$0(10) == P$3(10)) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(15) partsupp.ps_partkey, #3 shared-int32(10) partsupp.ps_suppkey, #4 shared-float partsupp.ps_supplycost) order by: {<-1, ASC> , <0, ASC> , <3, ASC> }, cost est: 54969414, output card: 1776
                            #0: SecureSqlInput<Bit> ("SELECT s_suppkey, n_name FROM supplier JOIN nation ON s_nationkey = n_nationkey ORDER BY s_suppkey", tuple_count=400) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name) order by: {<0, ASC> }, cost est: 387072, output card: 400
                            #1: SecureSqlInput<Bit> ("SELECT ps_partkey, ps_suppkey, ps_supplycost FROM partsupp JOIN part ON ps_partkey = p_partkey WHERE p_name LIKE '%yellow%' ORDER BY ps_suppkey, ps_partkey", tuple_count=1776) : (#0 shared-int32(15) partsupp.ps_partkey, #1 shared-int32(10) partsupp.ps_suppkey, #2 shared-float partsupp.ps_supplycost) order by: {<0, ASC> , <1, ASC> }, cost est: 853065, output card: 1776
                    #7: Project<Bit> ((<0, P$1(15) shared-int32>, <1, P$2(10) shared-int32>, <2, P$3(32) shared-float>, <3, P$4(32) shared-float>, <4, P$5(32) shared-int32>)) : (#0 shared-int32(15) lineitem.l_partkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float l_quantity, #3 shared-float volume, #4 shared-int32 o_year) order by: {<-1, ASC> }, cost est: 0, output card: 240000
                        #6: SortMergeJoin<Bit> (P$0(20) == P$6(20)) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(15) lineitem.l_partkey, #2 shared-int32(10) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float volume, #5 shared-int32 o_year, #6 shared-int32(20) orders.o_orderkey) order by: {<-1, ASC> , <0, ASC> , <6, ASC> }, cost est: 8925533152, output card: 240000
                            #4: SecureSqlInput<Bit> ("SELECT l_orderkey, l_partkey, l_suppkey, l_quantity::float4, l_extendedprice * (1.0 - l_discount) AS volume FROM lineitem ORDER BY l_orderkey, l_partkey, l_suppkey", tuple_count=240000) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(15) lineitem.l_partkey, #2 shared-int32(10) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float volume) order by: {<0, ASC> , <2, ASC> , <1, ASC> }, cost est: 351734244, output card: 240000
                            #5: SecureSqlInput<Bit> ("SELECT EXTRACT('year' FROM o_orderdate)::INT AS o_year, o_orderkey FROM orders ORDER BY o_orderkey", tuple_count=60000) : (#0 shared-int32 o_year, #1 shared-int32(20) orders.o_orderkey) order by: {<1, ASC> }, cost est: 36189680, output card: 60000

Total Plans : 1536
Cost Optimized Plan : 
#10: SortMergeAggregate<Bit> (group-by: (0, 1) aggs: (SUM($2) sum_profit)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32 o_year, #2 shared-float sum_profit) order by: {<0, ASC> , <1, DESC> }, cost est: 372000000, output card: 175
    #-1: Sort<Bit> ({<0, ASC> , <1, DESC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32 o_year, #2 shared-float anonymous) order by: {<0, ASC> , <1, DESC> }, cost est: 10179869696, output card: 240000
        #9: Project<Bit> ((<0, P$0(200) shared-varchar>, <1, P$8(32) shared-int32>, <2, $7 - ($3 * $6) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32 o_year, #2 shared-float anonymous) order by: {<-1, ASC> }, cost est: 1093680000, output card: 240000
            #8: SortMergeJoin<Bit> ((P$2(10) == P$5(10)) AND (P$1(15) == P$4(15))) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(15) partsupp.ps_partkey, #2 shared-int32(10) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost, #4 shared-int32(15) lineitem.l_partkey, #5 shared-int32(10) lineitem.l_suppkey, #6 shared-float l_quantity, #7 shared-float volume, #8 shared-int32 o_year) order by: {<-1, ASC> , <2, ASC> , <5, ASC> , <1, ASC> , <4, ASC> }, cost est: 10623184448, output card: 240000
                #-1: Sort<Bit> ({<2, ASC> , <1, ASC> }) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(15) partsupp.ps_partkey, #2 shared-int32(10) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost) order by: {<2, ASC> , <1, ASC> }, cost est: 16336400, output card: 1776
                    #3: Project<Bit> ((<0, P$1(200) shared-varchar>, <1, P$2(15) shared-int32>, <2, P$3(10) shared-int32>, <3, P$4(32) shared-float>)) : (#0 shared-varchar(25) nation.n_name, #1 shared-int32(15) partsupp.ps_partkey, #2 shared-int32(10) partsupp.ps_suppkey, #3 shared-float partsupp.ps_supplycost) order by: {<-1, ASC> }, cost est: 0, output card: 1776
                        #2: SortMergeJoin<Bit> (P$0(10) == P$3(10)) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name, #2 shared-int32(15) partsupp.ps_partkey, #3 shared-int32(10) partsupp.ps_suppkey, #4 shared-float partsupp.ps_supplycost) order by: {<-1, ASC> , <0, ASC> , <3, ASC> }, cost est: 40306171, output card: 1776
                            #0: SecureSqlInput<Bit> ("SELECT s_suppkey, n_name FROM supplier JOIN nation ON s_nationkey = n_nationkey ORDER BY s_suppkey", tuple_count=400) : (#0 shared-int32(10) supplier.s_suppkey, #1 shared-varchar(25) nation.n_name) order by: {<0, ASC> }, cost est: 387072, output card: 400
                            #1: SecureSqlInput<Bit> ("SELECT * FROM (SELECT ps_partkey, ps_suppkey, ps_supplycost FROM partsupp JOIN part ON ps_partkey = p_partkey WHERE p_name LIKE '%yellow%' ORDER BY ps_suppkey, ps_partkey) to_sort ORDER BY (2)  ASC ", tuple_count=1776) : (#0 shared-int32(15) partsupp.ps_partkey, #1 shared-int32(10) partsupp.ps_suppkey, #2 shared-float partsupp.ps_supplycost) order by: {<1, ASC> }, cost est: 680535, output card: 1776
                #-1: Sort<Bit> ({<1, ASC> , <0, ASC> }) : (#0 shared-int32(15) lineitem.l_partkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float l_quantity, #3 shared-float volume, #4 shared-int32 o_year) order by: {<1, ASC> , <0, ASC> }, cost est: 3096461312, output card: 240000
                    #7: Project<Bit> ((<0, P$1(15) shared-int32>, <1, P$2(10) shared-int32>, <2, P$3(32) shared-float>, <3, P$4(32) shared-float>, <4, P$5(32) shared-int32>)) : (#0 shared-int32(15) lineitem.l_partkey, #1 shared-int32(10) lineitem.l_suppkey, #2 shared-float l_quantity, #3 shared-float volume, #4 shared-int32 o_year) order by: {<-1, ASC> }, cost est: 0, output card: 240000
                        #6: SortMergeJoin<Bit> (P$0(20) == P$6(20)) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(15) lineitem.l_partkey, #2 shared-int32(10) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float volume, #5 shared-int32 o_year, #6 shared-int32(20) orders.o_orderkey) order by: {<-1, ASC> , <0, ASC> , <6, ASC> }, cost est: 8925533152, output card: 240000
                            #4: SecureSqlInput<Bit> ("SELECT * FROM (SELECT l_orderkey, l_partkey, l_suppkey, l_quantity::float4, l_extendedprice * (1.0 - l_discount) AS volume FROM lineitem ORDER BY l_orderkey, l_partkey, l_suppkey) to_sort ORDER BY (1)  ASC ", tuple_count=240000) : (#0 shared-int32(20) lineitem.l_orderkey, #1 shared-int32(15) lineitem.l_partkey, #2 shared-int32(10) lineitem.l_suppkey, #3 shared-float l_quantity, #4 shared-float volume) order by: {<0, ASC> }, cost est: 285247893, output card: 240000
                            #5: SecureSqlInput<Bit> ("SELECT EXTRACT('year' FROM o_orderdate)::INT AS o_year, o_orderkey FROM orders ORDER BY o_orderkey", tuple_count=60000) : (#0 shared-int32 o_year, #1 shared-int32(20) orders.o_orderkey) order by: {<1, ASC> }, cost est: 36189680, output card: 60000

Cost Optimization Time : 2.98508 sec
Operator #0 SecureSqlInput ran for 125.587000 ms, gate count: 369408 output cardinality: 400, row width=211
Operator #1 SecureSqlInput ran for 66.043000 ms, gate count: 644736 output cardinality: 1776, row width=58
Operator #2 SortMergeJoin ran for 3328.121000 ms, gate count: 46347096 output cardinality: 1776, row width=268
Operator #3 Project ran for 1.777000 ms, gate count: 0 output cardinality: 1776, row width=258
Operator #-1 Sort ran for 1100.831000 ms, gate count: 15467776 output cardinality: 1776, row width=258
Operator #4 SecureSqlInput ran for 26866.145000 ms, gate count: 277200192 output cardinality: 240000, row width=110
Operator #5 SecureSqlInput ran for 4782.367000 ms, gate count: 34706592 output cardinality: 60000, row width=53
Operator #6 SortMergeJoin ran for 791974.647000 ms, gate count: 10268000480 output cardinality: 240000, row width=162
Operator #7 Project ran for 277.764000 ms, gate count: 0 output cardinality: 240000, row width=122
Operator #-1 Sort ran for 233146.206000 ms, gate count: 2931053568 output cardinality: 240000, row width=122
Operator #8 SortMergeJoin ran for 1197812.786000 ms, gate count: 29000932864 output cardinality: 240000, row width=379
Operator #9 Project ran for 85673.763000 ms, gate count: 1093680000 output cardinality: 240000, row width=265
Operator #-1 Sort ran for 804057.556000 ms, gate count: 9877479168 output cardinality: 240000, row width=265
Operator #10 SortMergeAggregate ran for 29535.279000 ms, gate count: 364798512 output cardinality: 240000, row width=265
Runtime: 3182.37 sec, CPU Time: 3114.97 sec, CPU clock ticks: 3.11497e+09, CPU clock ticks per second: 1000000
End-to-end estimated gates: 3.46699e+10. observed gates: 40336890544 gates, relative error (%)=14.0492
[Linux]Peak resident set size: 15983820800 bytes, current memory size: 9282617344 bytes.
Initial Memory: 7964618752 bytes, Peak Memory After Execution: 15983820800 bytes, Memory Usage: 8019202048 bytes
Bandwidth: 4.05604e+08 Bps
Comparing on idx 171 with (VIETNAM                  , 1995, 134893.625000) (dummy=0)
          !=            (VIETNAM                  , 1995, 97339.125000) (dummy=0)
    Failed to match!
/home/vaultdb/vaultdb-core-cost-comparison/src/main/cpp/test/mpc/cost_optimized_test.cpp:130: Failure
Expected equality of these values:
  *expected
    Which is: (#0 varchar(25) nation.n_name, #1 int32 orders.o_year, #2 float sum_profit) isEncrypted? false, order by: {<0, ASC> , <1, DESC> }
(ALGERIA                  , 1998, 104163.132812)
(ALGERIA                  , 1997, 311060.437500)
(ALGERIA                  , 1996, 161152.609375)
(ALGERIA                  , 1995, 127679.843750)
(ALGERIA                  , 1994, 355106.125000)
(ALGERIA                  , 1993, 365327.218750)
(ALGERIA                  , 1992, 316328.343750)
(ARGENTINA                , 1998, 24756.941406)
(ARGENTINA                , 1997, 171443.156250)
(ARGENTINA                , 1996, 81814.453125)
(ARGENTINA                , 1995, 53017.175781)
(ARGENTINA                , 1994, 110703.679688)
(ARGENTINA                , 1993, 42357.398438)
(ARGENTINA                , 1992, 54038.441406)
(BRAZIL                   , 1998, 96284.179688)
(BRAZIL                   , 1997, 168498.734375)
(BRAZIL                   , 1996, 206493.078125)
(BRAZIL                   , 1995, 556853.562500)
(BRAZIL                   , 1994, 291949.218750)
(BRAZIL                   , 1993, 244202.093750)
(BRAZIL                   , 1992, 411459.468750)
(CANADA                   , 1998, 69002.929688)
(CANADA                   , 1997, 95325.382812)
(CANADA                   , 1996, 149793.875000)
(CANADA                   , 1995, 196394.593750)
(CANADA                   , 1994, 377533.156250)
(CANADA                   , 1993, 173365.656250)
(CANADA                   , 1992, 233608.187500)
(CHINA                    , 1998, 160540.906250)
(CHINA                    , 1997, 416899.187500)
(CHINA                    , 1996, 172652.593750)
(CHINA                    , 1995, 310543.250000)
(CHINA                    , 1994, 498902.375000)
(CHINA                    , 1993, 369092.593750)
(CHINA                    , 1992, 448692.750000)
(EGYPT                    , 1998, 342181.125000)
(EGYPT                    , 1997, 340608.937500)
(EGYPT                    , 1996, 450298.031250)
(EGYPT                    , 1995, 299124.937500)
(EGYPT                    , 1994, 367795.156250)
(EGYPT                    , 1993, 158471.656250)
(EGYPT                    , 1992, 342320.843750)
(ETHIOPIA                 , 1998, 239300.781250)
(ETHIOPIA                 , 1997, 462589.375000)
(ETHIOPIA                 , 1996, 432540.750000)
(ETHIOPIA                 , 1995, 402928.781250)
(ETHIOPIA                 , 1994, 305865.906250)
(ETHIOPIA                 , 1993, 391805.843750)
(ETHIOPIA                 , 1992, 146574.156250)
(FRANCE                   , 1998, 194908.140625)
(FRANCE                   , 1997, 159895.562500)
(FRANCE                   , 1996, 164709.593750)
(FRANCE                   , 1995, 134401.968750)
(FRANCE                   , 1994, 271213.562500)
(FRANCE                   , 1993, 216834.578125)
(FRANCE                   , 1992, 175867.953125)
(GERMANY                  , 1998, 213854.593750)
(GERMANY                  , 1997, 337968.406250)
(GERMANY                  , 1996, 410208.343750)
(GERMANY                  , 1995, 543836.625000)
(GERMANY                  , 1994, 198670.546875)
(GERMANY                  , 1993, 211625.515625)
(GERMANY                  , 1992, 275840.781250)
(INDIA                    , 1998, 489049.531250)
(INDIA                    , 1997, 203723.671875)
(INDIA                    , 1996, 208423.015625)
(INDIA                    , 1995, 383945.593750)
(INDIA                    , 1994, 421480.625000)
(INDIA                    , 1993, 412923.968750)
(INDIA                    , 1992, 260963.796875)
(INDONESIA                , 1998, 259382.296875)
(INDONESIA                , 1997, 505389.906250)
(INDONESIA                , 1996, 400834.593750)
(INDONESIA                , 1995, 179958.609375)
(INDONESIA                , 1994, 287811.500000)
(INDONESIA                , 1993, 314413.843750)
(INDONESIA                , 1992, 296450.375000)
(IRAN                     , 1998, 183521.781250)
(IRAN                     , 1997, 518453.281250)
(IRAN                     , 1996, 435858.937500)
(IRAN                     , 1995, 500715.218750)
(IRAN                     , 1994, 274590.281250)
(IRAN                     , 1993, 394964.125000)
(IRAN                     , 1992, 268555.125000)
(IRAQ                     , 1998, 138804.453125)
(IRAQ                     , 1997, 314194.031250)
(IRAQ                     , 1996, 166223.875000)
(IRAQ                     , 1995, 335438.218750)
(IRAQ                     , 1994, 337512.375000)
(IRAQ                     , 1993, 298517.031250)
(IRAQ                     , 1992, 222539.250000)
(JAPAN                    , 1998, 114593.773438)
(JAPAN                    , 1997, 125710.468750)
(JAPAN                    , 1996, 199835.984375)
(JAPAN                    , 1995, 213408.859375)
(JAPAN                    , 1994, 362802.343750)
(JAPAN                    , 1993, 205483.500000)
(JAPAN                    , 1992, 189338.203125)
(JORDAN                   , 1998, 64736.332031)
(JORDAN                   , 1997, 125787.335938)
(JORDAN                   , 1996, 214219.671875)
(JORDAN                   , 1995, 191602.812500)
(JORDAN                   , 1994, 370811.187500)
(JORDAN                   , 1993, 186855.890625)
(JORDAN                   , 1992, 71911.187500)
(KENYA                    , 1998, 54502.847656)
(KENYA                    , 1997, 415746.875000)
(KENYA                    , 1996, 340996.718750)
(KENYA                    , 1995, 261407.250000)
(KENYA                    , 1994, 410770.625000)
(KENYA                    , 1993, 518319.875000)
(KENYA                    , 1992, 364662.968750)
(MOROCCO                  , 1998, 118026.101562)
(MOROCCO                  , 1997, 207738.859375)
(MOROCCO                  , 1996, 173682.187500)
(MOROCCO                  , 1995, 269497.718750)
(MOROCCO                  , 1994, 352129.468750)
(MOROCCO                  , 1993, 247315.328125)
(MOROCCO                  , 1992, 199617.640625)
(MOZAMBIQUE               , 1998, 391312.000000)
(MOZAMBIQUE               , 1997, 334932.875000)
(MOZAMBIQUE               , 1996, 223404.984375)
(MOZAMBIQUE               , 1995, 493095.625000)
(MOZAMBIQUE               , 1994, 202715.531250)
(MOZAMBIQUE               , 1993, 263943.250000)
(MOZAMBIQUE               , 1992, 296332.156250)
(PERU                     , 1998, 114790.898438)
(PERU                     , 1997, 14897.280273)
(PERU                     , 1996, 144178.546875)
(PERU                     , 1995, 156861.968750)
(PERU                     , 1994, 226182.687500)
(PERU                     , 1993, 56966.691406)
(PERU                     , 1992, 35148.312500)
(ROMANIA                  , 1998, 46101.894531)
(ROMANIA                  , 1997, 153800.296875)
(ROMANIA                  , 1996, 170477.671875)
(ROMANIA                  , 1995, 277094.593750)
(ROMANIA                  , 1994, 59814.359375)
(ROMANIA                  , 1993, 235765.968750)
(ROMANIA                  , 1992, 18059.058594)
(RUSSIA                   , 1998, 481340.687500)
(RUSSIA                   , 1997, 391837.625000)
(RUSSIA                   , 1996, 615320.437500)
(RUSSIA                   , 1995, 410802.343750)
(RUSSIA                   , 1994, 371687.343750)
(RUSSIA                   , 1993, 444137.156250)
(RUSSIA                   , 1992, 599305.062500)
(SAUDI ARABIA             , 1998, 76419.546875)
(SAUDI ARABIA             , 1997, 68541.460938)
(SAUDI ARABIA             , 1996, 149018.156250)
(SAUDI ARABIA             , 1995, 197687.703125)
(SAUDI ARABIA             , 1994, 176292.906250)
(SAUDI ARABIA             , 1993, 178387.687500)
(SAUDI ARABIA             , 1992, 220432.031250)
(UNITED KINGDOM           , 1998, 214349.062500)
(UNITED KINGDOM           , 1997, 436185.000000)
(UNITED KINGDOM           , 1996, 334213.687500)
(UNITED KINGDOM           , 1995, 297461.687500)
(UNITED KINGDOM           , 1994, 297756.968750)
(UNITED KINGDOM           , 1993, 352826.937500)
(UNITED KINGDOM           , 1992, 110073.640625)
(UNITED STATES            , 1998, 103749.085938)
(UNITED STATES            , 1997, 40799.355469)
(UNITED STATES            , 1996, 159347.031250)
(UNITED STATES            , 1995, 143690.453125)
(UNITED STATES            , 1994, 126802.867188)
(UNITED STATES            , 1993, 84305.914062)
(UNITED STATES            , 1992, 53823.800781)
(VIETNAM                  , 1998, 48992.074219)
(VIETNAM                  , 1997, 146775.531250)
(VIETNAM                  , 1996, 334009.843750)
(VIETNAM                  , 1995, 134893.625000)
(VIETNAM                  , 1994, 169815.171875)
(VIETNAM                  , 1993, 332511.968750)
(VIETNAM                  , 1992, 150073.750000)

  *observed
    Which is: (#0 varchar(25) nation.n_name, #1 int32 o_year, #2 float sum_profit) isEncrypted? false, order by: {<0, ASC> , <1, DESC> }
(ALGERIA                  , 1998, 104163.132812)
(ALGERIA                  , 1997, 311060.406250)
(ALGERIA                  , 1996, 161152.609375)
(ALGERIA                  , 1995, 127679.843750)
(ALGERIA                  , 1994, 355106.156250)
(ALGERIA                  , 1993, 365327.187500)
(ALGERIA                  , 1992, 316328.343750)
(ARGENTINA                , 1998, 24756.939453)
(ARGENTINA                , 1997, 171443.156250)
(ARGENTINA                , 1996, 81814.445312)
(ARGENTINA                , 1995, 53017.171875)
(ARGENTINA                , 1994, 110703.687500)
(ARGENTINA                , 1993, 42357.398438)
(ARGENTINA                , 1992, 54038.441406)
(BRAZIL                   , 1998, 96284.179688)
(BRAZIL                   , 1997, 168498.734375)
(BRAZIL                   , 1996, 206493.078125)
(BRAZIL                   , 1995, 556853.562500)
(BRAZIL                   , 1994, 291949.250000)
(BRAZIL                   , 1993, 244202.093750)
(BRAZIL                   , 1992, 411459.468750)
(CANADA                   , 1998, 69002.929688)
(CANADA                   , 1997, 95325.375000)
(CANADA                   , 1996, 149793.875000)
(CANADA                   , 1995, 196394.593750)
(CANADA                   , 1994, 377533.156250)
(CANADA                   , 1993, 173365.656250)
(CANADA                   , 1992, 233608.187500)
(CHINA                    , 1998, 160540.906250)
(CHINA                    , 1997, 416899.218750)
(CHINA                    , 1996, 172652.593750)
(CHINA                    , 1995, 310543.281250)
(CHINA                    , 1994, 498902.375000)
(CHINA                    , 1993, 369092.593750)
(CHINA                    , 1992, 448692.781250)
(EGYPT                    , 1998, 342181.062500)
(EGYPT                    , 1997, 340608.906250)
(EGYPT                    , 1996, 450298.000000)
(EGYPT                    , 1995, 299124.906250)
(EGYPT                    , 1994, 367795.187500)
(EGYPT                    , 1993, 158471.656250)
(EGYPT                    , 1992, 342320.812500)
(ETHIOPIA                 , 1998, 239300.781250)
(ETHIOPIA                 , 1997, 462589.468750)
(ETHIOPIA                 , 1996, 432540.656250)
(ETHIOPIA                 , 1995, 402928.750000)
(ETHIOPIA                 , 1994, 305865.875000)
(ETHIOPIA                 , 1993, 391805.875000)
(ETHIOPIA                 , 1992, 146574.140625)
(FRANCE                   , 1998, 194908.156250)
(FRANCE                   , 1997, 159895.562500)
(FRANCE                   , 1996, 164709.593750)
(FRANCE                   , 1995, 134401.953125)
(FRANCE                   , 1994, 271213.562500)
(FRANCE                   , 1993, 216834.593750)
(FRANCE                   , 1992, 175867.953125)
(GERMANY                  , 1998, 213854.593750)
(GERMANY                  , 1997, 337968.406250)
(GERMANY                  , 1996, 410208.343750)
(GERMANY                  , 1995, 543836.625000)
(GERMANY                  , 1994, 198670.562500)
(GERMANY                  , 1993, 211625.531250)
(GERMANY                  , 1992, 275840.781250)
(INDIA                    , 1998, 489049.531250)
(INDIA                    , 1997, 203723.671875)
(INDIA                    , 1996, 208423.015625)
(INDIA                    , 1995, 383945.593750)
(INDIA                    , 1994, 421480.656250)
(INDIA                    , 1993, 412924.000000)
(INDIA                    , 1992, 260963.781250)
(INDONESIA                , 1998, 259382.328125)
(INDONESIA                , 1997, 505389.875000)
(INDONESIA                , 1996, 400834.593750)
(INDONESIA                , 1995, 179958.625000)
(INDONESIA                , 1994, 287811.500000)
(INDONESIA                , 1993, 314413.843750)
(INDONESIA                , 1992, 296450.343750)
(IRAN                     , 1998, 183521.781250)
(IRAN                     , 1997, 518453.312500)
(IRAN                     , 1996, 435858.906250)
(IRAN                     , 1995, 500715.218750)
(IRAN                     , 1994, 274590.312500)
(IRAN                     , 1993, 394964.156250)
(IRAN                     , 1992, 268555.125000)
(IRAQ                     , 1998, 138804.453125)
(IRAQ                     , 1997, 314194.031250)
(IRAQ                     , 1996, 166223.875000)
(IRAQ                     , 1995, 335438.218750)
(IRAQ                     , 1994, 337512.375000)
(IRAQ                     , 1993, 298517.031250)
(IRAQ                     , 1992, 222539.250000)
(JAPAN                    , 1998, 114593.765625)
(JAPAN                    , 1997, 125710.468750)
(JAPAN                    , 1996, 199835.984375)
(JAPAN                    , 1995, 213408.843750)
(JAPAN                    , 1994, 362802.312500)
(JAPAN                    , 1993, 205483.515625)
(JAPAN                    , 1992, 189338.187500)
(JORDAN                   , 1998, 64736.328125)
(JORDAN                   , 1997, 125787.335938)
(JORDAN                   , 1996, 214219.671875)
(JORDAN                   , 1995, 191602.812500)
(JORDAN                   , 1994, 370811.187500)
(JORDAN                   , 1993, 186855.890625)
(JORDAN                   , 1992, 71911.187500)
(KENYA                    , 1998, 54502.847656)
(KENYA                    , 1997, 415746.875000)
(KENYA                    , 1996, 340996.718750)
(KENYA                    , 1995, 261407.265625)
(KENYA                    , 1994, 410770.656250)
(KENYA                    , 1993, 518319.875000)
(KENYA                    , 1992, 364662.937500)
(MOROCCO                  , 1998, 118026.101562)
(MOROCCO                  , 1997, 207738.859375)
(MOROCCO                  , 1996, 173682.203125)
(MOROCCO                  , 1995, 269497.718750)
(MOROCCO                  , 1994, 352129.437500)
(MOROCCO                  , 1993, 247315.328125)
(MOROCCO                  , 1992, 199617.625000)
(MOZAMBIQUE               , 1998, 391312.031250)
(MOZAMBIQUE               , 1997, 334932.875000)
(MOZAMBIQUE               , 1996, 223404.984375)
(MOZAMBIQUE               , 1995, 493095.593750)
(MOZAMBIQUE               , 1994, 202715.531250)
(MOZAMBIQUE               , 1993, 263943.218750)
(MOZAMBIQUE               , 1992, 296332.187500)
(PERU                     , 1998, 114790.898438)
(PERU                     , 1997, 14897.281250)
(PERU                     , 1996, 144178.562500)
(PERU                     , 1995, 156861.968750)
(PERU                     , 1994, 226182.687500)
(PERU                     , 1993, 56966.695312)
(PERU                     , 1992, 35148.312500)
(ROMANIA                  , 1998, 46101.890625)
(ROMANIA                  , 1997, 153800.296875)
(ROMANIA                  , 1996, 170477.687500)
(ROMANIA                  , 1995, 277094.625000)
(ROMANIA                  , 1994, 59814.359375)
(ROMANIA                  , 1993, 235765.968750)
(ROMANIA                  , 1992, 18059.058594)
(RUSSIA                   , 1998, 481340.656250)
(RUSSIA                   , 1997, 391837.656250)
(RUSSIA                   , 1996, 615320.437500)
(RUSSIA                   , 1995, 410802.375000)
(RUSSIA                   , 1994, 371687.375000)
(RUSSIA                   , 1993, 444137.125000)
(RUSSIA                   , 1992, 599305.000000)
(SAUDI ARABIA             , 1998, 76419.546875)
(SAUDI ARABIA             , 1997, 68541.460938)
(SAUDI ARABIA             , 1996, 149018.171875)
(SAUDI ARABIA             , 1995, 197687.703125)
(SAUDI ARABIA             , 1994, 176292.890625)
(SAUDI ARABIA             , 1993, 178387.718750)
(SAUDI ARABIA             , 1992, 220432.046875)
(UNITED KINGDOM           , 1998, 214349.062500)
(UNITED KINGDOM           , 1997, 436185.000000)
(UNITED KINGDOM           , 1996, 334213.687500)
(UNITED KINGDOM           , 1995, 297461.687500)
(UNITED KINGDOM           , 1994, 297756.968750)
(UNITED KINGDOM           , 1993, 352826.937500)
(UNITED KINGDOM           , 1992, 110073.640625)
(UNITED STATES            , 1998, 103749.085938)
(UNITED STATES            , 1997, 40799.355469)
(UNITED STATES            , 1996, 159347.015625)
(UNITED STATES            , 1995, 143690.453125)
(UNITED STATES            , 1994, 126802.859375)
(UNITED STATES            , 1993, 84305.914062)
(UNITED STATES            , 1992, 53823.796875)
(VIETNAM                  , 1998, 48992.078125)
(VIETNAM                  , 1997, 146775.531250)
(VIETNAM                  , 1996, 334009.875000)
(VIETNAM                  , 1995, 97339.125000)
(VIETNAM                  , 1994, 141917.546875)
(VIETNAM                  , 1993, 332511.968750)
(VIETNAM                  , 1992, 141021.953125)

[  FAILED  ] CostOptimizedTest.cost_optimized_tpch_q9 (3997976 ms)
[ RUN      ] CostOptimizedTest.cost_optimized_tpch_q18
Connecting to 127.0.0.1 on ports 7654, 65482 as 1
connected
EMP mode: sh2pc, storage mode: column store
Code version: aaab8b1c36f961a50172caf92085acacb0670290
GFlags: --flagfile=	--alice_db=tpch_alice_6000	--alice_host=127.0.0.1	--bob_db=tpch_bob_6000	--ctrl_port=65483	--cutoff=100	--filter=*	--party=1	--port=7655	--storage=column	--unioned_db=tpch_unioned_6000	--validation=true	--log_level=2	--logfile=	

[Linux]Peak resident set size: 16777216 bytes, current memory size: 16777216 bytes.
Operator (9). smj cost : 3170289264, nlj cost : 83520000000, join type : keyed-sort-merge-join
Original Tree : 
#11: Sort<Bit> ({<-1, ASC> , <4, DESC> , <3, ASC> }) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(14) customer.c_custkey, #2 shared-int32(20) order_keys.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> , <4, DESC> , <3, ASC> }, cost est: 504037, output card: 100
    #10: Project<Bit> ((<0, P$6(200) shared-varchar>, <1, P$5(14) shared-int32>, <2, P$0(20) shared-int32>, <3, P$3(28) shared-int64>, <4, P$2(32) shared-float>, <5, P$4(32) shared-float>)) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(14) customer.c_custkey, #2 shared-int32(20) order_keys.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> }, cost est: 0, output card: 60000
        #9: SortMergeJoin<Bit> (P$1(14) == P$5(14)) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty, #5 shared-int32(14) customer.c_custkey, #6 shared-varchar(25) customer.c_name) order by: {<-1, ASC> , <1, ASC> , <5, ASC> }, cost est: 3170289264, output card: 60000
            #7: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$3(14) shared-int32>, <2, P$4(32) shared-float>, <3, P$5(28) shared-int64>, <4, P$1(32) shared-float>)) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 60000
                #6: MergeJoin<Bit> (no-op) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty, #2 shared-int32(20) orders.o_orderkey, #3 shared-int32(14) orders.o_custkey, #4 shared-float orders.o_totalprice, #5 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 180000, output card: 60000
                    #4: Filter<Bit> (P$1(32) > SECRET FLOAT) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 12780000, output card: 60000
                        #3: Project<Bit> ((<0, P$0(20) shared-int32>, <1, $1 + $3 shared-float>)) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 59160000, output card: 60000
                            #2: MergeJoin<Bit> (no-op) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty, #2 shared-int32(20) order_keys.o_orderkey, #3 shared-float sum_qty) order by: {<0, ASC> }, cost est: 180000, output card: 60000
                                #0: SecureSqlInput<Bit> ("WITH all_keys AS (SELECT o_orderkey  FROM order_keys), sum_qtys AS (SELECT l_orderkey, sum(l_quantity) as sum_qty, false AS dummy_tag FROM lineitem GROUP BY l_orderkey ORDER BY l_orderkey) SELECT o_orderkey, COALESCE(sum_qty, 0.0) sum_qty, COALESCE(dummy_tag, true) dummy_tag FROM all_keys LEFT JOIN sum_qtys ON l_orderkey = o_orderkey ORDER BY o_orderkey ", tuple_count=60000) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 60000
                                #1: SecureSqlInput<Bit> ("WITH all_keys AS (SELECT o_orderkey  FROM order_keys), sum_qtys AS (SELECT l_orderkey, sum(l_quantity) as sum_qty, false AS dummy_tag FROM lineitem GROUP BY l_orderkey ORDER BY l_orderkey) SELECT o_orderkey, COALESCE(sum_qty, 0.0) sum_qty, COALESCE(dummy_tag, true) dummy_tag FROM all_keys LEFT JOIN sum_qtys ON l_orderkey = o_orderkey ORDER BY o_orderkey ", tuple_count=60000) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 60000
                    #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, false dummy_tag FROM orders ORDER BY o_orderkey", tuple_count=60000) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 56189240, output card: 60000
            #8: SecureSqlInput<Bit> ("SELECT c_custkey, c_name FROM customer ORDER BY c_custkey", tuple_count=6000) : (#0 shared-int32(14) customer.c_custkey, #1 shared-varchar(25) customer.c_name) order by: {<0, ASC> }, cost est: 8735264, output card: 6000

Total Plans : 4
Cost Optimized Plan : 
#11: Sort<Bit> ({<-1, ASC> , <4, DESC> , <3, ASC> }) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(14) customer.c_custkey, #2 shared-int32(20) order_keys.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> , <4, DESC> , <3, ASC> }, cost est: 504037, output card: 100
    #10: Project<Bit> ((<0, P$6(200) shared-varchar>, <1, P$5(14) shared-int32>, <2, P$0(20) shared-int32>, <3, P$3(28) shared-int64>, <4, P$2(32) shared-float>, <5, P$4(32) shared-float>)) : (#0 shared-varchar(25) customer.c_name, #1 shared-int32(14) customer.c_custkey, #2 shared-int32(20) order_keys.o_orderkey, #3 shared-int64(28) orders.o_orderdate, #4 shared-float orders.o_totalprice, #5 shared-float sum_qty) order by: {<-1, ASC> }, cost est: 0, output card: 60000
        #9: SortMergeJoin<Bit> (P$1(14) == P$5(14)) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty, #5 shared-int32(14) customer.c_custkey, #6 shared-varchar(25) customer.c_name) order by: {<-1, ASC> , <1, ASC> , <5, ASC> }, cost est: 2163126576, output card: 60000
            #-1: Sort<Bit> ({<1, ASC> }) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty) order by: {<1, ASC> }, cost est: 578479296, output card: 60000
                #7: Project<Bit> ((<0, P$0(20) shared-int32>, <1, P$3(14) shared-int32>, <2, P$4(32) shared-float>, <3, P$5(28) shared-int64>, <4, P$1(32) shared-float>)) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate, #4 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 60000
                    #6: MergeJoin<Bit> (no-op) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty, #2 shared-int32(20) orders.o_orderkey, #3 shared-int32(14) orders.o_custkey, #4 shared-float orders.o_totalprice, #5 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 180000, output card: 60000
                        #4: Filter<Bit> (P$1(32) > SECRET FLOAT) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 12780000, output card: 60000
                            #3: Project<Bit> ((<0, P$0(20) shared-int32>, <1, $1 + $3 shared-float>)) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float anonymous) order by: {<0, ASC> }, cost est: 59160000, output card: 60000
                                #2: MergeJoin<Bit> (no-op) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty, #2 shared-int32(20) order_keys.o_orderkey, #3 shared-float sum_qty) order by: {<0, ASC> }, cost est: 180000, output card: 60000
                                    #0: SecureSqlInput<Bit> ("WITH all_keys AS (SELECT o_orderkey  FROM order_keys), sum_qtys AS (SELECT l_orderkey, sum(l_quantity) as sum_qty, false AS dummy_tag FROM lineitem GROUP BY l_orderkey ORDER BY l_orderkey) SELECT o_orderkey, COALESCE(sum_qty, 0.0) sum_qty, COALESCE(dummy_tag, true) dummy_tag FROM all_keys LEFT JOIN sum_qtys ON l_orderkey = o_orderkey ORDER BY o_orderkey ", tuple_count=60000) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 60000
                                    #1: SecureSqlInput<Bit> ("WITH all_keys AS (SELECT o_orderkey  FROM order_keys), sum_qtys AS (SELECT l_orderkey, sum(l_quantity) as sum_qty, false AS dummy_tag FROM lineitem GROUP BY l_orderkey ORDER BY l_orderkey) SELECT o_orderkey, COALESCE(sum_qty, 0.0) sum_qty, COALESCE(dummy_tag, true) dummy_tag FROM all_keys LEFT JOIN sum_qtys ON l_orderkey = o_orderkey ORDER BY o_orderkey ", tuple_count=60000) : (#0 shared-int32(20) order_keys.o_orderkey, #1 shared-float sum_qty) order by: {<0, ASC> }, cost est: 0, output card: 60000
                        #5: SecureSqlInput<Bit> ("SELECT o_orderkey, o_custkey, o_totalprice, o_orderdate, false dummy_tag FROM orders ORDER BY o_orderkey", tuple_count=60000) : (#0 shared-int32(20) orders.o_orderkey, #1 shared-int32(14) orders.o_custkey, #2 shared-float orders.o_totalprice, #3 shared-int64(28) orders.o_orderdate) order by: {<0, ASC> }, cost est: 56189240, output card: 60000
            #8: SecureSqlInput<Bit> ("SELECT c_custkey, c_name FROM customer ORDER BY c_custkey", tuple_count=6000) : (#0 shared-int32(14) customer.c_custkey, #1 shared-varchar(25) customer.c_name) order by: {<0, ASC> }, cost est: 8735264, output card: 6000

Cost Optimization Time : 0.008483 sec
Operator #0 SecureSqlInput ran for 127.821000 ms, gate count: 0 output cardinality: 60000, row width=53
Operator #1 SecureSqlInput ran for 194.859000 ms, gate count: 0 output cardinality: 60000, row width=53
Operator #2 MergeJoin ran for 91.615000 ms, gate count: 120000 output cardinality: 60000, row width=105
Operator #3 Project ran for 4054.179000 ms, gate count: 59160000 output cardinality: 60000, row width=53
Operator #4 Filter ran for 942.120000 ms, gate count: 12840000 output cardinality: 60000, row width=53
Operator #5 SecureSqlInput ran for 4982.459000 ms, gate count: 54404928 output cardinality: 60000, row width=95
Operator #6 MergeJoin ran for 61.259000 ms, gate count: 120000 output cardinality: 60000, row width=147
Operator #7 Project ran for 35.687000 ms, gate count: 0 output cardinality: 60000, row width=127
Operator #-1 Sort ran for 42447.516000 ms, gate count: 557078496 output cardinality: 60000, row width=127
Operator #8 SecureSqlInput ran for 840.146000 ms, gate count: 8430880 output cardinality: 6000, row width=215
Operator #9 SortMergeJoin ran for 220021.619000 ms, gate count: 3597638788 output cardinality: 60000, row width=341
Operator #10 Project ran for 162.536000 ms, gate count: 0 output cardinality: 60000, row width=327
Operator #11 Sort ran for 114597.892000 ms, gate count: 1537564320 output cardinality: 100, row width=327
Runtime: 388.885 sec, CPU Time: 382.133 sec, CPU clock ticks: 3.82133e+08, CPU clock ticks per second: 1000000
End-to-end estimated gates: 2.87933e+09. observed gates: 5135203108 gates, relative error (%)=43.9295
[Linux]Peak resident set size: 1782693888 bytes, current memory size: 768180224 bytes.
Initial Memory: 16777216 bytes, Peak Memory After Execution: 1782693888 bytes, Memory Usage: 1765916672 bytes
Bandwidth: 4.22558e+08 Bps
[       OK ] CostOptimizedTest.cost_optimized_tpch_q18 (399977 ms)
[----------] 6 tests from CostOptimizedTest (8373670 ms total)

[----------] Global test environment tear-down
[==========] 6 tests from 1 test suite ran. (8373670 ms total)
[  PASSED  ] 5 tests.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] CostOptimizedTest.cost_optimized_tpch_q9

 2 FAILED TESTS
